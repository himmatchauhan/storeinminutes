(function(jQuery) {jQuery.hotkeys = {version: "0.8",specialKeys: {8: "backspace",9: "tab",10: "return",13: "return",16: "shift",17: "ctrl",18: "alt",19: "pause",20: "capslock",27: "esc",32: "space",33: "pageup",34: "pagedown",35: "end",36: "home",37: "left",38: "up",39: "right",40: "down",45: "insert",46: "del",59: ";",61: "=",96: "0",97: "1",98: "2",99: "3",100: "4",101: "5",102: "6",103: "7",104: "8",105: "9",106: "*",107: "+",109: "-",110: ".",111: "/",112: "f1",113: "f2",114: "f3",115: "f4",116: "f5",117: "f6",118: "f7",119: "f8",120: "f9",121: "f10",122: "f11",123: "f12",144: "numlock",145: "scroll",173: "-",186: ";",187: "=",188: ",",189: "-",190: ".",191: "/",192: "`",219: "[",220: "\\",221: "]",222: "'"},shiftNums: {"`": "~","1": "!","2": "@","3": "#","4": "$","5": "%","6": "^","7": "&","8": "*","9": "(","0": ")","-": "_","=": "+",";": ": ","'": "\"",",": "<",".": ">","/": "?","\\": "|"},textAcceptingInputTypes: ["text", "password", "number", "email", "url", "range", "date", "month", "week", "time", "datetime","datetime-local", "search", "color", "tel"],options: {filterTextInputs: true}};function keyHandler(handleObj) {if (typeof handleObj.data === "string") {handleObj.data = {keys: handleObj.data};}
if (!handleObj.data || !handleObj.data.keys || typeof handleObj.data.keys !== "string") {return;}
var origHandler = handleObj.handler,keys = handleObj.data.keys.toLowerCase().split(" ");handleObj.handler = function(event) {if (this !== event.target && (/textarea|select/i.test(event.target.nodeName) ||(jQuery.hotkeys.options.filterTextInputs &&jQuery.inArray(event.target.type, jQuery.hotkeys.textAcceptingInputTypes) > -1))) {return;}
var special = event.type !== "keypress" && jQuery.hotkeys.specialKeys[event.which],character = String.fromCharCode(event.which).toLowerCase(),modif = "",possible = {};jQuery.each(["alt", "ctrl", "shift"], function(index, specialKey) {if (event[specialKey + 'Key'] && special !== specialKey) {modif += specialKey + '+';}});if (event.metaKey && !event.ctrlKey && special !== "meta") {modif += "meta+";}
if (event.metaKey && special !== "meta" && modif.indexOf("alt+ctrl+shift+") > -1) {modif = modif.replace("alt+ctrl+shift+", "hyper+");}
if (special) {possible[modif + special] = true;}
else {possible[modif + character] = true;possible[modif + jQuery.hotkeys.shiftNums[character]] = true;if (modif === "shift+") {possible[jQuery.hotkeys.shiftNums[character]] = true;}}
for (var i = 0, l = keys.length; i < l; i++) {if (possible[keys[i]]) {return origHandler.apply(this, arguments);}}};}
jQuery.each(["keydown", "keyup", "keypress"], function() {jQuery.event.special[this] = {add: keyHandler};});})(jQuery || this.jQuery || window.jQuery);
(function() {var $, AbstractChosen, Chosen, SelectParser, _ref,__bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },__hasProp = {}.hasOwnProperty,__extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };SelectParser = (function() {function SelectParser() {this.options_index = 0;this.parsed = [];}
SelectParser.prototype.add_node = function(child) {if (child.nodeName.toUpperCase() === "OPTGROUP") {return this.add_group(child);} else {return this.add_option(child);}};SelectParser.prototype.add_group = function(group) {var group_position, option, _i, _len, _ref, _results;group_position = this.parsed.length;this.parsed.push({array_index: group_position,group: true,label: this.escapeExpression(group.label),title: group.title ? group.title : void 0,children: 0,disabled: group.disabled,classes: group.className});_ref = group.childNodes;_results = [];for (_i = 0, _len = _ref.length; _i < _len; _i++) {option = _ref[_i];_results.push(this.add_option(option, group_position, group.disabled));}
return _results;};SelectParser.prototype.add_option = function(option, group_position, group_disabled) {if (option.nodeName.toUpperCase() === "OPTION") {if (option.text !== "") {if (group_position != null) {this.parsed[group_position].children += 1;}
this.parsed.push({array_index: this.parsed.length,options_index: this.options_index,value: option.value,text: option.text,html: option.innerHTML,title: option.title ? option.title : void 0,selected: option.selected,disabled: group_disabled === true ? group_disabled : option.disabled,group_array_index: group_position,group_label: group_position != null ? this.parsed[group_position].label : null,classes: option.className,style: option.style.cssText});} else {this.parsed.push({array_index: this.parsed.length,options_index: this.options_index,empty: true});}
return this.options_index += 1;}};SelectParser.prototype.escapeExpression = function(text) {var map, unsafe_chars;if ((text == null) || text === false) {return "";}
if (!/[\&\<\>\"\'\`]/.test(text)) {return text;}
map = {"<": "&lt;",">": "&gt;",'"': "&quot;","'": "&#x27;","`": "&#x60;"};unsafe_chars = /&(?!\w+;)|[\<\>\"\'\`]/g;return text.replace(unsafe_chars, function(chr) {return map[chr] || "&amp;";});};return SelectParser;})();SelectParser.select_to_array = function(select) {var child, parser, _i, _len, _ref;parser = new SelectParser();_ref = select.childNodes;for (_i = 0, _len = _ref.length; _i < _len; _i++) {child = _ref[_i];parser.add_node(child);}
return parser.parsed;};AbstractChosen = (function() {function AbstractChosen(form_field, options) {this.form_field = form_field;this.options = options != null ? options : {};this.label_click_handler = __bind(this.label_click_handler, this);if (!AbstractChosen.browser_is_supported()) {return;}
this.is_multiple = this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers();this.on_ready();}
AbstractChosen.prototype.set_default_values = function() {var _this = this;this.click_test_action = function(evt) {return _this.test_active_click(evt);};this.activate_action = function(evt) {return _this.activate_field(evt);};this.active_field = false;this.mouse_on_container = false;this.results_showing = false;this.result_highlighted = null;this.is_rtl = this.options.rtl || /\bchosen-rtl\b/.test(this.form_field.className);this.allow_single_deselect = (this.options.allow_single_deselect != null) && (this.form_field.options[0] != null) && this.form_field.options[0].text === "" ? this.options.allow_single_deselect : false;this.disable_search_threshold = this.options.disable_search_threshold || 0;this.disable_search = this.options.disable_search || false;this.enable_split_word_search = this.options.enable_split_word_search != null ? this.options.enable_split_word_search : true;this.group_search = this.options.group_search != null ? this.options.group_search : true;this.search_contains = this.options.search_contains || false;this.single_backstroke_delete = this.options.single_backstroke_delete != null ? this.options.single_backstroke_delete : true;this.max_selected_options = this.options.max_selected_options || Infinity;this.inherit_select_classes = this.options.inherit_select_classes || false;this.display_selected_options = this.options.display_selected_options != null ? this.options.display_selected_options : true;this.display_disabled_options = this.options.display_disabled_options != null ? this.options.display_disabled_options : true;this.include_group_label_in_selected = this.options.include_group_label_in_selected || false;this.max_shown_results = this.options.max_shown_results || Number.POSITIVE_INFINITY;this.case_sensitive_search = this.options.case_sensitive_search || false;return this.hide_results_on_select = this.options.hide_results_on_select != null ? this.options.hide_results_on_select : true;};AbstractChosen.prototype.set_default_text = function() {if (this.form_field.getAttribute("data-placeholder")) {this.default_text = this.form_field.getAttribute("data-placeholder");} else if (this.is_multiple) {this.default_text = this.options.placeholder_text_multiple || this.options.placeholder_text || AbstractChosen.default_multiple_text;} else {this.default_text = this.options.placeholder_text_single || this.options.placeholder_text || AbstractChosen.default_single_text;}
this.default_text = this.escape_html(this.default_text);return this.results_none_found = this.form_field.getAttribute("data-no_results_text") || this.options.no_results_text || AbstractChosen.default_no_result_text;};AbstractChosen.prototype.choice_label = function(item) {if (this.include_group_label_in_selected && (item.group_label != null)) {return "<b class='group-name'>" + item.group_label + "</b>" + item.html;} else {return item.html;}};AbstractChosen.prototype.mouse_enter = function() {return this.mouse_on_container = true;};AbstractChosen.prototype.mouse_leave = function() {return this.mouse_on_container = false;};AbstractChosen.prototype.input_focus = function(evt) {var _this = this;if (this.is_multiple) {if (!this.active_field) {return setTimeout((function() {return _this.container_mousedown();}), 50);}} else {if (!this.active_field) {return this.activate_field();}}};AbstractChosen.prototype.input_blur = function(evt) {var _this = this;if (!this.mouse_on_container) {this.active_field = false;return setTimeout((function() {return _this.blur_test();}), 100);}};AbstractChosen.prototype.label_click_handler = function(evt) {if (this.is_multiple) {return this.container_mousedown(evt);} else {return this.activate_field();}};AbstractChosen.prototype.results_option_build = function(options) {var content, data, data_content, shown_results, _i, _len, _ref;content = '';shown_results = 0;_ref = this.results_data;for (_i = 0, _len = _ref.length; _i < _len; _i++) {data = _ref[_i];data_content = '';if (data.group) {data_content = this.result_add_group(data);} else {data_content = this.result_add_option(data);}
if (data_content !== '') {shown_results++;content += data_content;}
if (options != null ? options.first : void 0) {if (data.selected && this.is_multiple) {this.choice_build(data);} else if (data.selected && !this.is_multiple) {this.single_set_selected_text(this.choice_label(data));}}
if (shown_results >= this.max_shown_results) {break;}}
return content;};AbstractChosen.prototype.result_add_option = function(option) {var classes, option_el;if (!option.search_match) {return '';}
if (!this.include_option_in_results(option)) {return '';}
classes = [];if (!option.disabled && !(option.selected && this.is_multiple)) {classes.push("active-result");}
if (option.disabled && !(option.selected && this.is_multiple)) {classes.push("disabled-result");}
if (option.selected) {classes.push("result-selected");}
if (option.group_array_index != null) {classes.push("group-option");}
if (option.classes !== "") {classes.push(option.classes);}
option_el = document.createElement("li");option_el.className = classes.join(" ");option_el.style.cssText = option.style;option_el.setAttribute("data-option-array-index", option.array_index);option_el.innerHTML = option.search_text;if (option.title) {option_el.title = option.title;}
return this.outerHTML(option_el);};AbstractChosen.prototype.result_add_group = function(group) {var classes, group_el;if (!(group.search_match || group.group_match)) {return '';}
if (!(group.active_options > 0)) {return '';}
classes = [];classes.push("group-result");if (group.classes) {classes.push(group.classes);}
group_el = document.createElement("li");group_el.className = classes.join(" ");group_el.innerHTML = group.search_text;if (group.title) {group_el.title = group.title;}
return this.outerHTML(group_el);};AbstractChosen.prototype.results_update_field = function() {this.set_default_text();if (!this.is_multiple) {this.results_reset_cleanup();}
this.result_clear_highlight();this.results_build();if (this.results_showing) {return this.winnow_results();}};AbstractChosen.prototype.reset_single_select_options = function() {var result, _i, _len, _ref, _results;_ref = this.results_data;_results = [];for (_i = 0, _len = _ref.length; _i < _len; _i++) {result = _ref[_i];if (result.selected) {_results.push(result.selected = false);} else {_results.push(void 0);}}
return _results;};AbstractChosen.prototype.results_toggle = function() {if (this.results_showing) {return this.results_hide();} else {return this.results_show();}};AbstractChosen.prototype.results_search = function(evt) {if (this.results_showing) {return this.winnow_results();} else {return this.results_show();}};AbstractChosen.prototype.winnow_results = function() {var escapedSearchText, highlightRegex, option, regex, results, results_group, searchText, startpos, text, _i, _len, _ref;this.no_results_clear();results = 0;searchText = this.get_search_text();escapedSearchText = searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&");regex = this.get_search_regex(escapedSearchText);highlightRegex = this.get_highlight_regex(escapedSearchText);_ref = this.results_data;for (_i = 0, _len = _ref.length; _i < _len; _i++) {option = _ref[_i];option.search_match = false;results_group = null;if (this.include_option_in_results(option)) {if (option.group) {option.group_match = false;option.active_options = 0;}
if ((option.group_array_index != null) && this.results_data[option.group_array_index]) {results_group = this.results_data[option.group_array_index];if (results_group.active_options === 0 && results_group.search_match) {results += 1;}
results_group.active_options += 1;}
option.search_text = option.group ? option.label : option.html;if (!(option.group && !this.group_search)) {option.search_match = this.search_string_match(option.search_text, regex);if (option.search_match && !option.group) {results += 1;}
if (option.search_match) {if (searchText.length) {startpos = option.search_text.search(highlightRegex);text = option.search_text.substr(0, startpos + searchText.length) + '</em>' + option.search_text.substr(startpos + searchText.length);option.search_text = text.substr(0, startpos) + '<em>' + text.substr(startpos);}
if (results_group != null) {results_group.group_match = true;}} else if ((option.group_array_index != null) && this.results_data[option.group_array_index].search_match) {option.search_match = true;}}}}
this.result_clear_highlight();if (results < 1 && searchText.length) {this.update_results_content("");return this.no_results(searchText);} else {this.update_results_content(this.results_option_build());return this.winnow_results_set_highlight();}};AbstractChosen.prototype.get_search_regex = function(escaped_search_string) {var regex_anchor, regex_flag;regex_anchor = this.search_contains ? "" : "^";regex_flag = this.case_sensitive_search ? "" : "i";return new RegExp(regex_anchor + escaped_search_string, regex_flag);};AbstractChosen.prototype.get_highlight_regex = function(escaped_search_string) {var regex_anchor, regex_flag;regex_anchor = this.search_contains ? "" : "\\b";regex_flag = this.case_sensitive_search ? "" : "i";return new RegExp(regex_anchor + escaped_search_string, regex_flag);};AbstractChosen.prototype.search_string_match = function(search_string, regex) {var part, parts, _i, _len;if (regex.test(search_string)) {return true;} else if (this.enable_split_word_search && (search_string.indexOf(" ") >= 0 || search_string.indexOf("[") === 0)) {parts = search_string.replace(/\[|\]/g, "").split(" ");if (parts.length) {for (_i = 0, _len = parts.length; _i < _len; _i++) {part = parts[_i];if (regex.test(part)) {return true;}}}}};AbstractChosen.prototype.choices_count = function() {var option, _i, _len, _ref;if (this.selected_option_count != null) {return this.selected_option_count;}
this.selected_option_count = 0;_ref = this.form_field.options;for (_i = 0, _len = _ref.length; _i < _len; _i++) {option = _ref[_i];if (option.selected) {this.selected_option_count += 1;}}
return this.selected_option_count;};AbstractChosen.prototype.choices_click = function(evt) {evt.preventDefault();this.activate_field();if (!(this.results_showing || this.is_disabled)) {return this.results_show();}};AbstractChosen.prototype.keydown_checker = function(evt) {var stroke, _ref;stroke = (_ref = evt.which) != null ? _ref : evt.keyCode;this.search_field_scale();if (stroke !== 8 && this.pending_backstroke) {this.clear_backstroke();}
switch (stroke) {case 8:this.backstroke_length = this.get_search_field_value().length;break;case 9:if (this.results_showing && !this.is_multiple) {this.result_select(evt);}
this.mouse_on_container = false;break;case 13:if (this.results_showing) {evt.preventDefault();}
break;case 27:if (this.results_showing) {evt.preventDefault();}
break;case 32:if (this.disable_search) {evt.preventDefault();}
break;case 38:evt.preventDefault();this.keyup_arrow();break;case 40:evt.preventDefault();this.keydown_arrow();break;}};AbstractChosen.prototype.keyup_checker = function(evt) {var stroke, _ref;stroke = (_ref = evt.which) != null ? _ref : evt.keyCode;this.search_field_scale();switch (stroke) {case 8:if (this.is_multiple && this.backstroke_length < 1 && this.choices_count() > 0) {this.keydown_backstroke();} else if (!this.pending_backstroke) {this.result_clear_highlight();this.results_search();}
break;case 13:evt.preventDefault();if (this.results_showing) {this.result_select(evt);}
break;case 27:if (this.results_showing) {this.results_hide();}
break;case 9:case 16:case 17:case 18:case 38:case 40:case 91:break;default:this.results_search();break;}};AbstractChosen.prototype.clipboard_event_checker = function(evt) {var _this = this;if (this.is_disabled) {return;}
return setTimeout((function() {return _this.results_search();}), 50);};AbstractChosen.prototype.container_width = function() {if (this.options.width != null) {return this.options.width;} else {return "" + this.form_field.offsetWidth + "px";}};AbstractChosen.prototype.include_option_in_results = function(option) {if (this.is_multiple && (!this.display_selected_options && option.selected)) {return false;}
if (!this.display_disabled_options && option.disabled) {return false;}
if (option.empty) {return false;}
return true;};AbstractChosen.prototype.search_results_touchstart = function(evt) {this.touch_started = true;return this.search_results_mouseover(evt);};AbstractChosen.prototype.search_results_touchmove = function(evt) {this.touch_started = false;return this.search_results_mouseout(evt);};AbstractChosen.prototype.search_results_touchend = function(evt) {if (this.touch_started) {return this.search_results_mouseup(evt);}};AbstractChosen.prototype.outerHTML = function(element) {var tmp;if (element.outerHTML) {return element.outerHTML;}
tmp = document.createElement("div");tmp.appendChild(element);return tmp.innerHTML;};AbstractChosen.prototype.get_single_html = function() {return "<a class=\"chosen-single chosen-default\">\n  <span>" + this.default_text + "</span>\n  <div><b></b></div>\n</a>\n<div class=\"chosen-drop\">\n  <div class=\"chosen-search\">\n    <input class=\"chosen-search-input\" type=\"text\" autocomplete=\"off\" />\n  </div>\n  <ul class=\"chosen-results\"></ul>\n</div>";};AbstractChosen.prototype.get_multi_html = function() {return "<ul class=\"chosen-choices\">\n  <li class=\"search-field\">\n    <input class=\"chosen-search-input\" type=\"text\" autocomplete=\"off\" value=\"" + this.default_text + "\" />\n  </li>\n</ul>\n<div class=\"chosen-drop\">\n  <ul class=\"chosen-results\"></ul>\n</div>";};AbstractChosen.prototype.get_no_results_html = function(terms) {return "<li class=\"no-results\">\n  " + this.results_none_found + " <span>" + terms + "</span>\n</li>";};AbstractChosen.browser_is_supported = function() {if ("Microsoft Internet Explorer" === window.navigator.appName) {return document.documentMode >= 8;}
if (/iP(od|hone)/i.test(window.navigator.userAgent) || /IEMobile/i.test(window.navigator.userAgent) || /Windows Phone/i.test(window.navigator.userAgent) || /BlackBerry/i.test(window.navigator.userAgent) || /BB10/i.test(window.navigator.userAgent) || /Android.*Mobile/i.test(window.navigator.userAgent)) {return false;}
return true;};AbstractChosen.default_multiple_text = "Select Some Options";AbstractChosen.default_single_text = "Select an Option";AbstractChosen.default_no_result_text = "No results match";return AbstractChosen;})();$ = jQuery;$.fn.extend({chosen: function(options) {if (!AbstractChosen.browser_is_supported()) {return this;}
return this.each(function(input_field) {var $this, chosen;$this = $(this);chosen = $this.data('chosen');if (options === 'destroy') {if (chosen instanceof Chosen) {chosen.destroy();}
return;}
if (!(chosen instanceof Chosen)) {$this.data('chosen', new Chosen(this, options));}});}});Chosen = (function(_super) {__extends(Chosen, _super);function Chosen() {_ref = Chosen.__super__.constructor.apply(this, arguments);return _ref;}
Chosen.prototype.setup = function() {this.form_field_jq = $(this.form_field);return this.current_selectedIndex = this.form_field.selectedIndex;};Chosen.prototype.set_up_html = function() {var container_classes, container_props;container_classes = ["chosen-container"];container_classes.push("chosen-container-" + (this.is_multiple ? "multi" : "single"));if (this.inherit_select_classes && this.form_field.className) {container_classes.push(this.form_field.className);}
if (this.is_rtl) {container_classes.push("chosen-rtl");}
container_props = {'class': container_classes.join(' '),'title': this.form_field.title};if (this.form_field.id.length) {container_props.id = this.form_field.id.replace(/[^\w]/g, '_') + "_chosen";}
this.container = $("<div />", container_props);this.container.width(this.container_width());if (this.is_multiple) {this.container.html(this.get_multi_html());} else {this.container.html(this.get_single_html());}
this.form_field_jq.hide().after(this.container);this.dropdown = this.container.find('div.chosen-drop').first();this.search_field = this.container.find('input').first();this.search_results = this.container.find('ul.chosen-results').first();this.search_field_scale();this.search_no_results = this.container.find('li.no-results').first();if (this.is_multiple) {this.search_choices = this.container.find('ul.chosen-choices').first();this.search_container = this.container.find('li.search-field').first();} else {this.search_container = this.container.find('div.chosen-search').first();this.selected_item = this.container.find('.chosen-single').first();}
this.results_build();this.set_tab_index();return this.set_label_behavior();};Chosen.prototype.on_ready = function() {return this.form_field_jq.trigger("chosen:ready", {chosen: this});};Chosen.prototype.register_observers = function() {var _this = this;this.container.bind('touchstart.chosen', function(evt) {_this.container_mousedown(evt);});this.container.bind('touchend.chosen', function(evt) {_this.container_mouseup(evt);});this.container.bind('mousedown.chosen', function(evt) {_this.container_mousedown(evt);});this.container.bind('mouseup.chosen', function(evt) {_this.container_mouseup(evt);});this.container.bind('mouseenter.chosen', function(evt) {_this.mouse_enter(evt);});this.container.bind('mouseleave.chosen', function(evt) {_this.mouse_leave(evt);});this.search_results.bind('mouseup.chosen', function(evt) {_this.search_results_mouseup(evt);});this.search_results.bind('mouseover.chosen', function(evt) {_this.search_results_mouseover(evt);});this.search_results.bind('mouseout.chosen', function(evt) {_this.search_results_mouseout(evt);});this.search_results.bind('mousewheel.chosen DOMMouseScroll.chosen', function(evt) {_this.search_results_mousewheel(evt);});this.search_results.bind('touchstart.chosen', function(evt) {_this.search_results_touchstart(evt);});this.search_results.bind('touchmove.chosen', function(evt) {_this.search_results_touchmove(evt);});this.search_results.bind('touchend.chosen', function(evt) {_this.search_results_touchend(evt);});this.form_field_jq.bind("chosen:updated.chosen", function(evt) {_this.results_update_field(evt);});this.form_field_jq.bind("chosen:activate.chosen", function(evt) {_this.activate_field(evt);});this.form_field_jq.bind("chosen:open.chosen", function(evt) {_this.container_mousedown(evt);});this.form_field_jq.bind("chosen:close.chosen", function(evt) {_this.close_field(evt);});this.search_field.bind('blur.chosen', function(evt) {_this.input_blur(evt);});this.search_field.bind('keyup.chosen', function(evt) {_this.keyup_checker(evt);});this.search_field.bind('keydown.chosen', function(evt) {_this.keydown_checker(evt);});this.search_field.bind('focus.chosen', function(evt) {_this.input_focus(evt);});this.search_field.bind('cut.chosen', function(evt) {_this.clipboard_event_checker(evt);});this.search_field.bind('paste.chosen', function(evt) {_this.clipboard_event_checker(evt);});if (this.is_multiple) {return this.search_choices.bind('click.chosen', function(evt) {_this.choices_click(evt);});} else {return this.container.bind('click.chosen', function(evt) {evt.preventDefault();});}};Chosen.prototype.destroy = function() {$(this.container[0].ownerDocument).unbind('click.chosen', this.click_test_action);if (this.form_field_label.length > 0) {this.form_field_label.unbind('click.chosen');}
if (this.search_field[0].tabIndex) {this.form_field_jq[0].tabIndex = this.search_field[0].tabIndex;}
this.container.remove();this.form_field_jq.removeData('chosen');return this.form_field_jq.show();};Chosen.prototype.search_field_disabled = function() {this.is_disabled = this.form_field.disabled || this.form_field_jq.parents('fieldset').is(':disabled');this.container.toggleClass('chosen-disabled', this.is_disabled);this.search_field[0].disabled = this.is_disabled;if (!this.is_multiple) {this.selected_item.unbind('focus.chosen', this.activate_field);}
if (this.is_disabled) {return this.close_field();} else if (!this.is_multiple) {return this.selected_item.bind('focus.chosen', this.activate_field);}};Chosen.prototype.container_mousedown = function(evt) {var _ref1;if (this.is_disabled) {return;}
if (evt && ((_ref1 = evt.type) === 'mousedown' || _ref1 === 'touchstart') && !this.results_showing) {evt.preventDefault();}
if (!((evt != null) && ($(evt.target)).hasClass("search-choice-close"))) {if (!this.active_field) {if (this.is_multiple) {this.search_field.val("");}
$(this.container[0].ownerDocument).bind('click.chosen', this.click_test_action);this.results_show();} else if (!this.is_multiple && evt && (($(evt.target)[0] === this.selected_item[0]) || $(evt.target).parents("a.chosen-single").length)) {evt.preventDefault();this.results_toggle();}
return this.activate_field();}};Chosen.prototype.container_mouseup = function(evt) {if (evt.target.nodeName === "ABBR" && !this.is_disabled) {return this.results_reset(evt);}};Chosen.prototype.search_results_mousewheel = function(evt) {var delta;if (evt.originalEvent) {delta = evt.originalEvent.deltaY || -evt.originalEvent.wheelDelta || evt.originalEvent.detail;}
if (delta != null) {evt.preventDefault();if (evt.type === 'DOMMouseScroll') {delta = delta * 40;}
return this.search_results.scrollTop(delta + this.search_results.scrollTop());}};Chosen.prototype.blur_test = function(evt) {if (!this.active_field && this.container.hasClass("chosen-container-active")) {return this.close_field();}};Chosen.prototype.close_field = function() {$(this.container[0].ownerDocument).unbind("click.chosen", this.click_test_action);this.active_field = false;this.results_hide();this.container.removeClass("chosen-container-active");this.clear_backstroke();this.show_search_field_default();this.search_field_scale();return this.search_field.blur();};Chosen.prototype.activate_field = function() {if (this.is_disabled) {return;}
this.container.addClass("chosen-container-active");this.active_field = true;this.search_field.val(this.search_field.val());return this.search_field.focus();};Chosen.prototype.test_active_click = function(evt) {var active_container;active_container = $(evt.target).closest('.chosen-container');if (active_container.length && this.container[0] === active_container[0]) {return this.active_field = true;} else {return this.close_field();}};Chosen.prototype.results_build = function() {this.parsing = true;this.selected_option_count = null;this.results_data = SelectParser.select_to_array(this.form_field);if (this.is_multiple) {this.search_choices.find("li.search-choice").remove();} else if (!this.is_multiple) {this.single_set_selected_text();if (this.disable_search || this.form_field.options.length <= this.disable_search_threshold) {this.search_field[0].readOnly = true;this.container.addClass("chosen-container-single-nosearch");} else {this.search_field[0].readOnly = false;this.container.removeClass("chosen-container-single-nosearch");}}
this.update_results_content(this.results_option_build({first: true}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing = false;};Chosen.prototype.result_do_highlight = function(el) {var high_bottom, high_top, maxHeight, visible_bottom, visible_top;if (el.length) {this.result_clear_highlight();this.result_highlight = el;this.result_highlight.addClass("highlighted");maxHeight = parseInt(this.search_results.css("maxHeight"), 10);visible_top = this.search_results.scrollTop();visible_bottom = maxHeight + visible_top;high_top = this.result_highlight.position().top + this.search_results.scrollTop();high_bottom = high_top + this.result_highlight.outerHeight();if (high_bottom >= visible_bottom) {return this.search_results.scrollTop((high_bottom - maxHeight) > 0 ? high_bottom - maxHeight : 0);} else if (high_top < visible_top) {return this.search_results.scrollTop(high_top);}}};Chosen.prototype.result_clear_highlight = function() {if (this.result_highlight) {this.result_highlight.removeClass("highlighted");}
return this.result_highlight = null;};Chosen.prototype.results_show = function() {if (this.is_multiple && this.max_selected_options <= this.choices_count()) {this.form_field_jq.trigger("chosen:maxselected", {chosen: this});return false;}
this.container.addClass("chosen-with-drop");this.results_showing = true;this.search_field.focus();this.search_field.val(this.get_search_field_value());this.winnow_results();return this.form_field_jq.trigger("chosen:showing_dropdown", {chosen: this});};Chosen.prototype.update_results_content = function(content) {return this.search_results.html(content);};Chosen.prototype.results_hide = function() {if (this.results_showing) {this.result_clear_highlight();this.container.removeClass("chosen-with-drop");this.form_field_jq.trigger("chosen:hiding_dropdown", {chosen: this});}
return this.results_showing = false;};Chosen.prototype.set_tab_index = function(el) {var ti;if (this.form_field.tabIndex) {ti = this.form_field.tabIndex;this.form_field.tabIndex = -1;return this.search_field[0].tabIndex = ti;}};Chosen.prototype.set_label_behavior = function() {this.form_field_label = this.form_field_jq.parents("label");if (!this.form_field_label.length && this.form_field.id.length) {this.form_field_label = $("label[for='" + this.form_field.id + "']");}
if (this.form_field_label.length > 0) {return this.form_field_label.bind('click.chosen', this.label_click_handler);}};Chosen.prototype.show_search_field_default = function() {if (this.is_multiple && this.choices_count() < 1 && !this.active_field) {this.search_field.val(this.default_text);return this.search_field.addClass("default");} else {this.search_field.val("");return this.search_field.removeClass("default");}};Chosen.prototype.search_results_mouseup = function(evt) {var target;target = $(evt.target).hasClass("active-result") ? $(evt.target) : $(evt.target).parents(".active-result").first();if (target.length) {this.result_highlight = target;this.result_select(evt);return this.search_field.focus();}};Chosen.prototype.search_results_mouseover = function(evt) {var target;target = $(evt.target).hasClass("active-result") ? $(evt.target) : $(evt.target).parents(".active-result").first();if (target) {return this.result_do_highlight(target);}};Chosen.prototype.search_results_mouseout = function(evt) {if ($(evt.target).hasClass("active-result" || $(evt.target).parents('.active-result').first())) {return this.result_clear_highlight();}};Chosen.prototype.choice_build = function(item) {var choice, close_link,_this = this;choice = $('<li />', {"class": "search-choice"}).html("<span>" + (this.choice_label(item)) + "</span>");if (item.disabled) {choice.addClass('search-choice-disabled');} else {close_link = $('<a />', {"class": 'search-choice-close','data-option-array-index': item.array_index});close_link.bind('click.chosen', function(evt) {return _this.choice_destroy_link_click(evt);});choice.append(close_link);}
return this.search_container.before(choice);};Chosen.prototype.choice_destroy_link_click = function(evt) {evt.preventDefault();evt.stopPropagation();if (!this.is_disabled) {return this.choice_destroy($(evt.target));}};Chosen.prototype.choice_destroy = function(link) {if (this.result_deselect(link[0].getAttribute("data-option-array-index"))) {if (this.active_field) {this.search_field.focus();} else {this.show_search_field_default();}
if (this.is_multiple && this.choices_count() > 0 && this.get_search_field_value().length < 1) {this.results_hide();}
link.parents('li').first().remove();return this.search_field_scale();}};Chosen.prototype.results_reset = function() {this.reset_single_select_options();this.form_field.options[0].selected = true;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.trigger_form_field_change();if (this.active_field) {return this.results_hide();}};Chosen.prototype.results_reset_cleanup = function() {this.current_selectedIndex = this.form_field.selectedIndex;return this.selected_item.find("abbr").remove();};Chosen.prototype.result_select = function(evt) {var high, item;if (this.result_highlight) {high = this.result_highlight;this.result_clear_highlight();if (this.is_multiple && this.max_selected_options <= this.choices_count()) {this.form_field_jq.trigger("chosen:maxselected", {chosen: this});return false;}
if (this.is_multiple) {high.removeClass("active-result");} else {this.reset_single_select_options();}
high.addClass("result-selected");item = this.results_data[high[0].getAttribute("data-option-array-index")];item.selected = true;this.form_field.options[item.options_index].selected = true;this.selected_option_count = null;if (this.is_multiple) {this.choice_build(item);} else {this.single_set_selected_text(this.choice_label(item));}
if (!(this.is_multiple && (!this.hide_results_on_select || (evt.metaKey || evt.ctrlKey)))) {this.results_hide();this.show_search_field_default();}
if (this.is_multiple || this.form_field.selectedIndex !== this.current_selectedIndex) {this.trigger_form_field_change({selected: this.form_field.options[item.options_index].value});}
this.current_selectedIndex = this.form_field.selectedIndex;evt.preventDefault();return this.search_field_scale();}};Chosen.prototype.single_set_selected_text = function(text) {if (text == null) {text = this.default_text;}
if (text === this.default_text) {this.selected_item.addClass("chosen-default");} else {this.single_deselect_control_build();this.selected_item.removeClass("chosen-default");}
return this.selected_item.find("span").html(text);};Chosen.prototype.result_deselect = function(pos) {var result_data;result_data = this.results_data[pos];if (!this.form_field.options[result_data.options_index].disabled) {result_data.selected = false;this.form_field.options[result_data.options_index].selected = false;this.selected_option_count = null;this.result_clear_highlight();if (this.results_showing) {this.winnow_results();}
this.trigger_form_field_change({deselected: this.form_field.options[result_data.options_index].value});this.search_field_scale();return true;} else {return false;}};Chosen.prototype.single_deselect_control_build = function() {if (!this.allow_single_deselect) {return;}
if (!this.selected_item.find("abbr").length) {this.selected_item.find("span").first().after("<abbr class=\"search-choice-close\"></abbr>");}
return this.selected_item.addClass("chosen-single-with-deselect");};Chosen.prototype.get_search_field_value = function() {return this.search_field.val();};Chosen.prototype.get_search_text = function() {return this.escape_html($.trim(this.get_search_field_value()));};Chosen.prototype.escape_html = function(text) {return $('<div/>').text(text).html();};Chosen.prototype.winnow_results_set_highlight = function() {var do_high, selected_results;selected_results = !this.is_multiple ? this.search_results.find(".result-selected.active-result") : [];do_high = selected_results.length ? selected_results.first() : this.search_results.find(".active-result").first();if (do_high != null) {return this.result_do_highlight(do_high);}};Chosen.prototype.no_results = function(terms) {var no_results_html;no_results_html = this.get_no_results_html(terms);this.search_results.append(no_results_html);return this.form_field_jq.trigger("chosen:no_results", {chosen: this});};Chosen.prototype.no_results_clear = function() {return this.search_results.find(".no-results").remove();};Chosen.prototype.keydown_arrow = function() {var next_sib;if (this.results_showing && this.result_highlight) {next_sib = this.result_highlight.nextAll("li.active-result").first();if (next_sib) {return this.result_do_highlight(next_sib);}} else {return this.results_show();}};Chosen.prototype.keyup_arrow = function() {var prev_sibs;if (!this.results_showing && !this.is_multiple) {return this.results_show();} else if (this.result_highlight) {prev_sibs = this.result_highlight.prevAll("li.active-result");if (prev_sibs.length) {return this.result_do_highlight(prev_sibs.first());} else {if (this.choices_count() > 0) {this.results_hide();}
return this.result_clear_highlight();}}};Chosen.prototype.keydown_backstroke = function() {var next_available_destroy;if (this.pending_backstroke) {this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke();} else {next_available_destroy = this.search_container.siblings("li.search-choice").last();if (next_available_destroy.length && !next_available_destroy.hasClass("search-choice-disabled")) {this.pending_backstroke = next_available_destroy;if (this.single_backstroke_delete) {return this.keydown_backstroke();} else {return this.pending_backstroke.addClass("search-choice-focus");}}}};Chosen.prototype.clear_backstroke = function() {if (this.pending_backstroke) {this.pending_backstroke.removeClass("search-choice-focus");}
return this.pending_backstroke = null;};Chosen.prototype.search_field_scale = function() {var container_width, div, style, style_block, styles, width, _i, _len;if (!this.is_multiple) {return;}
style_block = {position: 'absolute',left: '-1000px',top: '-1000px',display: 'none',whiteSpace: 'pre'};styles = ['fontSize', 'fontStyle', 'fontWeight', 'fontFamily', 'lineHeight', 'textTransform', 'letterSpacing'];for (_i = 0, _len = styles.length; _i < _len; _i++) {style = styles[_i];style_block[style] = this.search_field.css(style);}
div = $('<div />').css(style_block);div.text(this.get_search_field_value());$('body').append(div);width = div.width() + 25;div.remove();container_width = this.container.outerWidth();width = Math.min(container_width - 10, width);return this.search_field.width(width);};Chosen.prototype.trigger_form_field_change = function(extra) {this.form_field_jq.trigger("input", extra);return this.form_field_jq.trigger("change", extra);};return Chosen;})(AbstractChosen);}).call(this);
/**
* Tom Select v2.3.1
* Licensed under the Apache License, Version 2.0 (the "License");
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TomSelect=t()}(this,(function(){"use strict"
function e(e,t){e.split(/\s+/).forEach((e=>{t(e)}))}class t{constructor(){this._events=void 0,this._events={}}on(t,i){e(t,(e=>{const t=this._events[e]||[]
t.push(i),this._events[e]=t}))}off(t,i){var s=arguments.length
0!==s?e(t,(e=>{if(1===s)return void delete this._events[e]
const t=this._events[e]
void 0!==t&&(t.splice(t.indexOf(i),1),this._events[e]=t)})):this._events={}}trigger(t,...i){var s=this
e(t,(e=>{const t=s._events[e]
void 0!==t&&t.forEach((e=>{e.apply(s,i)}))}))}}const i=e=>(e=e.filter(Boolean)).length<2?e[0]||"":1==l(e)?"["+e.join("")+"]":"(?:"+e.join("|")+")",s=e=>{if(!o(e))return e.join("")
let t="",i=0
const s=()=>{i>1&&(t+="{"+i+"}")}
return e.forEach(((n,o)=>{n!==e[o-1]?(s(),t+=n,i=1):i++})),s(),t},n=e=>{let t=c(e)
return i(t)},o=e=>new Set(e).size!==e.length,r=e=>(e+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),l=e=>e.reduce(((e,t)=>Math.max(e,a(t))),0),a=e=>c(e).length,c=e=>Array.from(e),d=e=>{if(1===e.length)return[[e]]
let t=[]
const i=e.substring(1)
return d(i).forEach((function(i){let s=i.slice(0)
s[0]=e.charAt(0)+s[0],t.push(s),s=i.slice(0),s.unshift(e.charAt(0)),t.push(s)})),t},u=[[0,65535]]
let p,h
const g={},f={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"}
for(let e in f){let t=f[e]||""
for(let i=0;i<t.length;i++){let s=t.substring(i,i+1)
g[s]=e}}const v=new RegExp(Object.keys(g).join("|")+"|[̀-ͯ·ʾʼ]","gu"),m=(e,t="NFKD")=>e.normalize(t),y=e=>c(e).reduce(((e,t)=>e+O(t)),""),O=e=>(e=m(e).toLowerCase().replace(v,(e=>g[e]||"")),m(e,"NFC"))
const b=e=>{const t={},i=(e,i)=>{const s=t[e]||new Set,o=new RegExp("^"+n(s)+"$","iu")
i.match(o)||(s.add(r(i)),t[e]=s)}
for(let t of function*(e){for(const[t,i]of e)for(let e=t;e<=i;e++){let t=String.fromCharCode(e),i=y(t)
i!=t.toLowerCase()&&(i.length>3||0!=i.length&&(yield{folded:i,composed:t,code_point:e}))}}(e))i(t.folded,t.folded),i(t.folded,t.composed)
return t},w=e=>{const t=b(e),s={}
let o=[]
for(let e in t){let i=t[e]
i&&(s[e]=n(i)),e.length>1&&o.push(r(e))}o.sort(((e,t)=>t.length-e.length))
const l=i(o)
return h=new RegExp("^"+l,"u"),s},_=(e,t=1)=>(t=Math.max(t,e.length-1),i(d(e).map((e=>((e,t=1)=>{let i=0
return e=e.map((e=>(p[e]&&(i+=e.length),p[e]||e))),i>=t?s(e):""})(e,t))))),C=(e,t=!0)=>{let n=e.length>1?1:0
return i(e.map((e=>{let i=[]
const o=t?e.length():e.length()-1
for(let t=0;t<o;t++)i.push(_(e.substrs[t]||"",n))
return s(i)})))},S=(e,t)=>{for(const i of t){if(i.start!=e.start||i.end!=e.end)continue
if(i.substrs.join("")!==e.substrs.join(""))continue
let t=e.parts
const s=e=>{for(const i of t){if(i.start===e.start&&i.substr===e.substr)return!1
if(1!=e.length&&1!=i.length){if(e.start<i.start&&e.end>i.start)return!0
if(i.start<e.start&&i.end>e.start)return!0}}return!1}
if(!(i.parts.filter(s).length>0))return!0}return!1}
class I{constructor(){this.parts=[],this.substrs=[],this.start=0,this.end=0}add(e){e&&(this.parts.push(e),this.substrs.push(e.substr),this.start=Math.min(e.start,this.start),this.end=Math.max(e.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(e,t){let i=new I,s=JSON.parse(JSON.stringify(this.parts)),n=s.pop()
for(const e of s)i.add(e)
let o=t.substr.substring(0,e-n.start),r=o.length
return i.add({start:n.start,end:n.start+r,length:r,substr:o}),i}}const A=e=>{var t
void 0===p&&(p=w(t||u)),e=y(e)
let i="",s=[new I]
for(let t=0;t<e.length;t++){let n=e.substring(t).match(h)
const o=e.substring(t,t+1),r=n?n[0]:null
let l=[],a=new Set
for(const e of s){const i=e.last()
if(!i||1==i.length||i.end<=t)if(r){const i=r.length
e.add({start:t,end:t+i,length:i,substr:r}),a.add("1")}else e.add({start:t,end:t+1,length:1,substr:o}),a.add("2")
else if(r){let s=e.clone(t,i)
const n=r.length
s.add({start:t,end:t+n,length:n,substr:r}),l.push(s)}else a.add("3")}if(l.length>0){l=l.sort(((e,t)=>e.length()-t.length()))
for(let e of l)S(e,s)||s.push(e)}else if(t>0&&1==a.size&&!a.has("3")){i+=C(s,!1)
let e=new I
const t=s[0]
t&&e.add(t.last()),s=[e]}}return i+=C(s,!0),i},x=(e,t)=>{if(e)return e[t]},k=(e,t)=>{if(e){for(var i,s=t.split(".");(i=s.shift())&&(e=e[i]););return e}},F=(e,t,i)=>{var s,n
return e?(e+="",null==t.regex||-1===(n=e.search(t.regex))?0:(s=t.string.length/e.length,0===n&&(s+=.5),s*i)):0},L=(e,t)=>{var i=e[t]
if("function"==typeof i)return i
i&&!Array.isArray(i)&&(e[t]=[i])},E=(e,t)=>{if(Array.isArray(e))e.forEach(t)
else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)},T=(e,t)=>"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=y(e+"").toLowerCase())>(t=y(t+"").toLowerCase())?1:t>e?-1:0
class P{constructor(e,t){this.items=void 0,this.settings=void 0,this.items=e,this.settings=t||{diacritics:!0}}tokenize(e,t,i){if(!e||!e.length)return[]
const s=[],n=e.split(/\s+/)
var o
return i&&(o=new RegExp("^("+Object.keys(i).map(r).join("|")+"):(.*)$")),n.forEach((e=>{let i,n=null,l=null
o&&(i=e.match(o))&&(n=i[1],e=i[2]),e.length>0&&(l=this.settings.diacritics?A(e)||null:r(e),l&&t&&(l="\\b"+l)),s.push({string:e,regex:l?new RegExp(l,"iu"):null,field:n})})),s}getScoreFunction(e,t){var i=this.prepareSearch(e,t)
return this._getScoreFunction(i)}_getScoreFunction(e){const t=e.tokens,i=t.length
if(!i)return function(){return 0}
const s=e.options.fields,n=e.weights,o=s.length,r=e.getAttrFn
if(!o)return function(){return 1}
const l=1===o?function(e,t){const i=s[0].field
return F(r(t,i),e,n[i]||1)}:function(e,t){var i=0
if(e.field){const s=r(t,e.field)
!e.regex&&s?i+=1/o:i+=F(s,e,1)}else E(n,((s,n)=>{i+=F(r(t,n),e,s)}))
return i/o}
return 1===i?function(e){return l(t[0],e)}:"and"===e.options.conjunction?function(e){var s,n=0
for(let i of t){if((s=l(i,e))<=0)return 0
n+=s}return n/i}:function(e){var s=0
return E(t,(t=>{s+=l(t,e)})),s/i}}getSortFunction(e,t){var i=this.prepareSearch(e,t)
return this._getSortFunction(i)}_getSortFunction(e){var t,i=[]
const s=this,n=e.options,o=!e.query&&n.sort_empty?n.sort_empty:n.sort
if("function"==typeof o)return o.bind(this)
const r=function(t,i){return"$score"===t?i.score:e.getAttrFn(s.items[i.id],t)}
if(o)for(let t of o)(e.query||"$score"!==t.field)&&i.push(t)
if(e.query){t=!0
for(let e of i)if("$score"===e.field){t=!1
break}t&&i.unshift({field:"$score",direction:"desc"})}else i=i.filter((e=>"$score"!==e.field))
return i.length?function(e,t){var s,n
for(let o of i){if(n=o.field,s=("desc"===o.direction?-1:1)*T(r(n,e),r(n,t)))return s}return 0}:null}prepareSearch(e,t){const i={}
var s=Object.assign({},t)
if(L(s,"sort"),L(s,"sort_empty"),s.fields){L(s,"fields")
const e=[]
s.fields.forEach((t=>{"string"==typeof t&&(t={field:t,weight:1}),e.push(t),i[t.field]="weight"in t?t.weight:1})),s.fields=e}return{options:s,query:e.toLowerCase().trim(),tokens:this.tokenize(e,s.respect_word_boundaries,i),total:0,items:[],weights:i,getAttrFn:s.nesting?k:x}}search(e,t){var i,s,n=this
s=this.prepareSearch(e,t),t=s.options,e=s.query
const o=t.score||n._getScoreFunction(s)
e.length?E(n.items,((e,n)=>{i=o(e),(!1===t.filter||i>0)&&s.items.push({score:i,id:n})})):E(n.items,((e,t)=>{s.items.push({score:1,id:t})}))
const r=n._getSortFunction(s)
return r&&s.items.sort(r),s.total=s.items.length,"number"==typeof t.limit&&(s.items=s.items.slice(0,t.limit)),s}}const N=(e,t)=>{if(Array.isArray(e))e.forEach(t)
else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)},j=e=>{if(e.jquery)return e[0]
if(e instanceof HTMLElement)return e
if($(e)){var t=document.createElement("template")
return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)},$=e=>"string"==typeof e&&e.indexOf("<")>-1,V=(e,t)=>{var i=document.createEvent("HTMLEvents")
i.initEvent(t,!0,!1),e.dispatchEvent(i)},q=(e,t)=>{Object.assign(e.style,t)},D=(e,...t)=>{var i=H(t);(e=M(e)).map((e=>{i.map((t=>{e.classList.add(t)}))}))},R=(e,...t)=>{var i=H(t);(e=M(e)).map((e=>{i.map((t=>{e.classList.remove(t)}))}))},H=e=>{var t=[]
return N(e,(e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))})),t.filter(Boolean)},M=e=>(Array.isArray(e)||(e=[e]),e),z=(e,t,i)=>{if(!i||i.contains(e))for(;e&&e.matches;){if(e.matches(t))return e
e=e.parentNode}},B=(e,t=0)=>t>0?e[e.length-1]:e[0],K=(e,t)=>{if(!e)return-1
t=t||e.nodeName
for(var i=0;e=e.previousElementSibling;)e.matches(t)&&i++
return i},Q=(e,t)=>{N(t,((t,i)=>{null==t?e.removeAttribute(i):e.setAttribute(i,""+t)}))},G=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)},U=(e,t)=>{if(null===t)return
if("string"==typeof t){if(!t.length)return
t=new RegExp(t,"i")}const i=e=>3===e.nodeType?(e=>{var i=e.data.match(t)
if(i&&e.data.length>0){var s=document.createElement("span")
s.className="highlight"
var n=e.splitText(i.index)
n.splitText(i[0].length)
var o=n.cloneNode(!0)
return s.appendChild(o),G(n,s),1}return 0})(e):((e=>{1!==e.nodeType||!e.childNodes||/(script|style)/i.test(e.tagName)||"highlight"===e.className&&"SPAN"===e.tagName||Array.from(e.childNodes).forEach((e=>{i(e)}))})(e),0)
i(e)},J="undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent)?"metaKey":"ctrlKey"
var W={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return e.length>0},render:{}}
const X=e=>null==e?null:Y(e),Y=e=>"boolean"==typeof e?e?"1":"0":e+"",Z=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),ee=(e,t)=>{var i
return function(s,n){var o=this
i&&(o.loading=Math.max(o.loading-1,0),clearTimeout(i)),i=setTimeout((function(){i=null,o.loadedSearches[s]=!0,e.call(o,s,n)}),t)}},te=(e,t,i)=>{var s,n=e.trigger,o={}
for(s of(e.trigger=function(){var i=arguments[0]
if(-1===t.indexOf(i))return n.apply(e,arguments)
o[i]=arguments},i.apply(e,[]),e.trigger=n,t))s in o&&n.apply(e,o[s])},ie=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},se=(e,t,i,s)=>{e.addEventListener(t,i,s)},ne=(e,t)=>!!t&&(!!t[e]&&1===(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0)),oe=(e,t)=>{const i=e.getAttribute("id")
return i||(e.setAttribute("id",t),t)},re=e=>e.replace(/[\\"']/g,"\\$&"),le=(e,t)=>{t&&e.append(t)}
function ae(e,t){var i=Object.assign({},W,t),s=i.dataAttr,n=i.labelField,o=i.valueField,r=i.disabledField,l=i.optgroupField,a=i.optgroupLabelField,c=i.optgroupValueField,d=e.tagName.toLowerCase(),u=e.getAttribute("placeholder")||e.getAttribute("data-placeholder")
if(!u&&!i.allowEmptyOption){let t=e.querySelector('option[value=""]')
t&&(u=t.textContent)}var p={placeholder:u,options:[],optgroups:[],items:[],maxItems:null}
return"select"===d?(()=>{var t,d=p.options,u={},h=1
let g=0
var f=e=>{var t=Object.assign({},e.dataset),i=s&&t[s]
return"string"==typeof i&&i.length&&(t=Object.assign(t,JSON.parse(i))),t},v=(e,t)=>{var s=X(e.value)
if(null!=s&&(s||i.allowEmptyOption)){if(u.hasOwnProperty(s)){if(t){var a=u[s][l]
a?Array.isArray(a)?a.push(t):u[s][l]=[a,t]:u[s][l]=t}}else{var c=f(e)
c[n]=c[n]||e.textContent,c[o]=c[o]||s,c[r]=c[r]||e.disabled,c[l]=c[l]||t,c.$option=e,c.$order=c.$order||++g,u[s]=c,d.push(c)}e.selected&&p.items.push(s)}}
p.maxItems=e.hasAttribute("multiple")?null:1,N(e.children,(e=>{var i,s,n
"optgroup"===(t=e.tagName.toLowerCase())?((n=f(i=e))[a]=n[a]||i.getAttribute("label")||"",n[c]=n[c]||h++,n[r]=n[r]||i.disabled,n.$order=n.$order||++g,p.optgroups.push(n),s=n[c],N(i.children,(e=>{v(e,s)}))):"option"===t&&v(e)}))})():(()=>{const t=e.getAttribute(s)
if(t)p.options=JSON.parse(t),N(p.options,(e=>{p.items.push(e[o])}))
else{var r=e.value.trim()||""
if(!i.allowEmptyOption&&!r.length)return
const t=r.split(i.delimiter)
N(t,(e=>{const t={}
t[n]=e,t[o]=e,p.options.push(t)})),p.items=t}})(),Object.assign({},W,p,t)}var ce=0
class de extends(function(e){return e.plugins={},class extends e{constructor(...e){super(...e),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,i){e.plugins[t]={name:t,fn:i}}initializePlugins(e){var t,i
const s=this,n=[]
if(Array.isArray(e))e.forEach((e=>{"string"==typeof e?n.push(e):(s.plugins.settings[e.name]=e.options,n.push(e.name))}))
else if(e)for(t in e)e.hasOwnProperty(t)&&(s.plugins.settings[t]=e[t],n.push(t))
for(;i=n.shift();)s.require(i)}loadPlugin(t){var i=this,s=i.plugins,n=e.plugins[t]
if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin')
s.requested[t]=!0,s.loaded[t]=n.fn.apply(i,[i.plugins.settings[t]||{}]),s.names.push(t)}require(e){var t=this,i=t.plugins
if(!t.plugins.loaded.hasOwnProperty(e)){if(i.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")')
t.loadPlugin(e)}return i.loaded[e]}}}(t)){constructor(e,t){var i
super(),this.control_input=void 0,this.wrapper=void 0,this.dropdown=void 0,this.control=void 0,this.dropdown_content=void 0,this.focus_node=void 0,this.order=0,this.settings=void 0,this.input=void 0,this.tabIndex=void 0,this.is_select_tag=void 0,this.rtl=void 0,this.inputId=void 0,this._destroy=void 0,this.sifter=void 0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isRequired=void 0,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.currentResults=void 0,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,ce++
var s=j(e)
if(s.tomselect)throw new Error("Tom Select already initialized on this element")
s.tomselect=this,i=(window.getComputedStyle&&window.getComputedStyle(s,null)).getPropertyValue("direction")
const n=ae(s,t)
this.settings=n,this.input=s,this.tabIndex=s.tabIndex||0,this.is_select_tag="select"===s.tagName.toLowerCase(),this.rtl=/rtl/i.test(i),this.inputId=oe(s,"tomselect-"+ce),this.isRequired=s.required,this.sifter=new P(this.options,{diacritics:n.diacritics}),n.mode=n.mode||(1===n.maxItems?"single":"multi"),"boolean"!=typeof n.hideSelected&&(n.hideSelected="multi"===n.mode),"boolean"!=typeof n.hidePlaceholder&&(n.hidePlaceholder="multi"!==n.mode)
var o=n.createFilter
"function"!=typeof o&&("string"==typeof o&&(o=new RegExp(o)),o instanceof RegExp?n.createFilter=e=>o.test(e):n.createFilter=e=>this.settings.duplicates||!this.options[e]),this.initializePlugins(n.plugins),this.setupCallbacks(),this.setupTemplates()
const r=j("<div>"),l=j("<div>"),a=this._render("dropdown"),c=j('<div role="listbox" tabindex="-1">'),d=this.input.getAttribute("class")||"",u=n.mode
var p
if(D(r,n.wrapperClass,d,u),D(l,n.controlClass),le(r,l),D(a,n.dropdownClass,u),n.copyClassesToDropdown&&D(a,d),D(c,n.dropdownContentClass),le(a,c),j(n.dropdownParent||r).appendChild(a),$(n.controlInput)){p=j(n.controlInput)
E(["autocorrect","autocapitalize","autocomplete","spellcheck"],(e=>{s.getAttribute(e)&&Q(p,{[e]:s.getAttribute(e)})})),p.tabIndex=-1,l.appendChild(p),this.focus_node=p}else n.controlInput?(p=j(n.controlInput),this.focus_node=p):(p=j("<input/>"),this.focus_node=l)
this.wrapper=r,this.dropdown=a,this.dropdown_content=c,this.control=l,this.control_input=p,this.setup()}setup(){const e=this,t=e.settings,i=e.control_input,s=e.dropdown,n=e.dropdown_content,o=e.wrapper,l=e.control,a=e.input,c=e.focus_node,d={passive:!0},u=e.inputId+"-ts-dropdown"
Q(n,{id:u}),Q(c,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":u})
const p=oe(c,e.inputId+"-ts-control"),h="label[for='"+(e=>e.replace(/['"\\]/g,"\\$&"))(e.inputId)+"']",g=document.querySelector(h),f=e.focus.bind(e)
if(g){se(g,"click",f),Q(g,{for:p})
const t=oe(g,e.inputId+"-ts-label")
Q(c,{"aria-labelledby":t}),Q(n,{"aria-labelledby":t})}if(o.style.width=a.style.width,e.plugins.names.length){const t="plugin-"+e.plugins.names.join(" plugin-")
D([o,s],t)}(null===t.maxItems||t.maxItems>1)&&e.is_select_tag&&Q(a,{multiple:"multiple"}),t.placeholder&&Q(i,{placeholder:t.placeholder}),!t.splitOn&&t.delimiter&&(t.splitOn=new RegExp("\\s*"+r(t.delimiter)+"+\\s*")),t.load&&t.loadThrottle&&(t.load=ee(t.load,t.loadThrottle)),se(s,"mousemove",(()=>{e.ignoreHover=!1})),se(s,"mouseenter",(t=>{var i=z(t.target,"[data-selectable]",s)
i&&e.onOptionHover(t,i)}),{capture:!0}),se(s,"click",(t=>{const i=z(t.target,"[data-selectable]")
i&&(e.onOptionSelect(t,i),ie(t,!0))})),se(l,"click",(t=>{var s=z(t.target,"[data-ts-item]",l)
s&&e.onItemSelect(t,s)?ie(t,!0):""==i.value&&(e.onClick(),ie(t,!0))})),se(c,"keydown",(t=>e.onKeyDown(t))),se(i,"keypress",(t=>e.onKeyPress(t))),se(i,"input",(t=>e.onInput(t))),se(c,"blur",(t=>e.onBlur(t))),se(c,"focus",(t=>e.onFocus(t))),se(i,"paste",(t=>e.onPaste(t)))
const v=t=>{const n=t.composedPath()[0]
if(!o.contains(n)&&!s.contains(n))return e.isFocused&&e.blur(),void e.inputState()
n==i&&e.isOpen?t.stopPropagation():ie(t,!0)},m=()=>{e.isOpen&&e.positionDropdown()}
se(document,"mousedown",v),se(window,"scroll",m,d),se(window,"resize",m,d),this._destroy=()=>{document.removeEventListener("mousedown",v),window.removeEventListener("scroll",m),window.removeEventListener("resize",m),g&&g.removeEventListener("click",f)},this.revertSettings={innerHTML:a.innerHTML,tabIndex:a.tabIndex},a.tabIndex=-1,a.insertAdjacentElement("afterend",e.wrapper),e.sync(!1),t.items=[],delete t.optgroups,delete t.options,se(a,"invalid",(()=>{e.isValid&&(e.isValid=!1,e.isInvalid=!0,e.refreshState())})),e.updateOriginalInput(),e.refreshItems(),e.close(!1),e.inputState(),e.isSetup=!0,a.disabled?e.disable():a.readOnly?e.setReadOnly(!0):e.enable(),e.on("change",this.onChange),D(a,"tomselected","ts-hidden-accessible"),e.trigger("initialize"),!0===t.preload&&e.preload()}setupOptions(e=[],t=[]){this.addOptions(e),E(t,(e=>{this.registerOptionGroup(e)}))}setupTemplates(){var e=this,t=e.settings.labelField,i=e.settings.optgroupLabelField,s={optgroup:e=>{let t=document.createElement("div")
return t.className="optgroup",t.appendChild(e.options),t},optgroup_header:(e,t)=>'<div class="optgroup-header">'+t(e[i])+"</div>",option:(e,i)=>"<div>"+i(e[t])+"</div>",item:(e,i)=>"<div>"+i(e[t])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"}
e.settings.render=Object.assign({},s,e.settings.render)}setupCallbacks(){var e,t,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"}
for(e in i)(t=this.settings[i[e]])&&this.on(e,t)}sync(e=!0){const t=this,i=e?ae(t.input,{delimiter:t.settings.delimiter}):t.settings
t.setupOptions(i.options,i.optgroups),t.setValue(i.items||[],!0),t.lastQuery=null}onClick(){var e=this
if(e.activeItems.length>0)return e.clearActiveItems(),void e.focus()
e.isFocused&&e.isOpen?e.blur():e.focus()}onMouseDown(){}onChange(){V(this.input,"input"),V(this.input,"change")}onPaste(e){var t=this
t.isInputHidden||t.isLocked?ie(e):t.settings.splitOn&&setTimeout((()=>{var e=t.inputValue()
if(e.match(t.settings.splitOn)){var i=e.trim().split(t.settings.splitOn)
E(i,(e=>{X(e)&&(this.options[e]?t.addItem(e):t.createItem(e))}))}}),0)}onKeyPress(e){var t=this
if(!t.isLocked){var i=String.fromCharCode(e.keyCode||e.which)
return t.settings.create&&"multi"===t.settings.mode&&i===t.settings.delimiter?(t.createItem(),void ie(e)):void 0}ie(e)}onKeyDown(e){var t=this
if(t.ignoreHover=!0,t.isLocked)9!==e.keyCode&&ie(e)
else{switch(e.keyCode){case 65:if(ne(J,e)&&""==t.control_input.value)return ie(e),void t.selectAll()
break
case 27:return t.isOpen&&(ie(e,!0),t.close()),void t.clearActiveItems()
case 40:if(!t.isOpen&&t.hasOptions)t.open()
else if(t.activeOption){let e=t.getAdjacent(t.activeOption,1)
e&&t.setActiveOption(e)}return void ie(e)
case 38:if(t.activeOption){let e=t.getAdjacent(t.activeOption,-1)
e&&t.setActiveOption(e)}return void ie(e)
case 13:return void(t.canSelect(t.activeOption)?(t.onOptionSelect(e,t.activeOption),ie(e)):(t.settings.create&&t.createItem()||document.activeElement==t.control_input&&t.isOpen)&&ie(e))
case 37:return void t.advanceSelection(-1,e)
case 39:return void t.advanceSelection(1,e)
case 9:return void(t.settings.selectOnTab&&(t.canSelect(t.activeOption)&&(t.onOptionSelect(e,t.activeOption),ie(e)),t.settings.create&&t.createItem()&&ie(e)))
case 8:case 46:return void t.deleteSelection(e)}t.isInputHidden&&!ne(J,e)&&ie(e)}}onInput(e){if(this.isLocked)return
const t=this.inputValue()
this.lastValue!==t&&(this.lastValue=t,""!=t?(this.refreshTimeout&&clearTimeout(this.refreshTimeout),this.refreshTimeout=((e,t)=>t>0?setTimeout(e,t):(e.call(null),null))((()=>{this.refreshTimeout=null,this._onInput()}),this.settings.refreshThrottle)):this._onInput())}_onInput(){const e=this.lastValue
this.settings.shouldLoad.call(this,e)&&this.load(e),this.refreshOptions(),this.trigger("type",e)}onOptionHover(e,t){this.ignoreHover||this.setActiveOption(t,!1)}onFocus(e){var t=this,i=t.isFocused
if(t.isDisabled||t.isReadOnly)return t.blur(),void ie(e)
t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.preload(),i||t.trigger("focus"),t.activeItems.length||(t.inputState(),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())}onBlur(e){if(!1!==document.hasFocus()){var t=this
if(t.isFocused){t.isFocused=!1,t.ignoreFocus=!1
var i=()=>{t.close(),t.setActiveItem(),t.setCaret(t.items.length),t.trigger("blur")}
t.settings.create&&t.settings.createOnBlur?t.createItem(null,i):i()}}}onOptionSelect(e,t){var i,s=this
t.parentElement&&t.parentElement.matches("[data-disabled]")||(t.classList.contains("create")?s.createItem(null,(()=>{s.settings.closeAfterSelect&&s.close()})):void 0!==(i=t.dataset.value)&&(s.lastQuery=null,s.addItem(i),s.settings.closeAfterSelect&&s.close(),!s.settings.hideSelected&&e.type&&/click/.test(e.type)&&s.setActiveOption(t)))}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,t){var i=this
return!i.isLocked&&"multi"===i.settings.mode&&(ie(e),i.setActiveItem(t,e),!0)}canLoad(e){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(e)}load(e){const t=this
if(!t.canLoad(e))return
D(t.wrapper,t.settings.loadingClass),t.loading++
const i=t.loadCallback.bind(t)
t.settings.load.call(t,e,i)}loadCallback(e,t){const i=this
i.loading=Math.max(i.loading-1,0),i.lastQuery=null,i.clearActiveOption(),i.setupOptions(e,t),i.refreshOptions(i.isFocused&&!i.isInputHidden),i.loading||R(i.wrapper,i.settings.loadingClass),i.trigger("load",e,t)}preload(){var e=this.wrapper.classList
e.contains("preloaded")||(e.add("preloaded"),this.load(""))}setTextboxValue(e=""){var t=this.control_input
t.value!==e&&(t.value=e,V(t,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){te(this,t?[]:["change"],(()=>{this.clear(t),this.addItems(e,t)}))}setMaxItems(e){0===e&&(e=null),this.settings.maxItems=e,this.refreshState()}setActiveItem(e,t){var i,s,n,o,r,l,a=this
if("single"!==a.settings.mode){if(!e)return a.clearActiveItems(),void(a.isFocused&&a.inputState())
if("click"===(i=t&&t.type.toLowerCase())&&ne("shiftKey",t)&&a.activeItems.length){for(l=a.getLastActive(),(n=Array.prototype.indexOf.call(a.control.children,l))>(o=Array.prototype.indexOf.call(a.control.children,e))&&(r=n,n=o,o=r),s=n;s<=o;s++)e=a.control.children[s],-1===a.activeItems.indexOf(e)&&a.setActiveItemClass(e)
ie(t)}else"click"===i&&ne(J,t)||"keydown"===i&&ne("shiftKey",t)?e.classList.contains("active")?a.removeActiveItem(e):a.setActiveItemClass(e):(a.clearActiveItems(),a.setActiveItemClass(e))
a.inputState(),a.isFocused||a.focus()}}setActiveItemClass(e){const t=this,i=t.control.querySelector(".last-active")
i&&R(i,"last-active"),D(e,"active last-active"),t.trigger("item_select",e),-1==t.activeItems.indexOf(e)&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e)
this.activeItems.splice(t,1),R(e,"active")}clearActiveItems(){R(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e,t=!0){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,Q(this.focus_node,{"aria-activedescendant":e.getAttribute("id")}),Q(e,{"aria-selected":"true"}),D(e,"active"),t&&this.scrollToOption(e)))}scrollToOption(e,t){if(!e)return
const i=this.dropdown_content,s=i.clientHeight,n=i.scrollTop||0,o=e.offsetHeight,r=e.getBoundingClientRect().top-i.getBoundingClientRect().top+n
r+o>s+n?this.scroll(r-s+o,t):r<n&&this.scroll(r,t)}scroll(e,t){const i=this.dropdown_content
t&&(i.style.scrollBehavior=t),i.scrollTop=e,i.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(R(this.activeOption,"active"),Q(this.activeOption,{"aria-selected":null})),this.activeOption=null,Q(this.focus_node,{"aria-activedescendant":null})}selectAll(){const e=this
if("single"===e.settings.mode)return
const t=e.controlChildren()
t.length&&(e.inputState(),e.close(),e.activeItems=t,E(t,(t=>{e.setActiveItemClass(t)})))}inputState(){var e=this
e.control.contains(e.control_input)&&(Q(e.control_input,{placeholder:e.settings.placeholder}),e.activeItems.length>0||!e.isFocused&&e.settings.hidePlaceholder&&e.items.length>0?(e.setTextboxValue(),e.isInputHidden=!0):(e.settings.hidePlaceholder&&e.items.length>0&&Q(e.control_input,{placeholder:""}),e.isInputHidden=!1),e.wrapper.classList.toggle("input-hidden",e.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var e=this
e.isDisabled||e.isReadOnly||(e.ignoreFocus=!0,e.control_input.offsetWidth?e.control_input.focus():e.focus_node.focus(),setTimeout((()=>{e.ignoreFocus=!1,e.onFocus()}),0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,t=e.sortField
return"string"==typeof e.sortField&&(t=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,i,s=this,n=this.getSearchOptions()
if(s.settings.score&&"function"!=typeof(i=s.settings.score.call(s,e)))throw new Error('Tom Select "score" setting must be a function that returns a function')
return e!==s.lastQuery?(s.lastQuery=e,t=s.sifter.search(e,Object.assign(n,{score:i})),s.currentResults=t):t=Object.assign({},s.currentResults),s.settings.hideSelected&&(t.items=t.items.filter((e=>{let t=X(e.id)
return!(t&&-1!==s.items.indexOf(t))}))),t}refreshOptions(e=!0){var t,i,s,n,o,r,l,a,c,d
const u={},p=[]
var h=this,g=h.inputValue()
const f=g===h.lastQuery||""==g&&null==h.lastQuery
var v=h.search(g),m=null,y=h.settings.shouldOpen||!1,O=h.dropdown_content
f&&(m=h.activeOption)&&(c=m.closest("[data-group]")),n=v.items.length,"number"==typeof h.settings.maxOptions&&(n=Math.min(n,h.settings.maxOptions)),n>0&&(y=!0)
const b=(e,t)=>{let i=u[e]
if(void 0!==i){let e=p[i]
if(void 0!==e)return[i,e.fragment]}let s=document.createDocumentFragment()
return i=p.length,p.push({fragment:s,order:t,optgroup:e}),[i,s]}
for(t=0;t<n;t++){let e=v.items[t]
if(!e)continue
let n=e.id,l=h.options[n]
if(void 0===l)continue
let a=Y(n),d=h.getOption(a,!0)
for(h.settings.hideSelected||d.classList.toggle("selected",h.items.includes(a)),o=l[h.settings.optgroupField]||"",i=0,s=(r=Array.isArray(o)?o:[o])&&r.length;i<s;i++){o=r[i]
let e=l.$order,t=h.optgroups[o]
void 0===t?o="":e=t.$order
const[s,a]=b(o,e)
i>0&&(d=d.cloneNode(!0),Q(d,{id:l.$id+"-clone-"+i,"aria-selected":null}),d.classList.add("ts-cloned"),R(d,"active"),h.activeOption&&h.activeOption.dataset.value==n&&c&&c.dataset.group===o.toString()&&(m=d)),a.appendChild(d),""!=o&&(u[o]=s)}}var w
h.settings.lockOptgroupOrder&&p.sort(((e,t)=>e.order-t.order)),l=document.createDocumentFragment(),E(p,(e=>{let t=e.fragment,i=e.optgroup
if(!t||!t.children.length)return
let s=h.optgroups[i]
if(void 0!==s){let e=document.createDocumentFragment(),i=h.render("optgroup_header",s)
le(e,i),le(e,t)
let n=h.render("optgroup",{group:s,options:e})
le(l,n)}else le(l,t)})),O.innerHTML="",le(O,l),h.settings.highlight&&(w=O.querySelectorAll("span.highlight"),Array.prototype.forEach.call(w,(function(e){var t=e.parentNode
t.replaceChild(e.firstChild,e),t.normalize()})),v.query.length&&v.tokens.length&&E(v.tokens,(e=>{U(O,e.regex)})))
var _=e=>{let t=h.render(e,{input:g})
return t&&(y=!0,O.insertBefore(t,O.firstChild)),t}
if(h.loading?_("loading"):h.settings.shouldLoad.call(h,g)?0===v.items.length&&_("no_results"):_("not_loading"),(a=h.canCreate(g))&&(d=_("option_create")),h.hasOptions=v.items.length>0||a,y){if(v.items.length>0){if(m||"single"!==h.settings.mode||null==h.items[0]||(m=h.getOption(h.items[0])),!O.contains(m)){let e=0
d&&!h.settings.addPrecedence&&(e=1),m=h.selectable()[e]}}else d&&(m=d)
e&&!h.isOpen&&(h.open(),h.scrollToOption(m,"auto")),h.setActiveOption(m)}else h.clearActiveOption(),e&&h.isOpen&&h.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,t=!1){const i=this
if(Array.isArray(e))return i.addOptions(e,t),!1
const s=X(e[i.settings.valueField])
return null!==s&&!i.options.hasOwnProperty(s)&&(e.$order=e.$order||++i.order,e.$id=i.inputId+"-opt-"+e.$order,i.options[s]=e,i.lastQuery=null,t&&(i.userOptions[s]=t,i.trigger("option_add",s,e)),s)}addOptions(e,t=!1){E(e,(e=>{this.addOption(e,t)}))}registerOption(e){return this.addOption(e)}registerOptionGroup(e){var t=X(e[this.settings.optgroupValueField])
return null!==t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}addOptionGroup(e,t){var i
t[this.settings.optgroupValueField]=e,(i=this.registerOptionGroup(t))&&this.trigger("optgroup_add",i,t)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,t){const i=this
var s,n
const o=X(e),r=X(t[i.settings.valueField])
if(null===o)return
const l=i.options[o]
if(null==l)return
if("string"!=typeof r)throw new Error("Value must be set in option data")
const a=i.getOption(o),c=i.getItem(o)
if(t.$order=t.$order||l.$order,delete i.options[o],i.uncacheValue(r),i.options[r]=t,a){if(i.dropdown_content.contains(a)){const e=i._render("option",t)
G(a,e),i.activeOption===a&&i.setActiveOption(e)}a.remove()}c&&(-1!==(n=i.items.indexOf(o))&&i.items.splice(n,1,r),s=i._render("item",t),c.classList.contains("active")&&D(s,"active"),G(c,s)),i.lastQuery=null}removeOption(e,t){const i=this
e=Y(e),i.uncacheValue(e),delete i.userOptions[e],delete i.options[e],i.lastQuery=null,i.trigger("option_remove",e),i.removeItem(e,t)}clearOptions(e){const t=(e||this.clearFilter).bind(this)
this.loadedSearches={},this.userOptions={},this.clearCache()
const i={}
E(this.options,((e,s)=>{t(e,s)&&(i[s]=e)})),this.options=this.sifter.items=i,this.lastQuery=null,this.trigger("option_clear")}clearFilter(e,t){return this.items.indexOf(t)>=0}getOption(e,t=!1){const i=X(e)
if(null===i)return null
const s=this.options[i]
if(null!=s){if(s.$div)return s.$div
if(t)return this._render("option",s)}return null}getAdjacent(e,t,i="option"){var s
if(!e)return null
s="item"==i?this.controlChildren():this.dropdown_content.querySelectorAll("[data-selectable]")
for(let i=0;i<s.length;i++)if(s[i]==e)return t>0?s[i+1]:s[i-1]
return null}getItem(e){if("object"==typeof e)return e
var t=X(e)
return null!==t?this.control.querySelector(`[data-value="${re(t)}"]`):null}addItems(e,t){var i=this,s=Array.isArray(e)?e:[e]
const n=(s=s.filter((e=>-1===i.items.indexOf(e))))[s.length-1]
s.forEach((e=>{i.isPending=e!==n,i.addItem(e,t)}))}addItem(e,t){te(this,t?[]:["change","dropdown_close"],(()=>{var i,s
const n=this,o=n.settings.mode,r=X(e)
if((!r||-1===n.items.indexOf(r)||("single"===o&&n.close(),"single"!==o&&n.settings.duplicates))&&null!==r&&n.options.hasOwnProperty(r)&&("single"===o&&n.clear(t),"multi"!==o||!n.isFull())){if(i=n._render("item",n.options[r]),n.control.contains(i)&&(i=i.cloneNode(!0)),s=n.isFull(),n.items.splice(n.caretPos,0,r),n.insertAtCaret(i),n.isSetup){if(!n.isPending&&n.settings.hideSelected){let e=n.getOption(r),t=n.getAdjacent(e,1)
t&&n.setActiveOption(t)}n.isPending||n.settings.closeAfterSelect||n.refreshOptions(n.isFocused&&"single"!==o),0!=n.settings.closeAfterSelect&&n.isFull()?n.close():n.isPending||n.positionDropdown(),n.trigger("item_add",r,i),n.isPending||n.updateOriginalInput({silent:t})}(!n.isPending||!s&&n.isFull())&&(n.inputState(),n.refreshState())}}))}removeItem(e=null,t){const i=this
if(!(e=i.getItem(e)))return
var s,n
const o=e.dataset.value
s=K(e),e.remove(),e.classList.contains("active")&&(n=i.activeItems.indexOf(e),i.activeItems.splice(n,1),R(e,"active")),i.items.splice(s,1),i.lastQuery=null,!i.settings.persist&&i.userOptions.hasOwnProperty(o)&&i.removeOption(o,t),s<i.caretPos&&i.setCaret(i.caretPos-1),i.updateOriginalInput({silent:t}),i.refreshState(),i.positionDropdown(),i.trigger("item_remove",o,e)}createItem(e=null,t=(()=>{})){3===arguments.length&&(t=arguments[2]),"function"!=typeof t&&(t=()=>{})
var i,s=this,n=s.caretPos
if(e=e||s.inputValue(),!s.canCreate(e))return t(),!1
s.lock()
var o=!1,r=e=>{if(s.unlock(),!e||"object"!=typeof e)return t()
var i=X(e[s.settings.valueField])
if("string"!=typeof i)return t()
s.setTextboxValue(),s.addOption(e,!0),s.setCaret(n),s.addItem(i),t(e),o=!0}
return i="function"==typeof s.settings.create?s.settings.create.call(this,e,r):{[s.settings.labelField]:e,[s.settings.valueField]:e},o||r(i),!0}refreshItems(){var e=this
e.lastQuery=null,e.isSetup&&e.addItems(e.items),e.updateOriginalInput(),e.refreshState()}refreshState(){const e=this
e.refreshValidityState()
const t=e.isFull(),i=e.isLocked
e.wrapper.classList.toggle("rtl",e.rtl)
const s=e.wrapper.classList
var n
s.toggle("focus",e.isFocused),s.toggle("disabled",e.isDisabled),s.toggle("readonly",e.isReadOnly),s.toggle("required",e.isRequired),s.toggle("invalid",!e.isValid),s.toggle("locked",i),s.toggle("full",t),s.toggle("input-active",e.isFocused&&!e.isInputHidden),s.toggle("dropdown-active",e.isOpen),s.toggle("has-options",(n=e.options,0===Object.keys(n).length)),s.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this
e.input.validity&&(e.isValid=e.input.validity.valid,e.isInvalid=!e.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const t=this
var i,s
const n=t.input.querySelector('option[value=""]')
if(t.is_select_tag){const o=[],r=t.input.querySelectorAll("option:checked").length
function l(e,i,s){return e||(e=j('<option value="'+Z(i)+'">'+Z(s)+"</option>")),e!=n&&t.input.append(e),o.push(e),(e!=n||r>0)&&(e.selected=!0),e}t.input.querySelectorAll("option:checked").forEach((e=>{e.selected=!1})),0==t.items.length&&"single"==t.settings.mode?l(n,"",""):t.items.forEach((e=>{if(i=t.options[e],s=i[t.settings.labelField]||"",o.includes(i.$option)){l(t.input.querySelector(`option[value="${re(e)}"]:not(:checked)`),e,s)}else i.$option=l(i.$option,e,s)}))}else t.input.value=t.getValue()
t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){var e=this
e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.isOpen=!0,Q(e.focus_node,{"aria-expanded":"true"}),e.refreshState(),q(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),q(e.dropdown,{visibility:"visible",display:"block"}),e.focus(),e.trigger("dropdown_open",e.dropdown))}close(e=!0){var t=this,i=t.isOpen
e&&(t.setTextboxValue(),"single"===t.settings.mode&&t.items.length&&t.inputState()),t.isOpen=!1,Q(t.focus_node,{"aria-expanded":"false"}),q(t.dropdown,{display:"none"}),t.settings.hideSelected&&t.clearActiveOption(),t.refreshState(),i&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var e=this.control,t=e.getBoundingClientRect(),i=e.offsetHeight+t.top+window.scrollY,s=t.left+window.scrollX
q(this.dropdown,{width:t.width+"px",top:i+"px",left:s+"px"})}}clear(e){var t=this
if(t.items.length){var i=t.controlChildren()
E(i,(e=>{t.removeItem(e,!0)})),t.inputState(),e||t.updateOriginalInput(),t.trigger("clear")}}insertAtCaret(e){const t=this,i=t.caretPos,s=t.control
s.insertBefore(e,s.children[i]||null),t.setCaret(i+1)}deleteSelection(e){var t,i,s,n,o,r=this
t=e&&8===e.keyCode?-1:1,i={start:(o=r.control_input).selectionStart||0,length:(o.selectionEnd||0)-(o.selectionStart||0)}
const l=[]
if(r.activeItems.length)n=B(r.activeItems,t),s=K(n),t>0&&s++,E(r.activeItems,(e=>l.push(e)))
else if((r.isFocused||"single"===r.settings.mode)&&r.items.length){const e=r.controlChildren()
let s
t<0&&0===i.start&&0===i.length?s=e[r.caretPos-1]:t>0&&i.start===r.inputValue().length&&(s=e[r.caretPos]),void 0!==s&&l.push(s)}if(!r.shouldDelete(l,e))return!1
for(ie(e,!0),void 0!==s&&r.setCaret(s);l.length;)r.removeItem(l.pop())
return r.inputState(),r.positionDropdown(),r.refreshOptions(!1),!0}shouldDelete(e,t){const i=e.map((e=>e.dataset.value))
return!(!i.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete(i,t))}advanceSelection(e,t){var i,s,n=this
n.rtl&&(e*=-1),n.inputValue().length||(ne(J,t)||ne("shiftKey",t)?(s=(i=n.getLastActive(e))?i.classList.contains("active")?n.getAdjacent(i,e,"item"):i:e>0?n.control_input.nextElementSibling:n.control_input.previousElementSibling)&&(s.classList.contains("active")&&n.removeActiveItem(i),n.setActiveItemClass(s)):n.moveCaret(e))}moveCaret(e){}getLastActive(e){let t=this.control.querySelector(".last-active")
if(t)return t
var i=this.control.querySelectorAll(".active")
return i?B(i,e):void 0}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(e=this.isReadOnly||this.isDisabled){this.isLocked=e,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(e){this.focus_node.tabIndex=e?-1:this.tabIndex,this.isDisabled=e,this.input.disabled=e,this.control_input.disabled=e,this.setLocked()}setReadOnly(e){this.isReadOnly=e,this.input.readOnly=e,this.control_input.readOnly=e,this.setLocked()}destroy(){var e=this,t=e.revertSettings
e.trigger("destroy"),e.off(),e.wrapper.remove(),e.dropdown.remove(),e.input.innerHTML=t.innerHTML,e.input.tabIndex=t.tabIndex,R(e.input,"tomselected","ts-hidden-accessible"),e._destroy(),delete e.input.tomselect}render(e,t){var i,s
const n=this
if("function"!=typeof this.settings.render[e])return null
if(!(s=n.settings.render[e].call(this,t,Z)))return null
if(s=j(s),"option"===e||"option_create"===e?t[n.settings.disabledField]?Q(s,{"aria-disabled":"true"}):Q(s,{"data-selectable":""}):"optgroup"===e&&(i=t.group[n.settings.optgroupValueField],Q(s,{"data-group":i}),t.group[n.settings.disabledField]&&Q(s,{"data-disabled":""})),"option"===e||"item"===e){const i=Y(t[n.settings.valueField])
Q(s,{"data-value":i}),"item"===e?(D(s,n.settings.itemClass),Q(s,{"data-ts-item":""})):(D(s,n.settings.optionClass),Q(s,{role:"option",id:t.$id}),t.$div=s,n.options[i]=t)}return s}_render(e,t){const i=this.render(e,t)
if(null==i)throw"HTMLElement expected"
return i}clearCache(){E(this.options,(e=>{e.$div&&(e.$div.remove(),delete e.$div)}))}uncacheValue(e){const t=this.getOption(e)
t&&t.remove()}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,i){var s=this,n=s[t]
s[t]=function(){var t,o
return"after"===e&&(t=n.apply(s,arguments)),o=i.apply(s,arguments),"instead"===e?o:("before"===e&&(t=n.apply(s,arguments)),t)}}}return de.define("change_listener",(function(){se(this.input,"change",(()=>{this.sync()}))})),de.define("checkbox_options",(function(e){var t=this,i=t.onOptionSelect
t.settings.hideSelected=!1
const s=Object.assign({className:"tomselect-checkbox",checkedClassNames:void 0,uncheckedClassNames:void 0},e)
var n=function(e,t){t?(e.checked=!0,s.uncheckedClassNames&&e.classList.remove(...s.uncheckedClassNames),s.checkedClassNames&&e.classList.add(...s.checkedClassNames)):(e.checked=!1,s.checkedClassNames&&e.classList.remove(...s.checkedClassNames),s.uncheckedClassNames&&e.classList.add(...s.uncheckedClassNames))},o=function(e){setTimeout((()=>{var t=e.querySelector("input."+s.className)
t instanceof HTMLInputElement&&n(t,e.classList.contains("selected"))}),1)}
t.hook("after","setupTemplates",(()=>{var e=t.settings.render.option
t.settings.render.option=(i,o)=>{var r=j(e.call(t,i,o)),l=document.createElement("input")
s.className&&l.classList.add(s.className),l.addEventListener("click",(function(e){ie(e)})),l.type="checkbox"
const a=X(i[t.settings.valueField])
return n(l,!!(a&&t.items.indexOf(a)>-1)),r.prepend(l),r}})),t.on("item_remove",(e=>{var i=t.getOption(e)
i&&(i.classList.remove("selected"),o(i))})),t.on("item_add",(e=>{var i=t.getOption(e)
i&&o(i)})),t.hook("instead","onOptionSelect",((e,s)=>{if(s.classList.contains("selected"))return s.classList.remove("selected"),t.removeItem(s.dataset.value),t.refreshOptions(),void ie(e,!0)
i.call(t,e,s),o(s)}))})),de.define("clear_button",(function(e){const t=this,i=Object.assign({className:"clear-button",title:"Clear All",html:e=>`<div class="${e.className}" title="${e.title}">&#10799;</div>`},e)
t.on("initialize",(()=>{var e=j(i.html(i))
e.addEventListener("click",(e=>{t.isLocked||(t.clear(),"single"===t.settings.mode&&t.settings.allowEmptyOption&&t.addItem(""),e.preventDefault(),e.stopPropagation())})),t.control.appendChild(e)}))})),de.define("drag_drop",(function(){var e=this
if("multi"!==e.settings.mode)return
var t=e.lock,i=e.unlock
let s,n=!0
e.hook("after","setupTemplates",(()=>{var t=e.settings.render.item
e.settings.render.item=(i,o)=>{const r=j(t.call(e,i,o))
Q(r,{draggable:"true"})
const l=e=>{e.preventDefault(),r.classList.add("ts-drag-over"),a(r,s)},a=(e,t)=>{var i,s,n
void 0!==t&&(((e,t)=>{do{var i
if(e==(t=null==(i=t)?void 0:i.previousElementSibling))return!0}while(t&&t.previousElementSibling)
return!1})(t,r)?(s=t,null==(n=(i=e).parentNode)||n.insertBefore(s,i.nextSibling)):((e,t)=>{var i
null==(i=e.parentNode)||i.insertBefore(t,e)})(e,t))}
return se(r,"mousedown",(e=>{n||ie(e),e.stopPropagation()})),se(r,"dragstart",(e=>{s=r,setTimeout((()=>{r.classList.add("ts-dragging")}),0)})),se(r,"dragenter",l),se(r,"dragover",l),se(r,"dragleave",(()=>{r.classList.remove("ts-drag-over")})),se(r,"dragend",(()=>{var t
document.querySelectorAll(".ts-drag-over").forEach((e=>e.classList.remove("ts-drag-over"))),null==(t=s)||t.classList.remove("ts-dragging"),s=void 0
var i=[]
e.control.querySelectorAll("[data-value]").forEach((e=>{if(e.dataset.value){let t=e.dataset.value
t&&i.push(t)}})),e.setValue(i)})),r}})),e.hook("instead","lock",(()=>(n=!1,t.call(e)))),e.hook("instead","unlock",(()=>(n=!0,i.call(e))))})),de.define("dropdown_header",(function(e){const t=this,i=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:e=>'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a class="'+e.closeClass+'">&times;</a></div></div>'},e)
t.on("initialize",(()=>{var e=j(i.html(i)),s=e.querySelector("."+i.closeClass)
s&&s.addEventListener("click",(e=>{ie(e,!0),t.close()})),t.dropdown.insertBefore(e,t.dropdown.firstChild)}))})),de.define("caret_position",(function(){var e=this
e.hook("instead","setCaret",(t=>{"single"!==e.settings.mode&&e.control.contains(e.control_input)?(t=Math.max(0,Math.min(e.items.length,t)))==e.caretPos||e.isPending||e.controlChildren().forEach(((i,s)=>{s<t?e.control_input.insertAdjacentElement("beforebegin",i):e.control.appendChild(i)})):t=e.items.length,e.caretPos=t})),e.hook("instead","moveCaret",(t=>{if(!e.isFocused)return
const i=e.getLastActive(t)
if(i){const s=K(i)
e.setCaret(t>0?s+1:s),e.setActiveItem(),R(i,"last-active")}else e.setCaret(e.caretPos+t)}))})),de.define("dropdown_input",(function(){const e=this
e.settings.shouldOpen=!0,e.hook("before","setup",(()=>{e.focus_node=e.control,D(e.control_input,"dropdown-input")
const t=j('<div class="dropdown-input-wrap">')
t.append(e.control_input),e.dropdown.insertBefore(t,e.dropdown.firstChild)
const i=j('<input class="items-placeholder" tabindex="-1" />')
i.placeholder=e.settings.placeholder||"",e.control.append(i)})),e.on("initialize",(()=>{e.control_input.addEventListener("keydown",(t=>{switch(t.keyCode){case 27:return e.isOpen&&(ie(t,!0),e.close()),void e.clearActiveItems()
case 9:e.focus_node.tabIndex=-1}return e.onKeyDown.call(e,t)})),e.on("blur",(()=>{e.focus_node.tabIndex=e.isDisabled?-1:e.tabIndex})),e.on("dropdown_open",(()=>{e.control_input.focus()}))
const t=e.onBlur
e.hook("instead","onBlur",(i=>{if(!i||i.relatedTarget!=e.control_input)return t.call(e)})),se(e.control_input,"blur",(()=>e.onBlur())),e.hook("before","close",(()=>{e.isOpen&&e.focus_node.focus({preventScroll:!0})}))}))})),de.define("input_autogrow",(function(){var e=this
e.on("initialize",(()=>{var t=document.createElement("span"),i=e.control_input
t.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",e.wrapper.appendChild(t)
for(const e of["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"])t.style[e]=i.style[e]
var s=()=>{t.textContent=i.value,i.style.width=t.clientWidth+"px"}
s(),e.on("update item_add item_remove",s),se(i,"input",s),se(i,"keyup",s),se(i,"blur",s),se(i,"update",s)}))})),de.define("no_backspace_delete",(function(){var e=this,t=e.deleteSelection
this.hook("instead","deleteSelection",(i=>!!e.activeItems.length&&t.call(e,i)))})),de.define("no_active_items",(function(){this.hook("instead","setActiveItem",(()=>{})),this.hook("instead","selectAll",(()=>{}))})),de.define("optgroup_columns",(function(){var e=this,t=e.onKeyDown
e.hook("instead","onKeyDown",(i=>{var s,n,o,r
if(!e.isOpen||37!==i.keyCode&&39!==i.keyCode)return t.call(e,i)
e.ignoreHover=!0,r=z(e.activeOption,"[data-group]"),s=K(e.activeOption,"[data-selectable]"),r&&(r=37===i.keyCode?r.previousSibling:r.nextSibling)&&(n=(o=r.querySelectorAll("[data-selectable]"))[Math.min(o.length-1,s)])&&e.setActiveOption(n)}))})),de.define("remove_button",(function(e){const t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},e)
var i=this
if(t.append){var s='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+Z(t.title)+'">'+t.label+"</a>"
i.hook("after","setupTemplates",(()=>{var e=i.settings.render.item
i.settings.render.item=(t,n)=>{var o=j(e.call(i,t,n)),r=j(s)
return o.appendChild(r),se(r,"mousedown",(e=>{ie(e,!0)})),se(r,"click",(e=>{i.isLocked||(ie(e,!0),i.isLocked||i.shouldDelete([o],e)&&(i.removeItem(o),i.refreshOptions(!1),i.inputState()))})),o}}))}})),de.define("restore_on_backspace",(function(e){const t=this,i=Object.assign({text:e=>e[t.settings.labelField]},e)
t.on("item_remove",(function(e){if(t.isFocused&&""===t.control_input.value.trim()){var s=t.options[e]
s&&t.setTextboxValue(i.text.call(t,s))}}))})),de.define("virtual_scroll",(function(){const e=this,t=e.canLoad,i=e.clearActiveOption,s=e.loadCallback
var n,o,r={},l=!1,a=[]
if(e.settings.shouldLoadMore||(e.settings.shouldLoadMore=()=>{if(n.clientHeight/(n.scrollHeight-n.scrollTop)>.9)return!0
if(e.activeOption){var t=e.selectable()
if(Array.from(t).indexOf(e.activeOption)>=t.length-2)return!0}return!1}),!e.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method"
e.settings.sortField=[{field:"$order"},{field:"$score"}]
const c=t=>!("number"==typeof e.settings.maxOptions&&n.children.length>=e.settings.maxOptions)&&!(!(t in r)||!r[t]),d=(t,i)=>e.items.indexOf(i)>=0||a.indexOf(i)>=0
e.setNextUrl=(e,t)=>{r[e]=t},e.getUrl=t=>{if(t in r){const e=r[t]
return r[t]=!1,e}return e.clearPagination(),e.settings.firstUrl.call(e,t)},e.clearPagination=()=>{r={}},e.hook("instead","clearActiveOption",(()=>{if(!l)return i.call(e)})),e.hook("instead","canLoad",(i=>i in r?c(i):t.call(e,i))),e.hook("instead","loadCallback",((t,i)=>{if(l){if(o){const i=t[0]
void 0!==i&&(o.dataset.value=i[e.settings.valueField])}}else e.clearOptions(d)
s.call(e,t,i),l=!1})),e.hook("after","refreshOptions",(()=>{const t=e.lastValue
var i
c(t)?(i=e.render("loading_more",{query:t}))&&(i.setAttribute("data-selectable",""),o=i):t in r&&!n.querySelector(".no-results")&&(i=e.render("no_more_results",{query:t})),i&&(D(i,e.settings.optionClass),n.append(i))})),e.on("initialize",(()=>{a=Object.keys(e.options),n=e.dropdown_content,e.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},e.settings.render),n.addEventListener("scroll",(()=>{e.settings.shouldLoadMore.call(e)&&c(e.lastValue)&&(l||(l=!0,e.load.call(e,e.lastValue)))}))}))})),de}))
var tomSelect=function(e,t){return new TomSelect(e,t)}
//# sourceMappingURL=tom-select.complete.min.js.map

class UiRichSelect {constructor() {this.init();}
init() {$('SELECT.uiRichSelect').each((index, element) => {if ( !$(element).hasClass('tomselected') && !$(element).data('exclude-tomselect') ) {this.initializeSelect($(element));this.observeDisabledState(element);}});$('SELECT:not(.uiRichSelect):not(.swal2-select):not(.chosen-select):not(.uiMultipleSelect):not(.modal-select)').each((index, element) => {if (!$(element).hasClass('tomselected') && !$(element).attr('class')?.includes('flatpickr') && !$(element).data('exclude-tomselect')) {$(element).data('option-disable-search', true);$(element).addClass('uiRichSelect');this.initializeSelect($(element));this.observeDisabledState(element);}});}
initializeSelect( $this ) {let direction = ($('html').attr('dir') == 'rtl') ? 'rtl' : 'ltr';const forceDirection = $this.data('option-force-direction') || false;const themeType = $this.data('option-theme') || false;const disableSearch = $this.data('option-disable-search') || false;const ajaxUrl = $this.data('option-ajax-url') || false;const placeholder = $this.data('placeholder') || false;const dropdownDirection = $this.data('dropdown-direction') || 'auto';if ( forceDirection ) {this.handleDirection($this, forceDirection);direction = forceDirection;}
const { hasExplain, hasImage, updatedThemeType } = this.processOptions($this, themeType);let loadedInitialData = false;const instance = this.createTomSelectInstance($this, {direction,themeType: updatedThemeType,hasExplain,disableSearch,ajaxUrl,placeholder,loadedInitialData,dropdownDirection});this.setupDirectionClasses(instance, direction);$this.data('tomselect',instance);}
handleDirection($this, forceDirection) {$this.wrap(`<div dir="${forceDirection}"></div>`);}
processOptions($this, themeType) {const lastOption = $this.find('option:last');const hasExplain = lastOption.data('explain') ? true : false;const hasImage = $this.find('option[data-src]').length > 0;return {hasExplain,hasImage,updatedThemeType: hasImage ? 'align_image' : themeType};}
getDropdownPosition( dropdown, control, dropdownDirection ) {let upPositionOBJ = {top: "auto",bottom: "100%"}
let downPositionOBJ = {top: "100%",bottom: "auto"}
if ( dropdownDirection === 'up' ) {return upPositionOBJ;}
if ( dropdownDirection === 'down' ) {return downPositionOBJ;}
const controlRect = control.getBoundingClientRect();const dropdownHeight = dropdown.offsetHeight;const buffer = 10;const spaceBelow = window.innerHeight - controlRect.bottom;const spaceAbove = controlRect.top;if ( spaceBelow < (dropdownHeight + buffer) && spaceAbove > spaceBelow ) {return upPositionOBJ;}
return downPositionOBJ;}
createTomSelectInstance($this, config) {const { direction, themeType, hasExplain, disableSearch, ajaxUrl, placeholder, dropdownDirection } = config;const self = this;if (!themeType || themeType === 'align_image' || themeType === 'schedule_module') {return new TomSelect($this[0], {plugins: disableSearch ? [] : ['dropdown_input'],persist: false,create: false,maxItems: 1,maxOptions: null,controlInput: false,allowEmptyOption: true,render: this.renderTheme(themeType, hasExplain),dir: direction,onDropdownOpen: function( dropdown ) {const position = self.getDropdownPosition(dropdown, this.control, dropdownDirection);dropdown.style.top = position.top;dropdown.style.bottom = position.bottom;}});}
if (themeType === 'customers') {return new TomSelect($this[0], {plugins: ['remove_button'],create: true,maxItems: 1,render: this.renderTheme(themeType, ''),dir: direction,valueField: 'email',labelField: 'name',searchField: 'name',placeholder: (placeholder ? placeholder : 'Search...'),loadThrottle: 300,onInitialize: function() {$(this.wrapper).attr('data-id',$this.attr('id'));const value = $this.data('selected-customer');if (value) {const url = ajaxUrl + '?q=' + encodeURIComponent(value) + '&w=' + encodeURIComponent($this.data('website-id'));fetch(url)
.then(response => response.json())
.then(json => {if (json && json.length) {this.addOption(json[0]);this.setValue(json[0].email);}});}},onFocus: function() {if (!config.loadedInitialData) {this.load('');config.loadedInitialData = true;}},load: function(query, callback) {const url = ajaxUrl + '?q=' + encodeURIComponent(query) + '&w=' + encodeURIComponent($this.data('website-id'));fetch(url)
.then(response => response.json())
.then(json => callback(json))
.catch(() => callback());},onDropdownOpen: function( dropdown ) {const position = self.getDropdownPosition(dropdown, this.control, dropdownDirection);dropdown.style.top = position.top;dropdown.style.bottom = position.bottom;}});}}
setupDirectionClasses(instance, direction) {if (direction == 'rtl') {instance.control.classList.add('rtl');instance.dropdown.classList.add('rtl');} else {instance.control.classList.add('ltr');instance.dropdown.classList.add('ltr');}}
renderTheme(themeType, hasExplain) {if (themeType == 'align_image') {return {option: (data, escape) => {const w = data.srcW || 24;const h = data.srcH || 24;if (data.src) {return `<div class="optionImage"><img src="${data.src}" width="${w}" height="${h}">${data.text}</div>`;}
if ($('select.uiRichSelect').find('option[data-src]').length > 0) {return `<div class="optionImage"><div style="width:${w}px;height:${h}px;display:inline-block;"></div>${data.text}</div>`;}
return `<div class="optionImage">${data.text}</div>`;},item: (item, escape) => {const w = item.srcW || 24;const h = item.srcH || 24;if (item.src) {return `<div class="optionImage"><img src="${item.src}" width="${w}" height="${h}">${item.text}</div>`;}
if ($('select.uiRichSelect').find('option[data-src]').length > 0) {return `<div class="optionImage"><div style="width:${w}px;height:${h}px;display:inline-block;"></div>${item.text}</div>`;}
return `<div class="optionImage">${item.text}</div>`;}};}
if (themeType == 'customers') {return {option: (item, escape) => `
<div style="display:flex;gap:10px;">
<div>
<div style="${(item.img && item.img.length > 0) ? 'display: none !important; ' : ''}width:40px;height:40px;border-radius:50%;background-color:var(--primary_color_dark);color:#fff;display: flex;align-items: center;justify-content: center;">${escape(item.name.trim().length > 0 ? item.name.charAt(0) : item.email.charAt(0))}</div>
<img style="${(item.img && item.img.length > 0) ? '' : 'display: none; '} width: 40px;height: 40px;object-fit: cover;object-position: center center;border-radius: 50% !important;" src="${item.img}" data-src="/versions/2/wizard/clientZone/images/noImage.png">
</div>
<div>
<span class="optionTitle">${escape(item.name)}</span>
<br>
<span class="optionExplain">${escape(item.email)}</span>
</div>
<input type="hidden" class="allSettings" value="${escape(JSON.stringify(item.allSettings))}">
</div>`,item: (item, escape) => `
<div class="selectedItem">
${escape(item.name.trim().length > 0 ? item.name : item.email)}
<input type="hidden" class="allSettings" value="${escape(JSON.stringify(item.allSettings))}">
</div>`};}
if (themeType == 'schedule_module') {return {option: (data, escape) => {if (data.img && data.img.length > 0) {return `
<div style="display:flex;gap:10px;">
<div>
<div class="optionImage"><img src="${data.img}" style="width: 40px;height: 40px;object-fit: cover;object-position: center center;border-radius: 50% !important;"></div>
</div>
<div>
<span class="optionTitle">${escape(data.text)}</span>
<br>
<span class="optionExplain">${escape(data.email)}</span>
</div>
</div>`;} else {return `
<div style="display:flex;gap:10px;">
<div>
<div style="width:40px;height:40px;border-radius:50%;background-color:var(--primary_color_dark);color:#fff;display: flex;align-items: center;justify-content: center;">${data.text.charAt(0)}</div>
</div>
<div>
<span class="optionTitle">${escape(data.text)}</span>
<br>
<span class="optionExplain">${escape(data.email)}</span>
</div>
</div>`;}},item: (item, escape) => {if (item.img && item.img.length > 0) {return `
<div style="display:flex;gap:10px;">
<div style="display: flex">
<div class="optionImage"><img src="${item.img}" style="width: 30px;height: 30px;object-fit: cover;object-position: center center;border-radius: 50% !important;"></div>
</div>
<div style="display: flex;align-items: center;">
<span class="optionTitle">${escape(item.text)}</span>&nbsp;<span style="font-size: 90%;" class="optionExplain">(${escape(item.email)})</span>
</div>
</div>`;} else {return `
<div style="display:flex;gap:10px;">
<div style="display: flex;justify-content: center;flex-direction: column;">
<div style="width:30px;height:30px;border-radius:50%;background-color:var(--primary_color_dark);color:#fff;display: flex;align-items: center;justify-content: center;">${item.text.charAt(0)}</div>
</div>
<div style="display: flex;align-items: center;">
<span class="optionTitle">${escape(item.text)}</span>&nbsp;${item.email ? `<span style="font-size: 90%;" class="optionExplain">(${escape(item.email)})</span>` : ''}
</div>
</div>`;}}};}
if (hasExplain) {return {option: (item, escape) => `<div class="optionExplainItem"><div class="optionTitle">${item.text}</div><div class="optionExplain">${item.explain}</div></div>`};}
return null;}
observeDisabledState(selectElement) {if (!$(selectElement).is('SELECT') || !$(selectElement).hasClass('uiRichSelect')) return;const instance = selectElement.tomselect;let isHandlingChange = false;const observer = new MutationObserver((mutations) => {mutations.forEach((mutation) => {if (mutation.type === 'attributes' &&mutation.attributeName === 'disabled' &&mutation.target.tagName === 'SELECT' &&!isHandlingChange) { // Only proceed if we're not already handling a change
const isDisabled = selectElement.disabled;isHandlingChange = true;if (isDisabled) {instance.disable();} else {instance.enable();}
setTimeout(() => {isHandlingChange = false;}, 0);}});});observer.observe(selectElement, {attributes: true,attributeFilter: ['disabled']});}}
$(document).ready(() => new UiRichSelect());
/* flatpickr v4.6.13,, @license MIT */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).flatpickr=n()}(this,(function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function n(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var a=Array(e),i=0;for(n=0;n<t;n++)for(var o=arguments[n],r=0,l=o.length;r<l;r++,i++)a[i]=o[r];return a}var t=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],a={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(e){return"undefined"!=typeof console&&console.warn(e)},getWeek:function(e){var n=new Date(e.getTime());n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7);var t=new Date(n.getFullYear(),0,4);return 1+Math.round(((n.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},i={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var n=e%100;if(n>3&&n<21)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},o=function(e,n){return void 0===n&&(n=2),("000"+e).slice(-1*n)},r=function(e){return!0===e?1:0};function l(e,n){var t;return function(){var a=this,i=arguments;clearTimeout(t),t=setTimeout((function(){return e.apply(a,i)}),n)}}var c=function(e){return e instanceof Array?e:[e]};function s(e,n,t){if(!0===t)return e.classList.add(n);e.classList.remove(n)}function d(e,n,t){var a=window.document.createElement(e);return n=n||"",t=t||"",a.className=n,void 0!==t&&(a.textContent=t),a}function u(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function f(e,n){return n(e)?e:e.parentNode?f(e.parentNode,n):void 0}function m(e,n){var t=d("div","numInputWrapper"),a=d("input","numInput "+e),i=d("span","arrowUp"),o=d("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?a.type="number":(a.type="text",a.pattern="\\d*"),void 0!==n)for(var r in n)a.setAttribute(r,n[r]);return t.appendChild(a),t.appendChild(i),t.appendChild(o),t}function g(e){try{return"function"==typeof e.composedPath?e.composedPath()[0]:e.target}catch(n){return e.target}}var p=function(){},h=function(e,n,t){return t.months[n?"shorthand":"longhand"][e]},v={D:p,F:function(e,n,t){e.setMonth(t.months.longhand.indexOf(n))},G:function(e,n){e.setHours((e.getHours()>=12?12:0)+parseFloat(n))},H:function(e,n){e.setHours(parseFloat(n))},J:function(e,n){e.setDate(parseFloat(n))},K:function(e,n,t){e.setHours(e.getHours()%12+12*r(new RegExp(t.amPM[1],"i").test(n)))},M:function(e,n,t){e.setMonth(t.months.shorthand.indexOf(n))},S:function(e,n){e.setSeconds(parseFloat(n))},U:function(e,n){return new Date(1e3*parseFloat(n))},W:function(e,n,t){var a=parseInt(n),i=new Date(e.getFullYear(),0,2+7*(a-1),0,0,0,0);return i.setDate(i.getDate()-i.getDay()+t.firstDayOfWeek),i},Y:function(e,n){e.setFullYear(parseFloat(n))},Z:function(e,n){return new Date(n)},d:function(e,n){e.setDate(parseFloat(n))},h:function(e,n){e.setHours((e.getHours()>=12?12:0)+parseFloat(n))},i:function(e,n){e.setMinutes(parseFloat(n))},j:function(e,n){e.setDate(parseFloat(n))},l:p,m:function(e,n){e.setMonth(parseFloat(n)-1)},n:function(e,n){e.setMonth(parseFloat(n)-1)},s:function(e,n){e.setSeconds(parseFloat(n))},u:function(e,n){return new Date(parseFloat(n))},w:p,y:function(e,n){e.setFullYear(2e3+parseFloat(n))}},D={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},w={Z:function(e){return e.toISOString()},D:function(e,n,t){return n.weekdays.shorthand[w.w(e,n,t)]},F:function(e,n,t){return h(w.n(e,n,t)-1,!1,n)},G:function(e,n,t){return o(w.h(e,n,t))},H:function(e){return o(e.getHours())},J:function(e,n){return void 0!==n.ordinal?e.getDate()+n.ordinal(e.getDate()):e.getDate()},K:function(e,n){return n.amPM[r(e.getHours()>11)]},M:function(e,n){return h(e.getMonth(),!0,n)},S:function(e){return o(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,n,t){return t.getWeek(e)},Y:function(e){return o(e.getFullYear(),4)},d:function(e){return o(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return o(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,n){return n.weekdays.longhand[e.getDay()]},m:function(e){return o(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}},b=function(e){var n=e.config,t=void 0===n?a:n,o=e.l10n,r=void 0===o?i:o,l=e.isMobile,c=void 0!==l&&l;return function(e,n,a){var i=a||r;return void 0===t.formatDate||c?n.split("").map((function(n,a,o){return w[n]&&"\\"!==o[a-1]?w[n](e,i,t):"\\"!==n?n:""})).join(""):t.formatDate(e,n,i)}},C=function(e){var n=e.config,t=void 0===n?a:n,o=e.l10n,r=void 0===o?i:o;return function(e,n,i,o){if(0===e||e){var l,c=o||r,s=e;if(e instanceof Date)l=new Date(e.getTime());else if("string"!=typeof e&&void 0!==e.toFixed)l=new Date(e);else if("string"==typeof e){var d=n||(t||a).dateFormat,u=String(e).trim();if("today"===u)l=new Date,i=!0;else if(t&&t.parseDate)l=t.parseDate(e,d);else if(/Z$/.test(u)||/GMT$/.test(u))l=new Date(e);else{for(var f=void 0,m=[],g=0,p=0,h="";g<d.length;g++){var w=d[g],b="\\"===w,C="\\"===d[g-1]||b;if(D[w]&&!C){h+=D[w];var M=new RegExp(h).exec(e);M&&(f=!0)&&m["Y"!==w?"push":"unshift"]({fn:v[w],val:M[++p]})}else b||(h+=".")}l=t&&t.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0),m.forEach((function(e){var n=e.fn,t=e.val;return l=n(l,t,c)||l})),l=f?l:void 0}}if(l instanceof Date&&!isNaN(l.getTime()))return!0===i&&l.setHours(0,0,0,0),l;t.errorHandler(new Error("Invalid date provided: "+s))}}};function M(e,n,t){return void 0===t&&(t=!0),!1!==t?new Date(e.getTime()).setHours(0,0,0,0)-new Date(n.getTime()).setHours(0,0,0,0):e.getTime()-n.getTime()}var y=function(e,n,t){return 3600*e+60*n+t},x=864e5;function E(e){var n=e.defaultHour,t=e.defaultMinute,a=e.defaultSeconds;if(void 0!==e.minDate){var i=e.minDate.getHours(),o=e.minDate.getMinutes(),r=e.minDate.getSeconds();n<i&&(n=i),n===i&&t<o&&(t=o),n===i&&t===o&&a<r&&(a=e.minDate.getSeconds())}if(void 0!==e.maxDate){var l=e.maxDate.getHours(),c=e.maxDate.getMinutes();(n=Math.min(n,l))===l&&(t=Math.min(c,t)),n===l&&t===c&&(a=e.maxDate.getSeconds())}return{hours:n,minutes:t,seconds:a}}"function"!=typeof Object.assign&&(Object.assign=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];if(!e)throw TypeError("Cannot convert undefined or null to object");for(var a=function(n){n&&Object.keys(n).forEach((function(t){return e[t]=n[t]}))},i=0,o=n;i<o.length;i++){var r=o[i];a(r)}return e});function k(p,v){var w={config:e(e({},a),I.defaultConfig),l10n:i};function k(){var e;return(null===(e=w.calendarContainer)||void 0===e?void 0:e.getRootNode()).activeElement||document.activeElement}function T(e){return e.bind(w)}function S(){var e=w.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==w.calendarContainer&&(w.calendarContainer.style.visibility="hidden",w.calendarContainer.style.display="block"),void 0!==w.daysContainer){var n=(w.days.offsetWidth+1)*e.showMonths;w.daysContainer.style.width=n+"px",w.calendarContainer.style.width=n+(void 0!==w.weekWrapper?w.weekWrapper.offsetWidth:0)+"px",w.calendarContainer.style.removeProperty("visibility"),w.calendarContainer.style.removeProperty("display")}}))}function _(e){if(0===w.selectedDates.length){var n=void 0===w.config.minDate||M(new Date,w.config.minDate)>=0?new Date:new Date(w.config.minDate.getTime()),t=E(w.config);n.setHours(t.hours,t.minutes,t.seconds,n.getMilliseconds()),w.selectedDates=[n],w.latestSelectedDateObj=n}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();var n="keydown"===e.type,t=g(e),a=t;void 0!==w.amPM&&t===w.amPM&&(w.amPM.textContent=w.l10n.amPM[r(w.amPM.textContent===w.l10n.amPM[0])]);var i=parseFloat(a.getAttribute("min")),l=parseFloat(a.getAttribute("max")),c=parseFloat(a.getAttribute("step")),s=parseInt(a.value,10),d=e.delta||(n?38===e.which?1:-1:0),u=s+c*d;if(void 0!==a.value&&2===a.value.length){var f=a===w.hourElement,m=a===w.minuteElement;u<i?(u=l+u+r(!f)+(r(f)&&r(!w.amPM)),m&&L(void 0,-1,w.hourElement)):u>l&&(u=a===w.hourElement?u-l-r(!w.amPM):i,m&&L(void 0,1,w.hourElement)),w.amPM&&f&&(1===c?u+s===23:Math.abs(u-s)>c)&&(w.amPM.textContent=w.l10n.amPM[r(w.amPM.textContent===w.l10n.amPM[0])]),a.value=o(u)}}(e);var a=w._input.value;O(),ye(),w._input.value!==a&&w._debouncedChange()}function O(){if(void 0!==w.hourElement&&void 0!==w.minuteElement){var e,n,t=(parseInt(w.hourElement.value.slice(-2),10)||0)%24,a=(parseInt(w.minuteElement.value,10)||0)%60,i=void 0!==w.secondElement?(parseInt(w.secondElement.value,10)||0)%60:0;void 0!==w.amPM&&(e=t,n=w.amPM.textContent,t=e%12+12*r(n===w.l10n.amPM[1]));var o=void 0!==w.config.minTime||w.config.minDate&&w.minDateHasTime&&w.latestSelectedDateObj&&0===M(w.latestSelectedDateObj,w.config.minDate,!0),l=void 0!==w.config.maxTime||w.config.maxDate&&w.maxDateHasTime&&w.latestSelectedDateObj&&0===M(w.latestSelectedDateObj,w.config.maxDate,!0);if(void 0!==w.config.maxTime&&void 0!==w.config.minTime&&w.config.minTime>w.config.maxTime){var c=y(w.config.minTime.getHours(),w.config.minTime.getMinutes(),w.config.minTime.getSeconds()),s=y(w.config.maxTime.getHours(),w.config.maxTime.getMinutes(),w.config.maxTime.getSeconds()),d=y(t,a,i);if(d>s&&d<c){var u=function(e){var n=Math.floor(e/3600),t=(e-3600*n)/60;return[n,t,e-3600*n-60*t]}(c);t=u[0],a=u[1],i=u[2]}}else{if(l){var f=void 0!==w.config.maxTime?w.config.maxTime:w.config.maxDate;(t=Math.min(t,f.getHours()))===f.getHours()&&(a=Math.min(a,f.getMinutes())),a===f.getMinutes()&&(i=Math.min(i,f.getSeconds()))}if(o){var m=void 0!==w.config.minTime?w.config.minTime:w.config.minDate;(t=Math.max(t,m.getHours()))===m.getHours()&&a<m.getMinutes()&&(a=m.getMinutes()),a===m.getMinutes()&&(i=Math.max(i,m.getSeconds()))}}A(t,a,i)}}function F(e){var n=e||w.latestSelectedDateObj;n&&n instanceof Date&&A(n.getHours(),n.getMinutes(),n.getSeconds())}function A(e,n,t){void 0!==w.latestSelectedDateObj&&w.latestSelectedDateObj.setHours(e%24,n,t||0,0),w.hourElement&&w.minuteElement&&!w.isMobile&&(w.hourElement.value=o(w.config.time_24hr?e:(12+e)%12+12*r(e%12==0)),w.minuteElement.value=o(n),void 0!==w.amPM&&(w.amPM.textContent=w.l10n.amPM[r(e>=12)]),void 0!==w.secondElement&&(w.secondElement.value=o(t)))}function N(e){var n=g(e),t=parseInt(n.value)+(e.delta||0);(t/1e3>1||"Enter"===e.key&&!/[^\d]/.test(t.toString()))&&ee(t)}function P(e,n,t,a){return n instanceof Array?n.forEach((function(n){return P(e,n,t,a)})):e instanceof Array?e.forEach((function(e){return P(e,n,t,a)})):(e.addEventListener(n,t,a),void w._handlers.push({remove:function(){return e.removeEventListener(n,t,a)}}))}function Y(){De("onChange")}function j(e,n){var t=void 0!==e?w.parseDate(e):w.latestSelectedDateObj||(w.config.minDate&&w.config.minDate>w.now?w.config.minDate:w.config.maxDate&&w.config.maxDate<w.now?w.config.maxDate:w.now),a=w.currentYear,i=w.currentMonth;try{void 0!==t&&(w.currentYear=t.getFullYear(),w.currentMonth=t.getMonth())}catch(e){e.message="Invalid date supplied: "+t,w.config.errorHandler(e)}n&&w.currentYear!==a&&(De("onYearChange"),q()),!n||w.currentYear===a&&w.currentMonth===i||De("onMonthChange"),w.redraw()}function H(e){var n=g(e);~n.className.indexOf("arrow")&&L(e,n.classList.contains("arrowUp")?1:-1)}function L(e,n,t){var a=e&&g(e),i=t||a&&a.parentNode&&a.parentNode.firstChild,o=we("increment");o.delta=n,i&&i.dispatchEvent(o)}function R(e,n,t,a){var i=ne(n,!0),o=d("span",e,n.getDate().toString());return o.dateObj=n,o.$i=a,o.setAttribute("aria-label",w.formatDate(n,w.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===M(n,w.now)&&(w.todayDateElem=o,o.classList.add("today"),o.setAttribute("aria-current","date")),i?(o.tabIndex=-1,be(n)&&(o.classList.add("selected"),w.selectedDateElem=o,"range"===w.config.mode&&(s(o,"startRange",w.selectedDates[0]&&0===M(n,w.selectedDates[0],!0)),s(o,"endRange",w.selectedDates[1]&&0===M(n,w.selectedDates[1],!0)),"nextMonthDay"===e&&o.classList.add("inRange")))):o.classList.add("flatpickr-disabled"),"range"===w.config.mode&&function(e){return!("range"!==w.config.mode||w.selectedDates.length<2)&&(M(e,w.selectedDates[0])>=0&&M(e,w.selectedDates[1])<=0)}(n)&&!be(n)&&o.classList.add("inRange"),w.weekNumbers&&1===w.config.showMonths&&"prevMonthDay"!==e&&a%7==6&&w.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+w.config.getWeek(n)+"</span>"),De("onDayCreate",o),o}function W(e){e.focus(),"range"===w.config.mode&&oe(e)}function B(e){for(var n=e>0?0:w.config.showMonths-1,t=e>0?w.config.showMonths:-1,a=n;a!=t;a+=e)for(var i=w.daysContainer.children[a],o=e>0?0:i.children.length-1,r=e>0?i.children.length:-1,l=o;l!=r;l+=e){var c=i.children[l];if(-1===c.className.indexOf("hidden")&&ne(c.dateObj))return c}}function J(e,n){var t=k(),a=te(t||document.body),i=void 0!==e?e:a?t:void 0!==w.selectedDateElem&&te(w.selectedDateElem)?w.selectedDateElem:void 0!==w.todayDateElem&&te(w.todayDateElem)?w.todayDateElem:B(n>0?1:-1);void 0===i?w._input.focus():a?function(e,n){for(var t=-1===e.className.indexOf("Month")?e.dateObj.getMonth():w.currentMonth,a=n>0?w.config.showMonths:-1,i=n>0?1:-1,o=t-w.currentMonth;o!=a;o+=i)for(var r=w.daysContainer.children[o],l=t-w.currentMonth===o?e.$i+n:n<0?r.children.length-1:0,c=r.children.length,s=l;s>=0&&s<c&&s!=(n>0?c:-1);s+=i){var d=r.children[s];if(-1===d.className.indexOf("hidden")&&ne(d.dateObj)&&Math.abs(e.$i-s)>=Math.abs(n))return W(d)}w.changeMonth(i),J(B(i),0)}(i,n):W(i)}function K(e,n){for(var t=(new Date(e,n,1).getDay()-w.l10n.firstDayOfWeek+7)%7,a=w.utils.getDaysInMonth((n-1+12)%12,e),i=w.utils.getDaysInMonth(n,e),o=window.document.createDocumentFragment(),r=w.config.showMonths>1,l=r?"prevMonthDay hidden":"prevMonthDay",c=r?"nextMonthDay hidden":"nextMonthDay",s=a+1-t,u=0;s<=a;s++,u++)o.appendChild(R("flatpickr-day "+l,new Date(e,n-1,s),0,u));for(s=1;s<=i;s++,u++)o.appendChild(R("flatpickr-day",new Date(e,n,s),0,u));for(var f=i+1;f<=42-t&&(1===w.config.showMonths||u%7!=0);f++,u++)o.appendChild(R("flatpickr-day "+c,new Date(e,n+1,f%i),0,u));var m=d("div","dayContainer");return m.appendChild(o),m}function U(){if(void 0!==w.daysContainer){u(w.daysContainer),w.weekNumbers&&u(w.weekNumbers);for(var e=document.createDocumentFragment(),n=0;n<w.config.showMonths;n++){var t=new Date(w.currentYear,w.currentMonth,1);t.setMonth(w.currentMonth+n),e.appendChild(K(t.getFullYear(),t.getMonth()))}w.daysContainer.appendChild(e),w.days=w.daysContainer.firstChild,"range"===w.config.mode&&1===w.selectedDates.length&&oe()}}function q(){if(!(w.config.showMonths>1||"dropdown"!==w.config.monthSelectorType)){var e=function(e){return!(void 0!==w.config.minDate&&w.currentYear===w.config.minDate.getFullYear()&&e<w.config.minDate.getMonth())&&!(void 0!==w.config.maxDate&&w.currentYear===w.config.maxDate.getFullYear()&&e>w.config.maxDate.getMonth())};w.monthsDropdownContainer.tabIndex=-1,w.monthsDropdownContainer.innerHTML="";for(var n=0;n<12;n++)if(e(n)){var t=d("option","flatpickr-monthDropdown-month");t.value=new Date(w.currentYear,n).getMonth().toString(),t.textContent=h(n,w.config.shorthandCurrentMonth,w.l10n),t.tabIndex=-1,w.currentMonth===n&&(t.selected=!0),w.monthsDropdownContainer.appendChild(t)}}}function $(){var e,n=d("div","flatpickr-month"),t=window.document.createDocumentFragment();w.config.showMonths>1||"static"===w.config.monthSelectorType?e=d("span","cur-month"):(w.monthsDropdownContainer=d("select","flatpickr-monthDropdown-months"),w.monthsDropdownContainer.setAttribute("aria-label",w.l10n.monthAriaLabel),P(w.monthsDropdownContainer,"change",(function(e){var n=g(e),t=parseInt(n.value,10);w.changeMonth(t-w.currentMonth),De("onMonthChange")})),q(),e=w.monthsDropdownContainer);var a=m("cur-year",{tabindex:"-1"}),i=a.getElementsByTagName("input")[0];i.setAttribute("aria-label",w.l10n.yearAriaLabel),w.config.minDate&&i.setAttribute("min",w.config.minDate.getFullYear().toString()),w.config.maxDate&&(i.setAttribute("max",w.config.maxDate.getFullYear().toString()),i.disabled=!!w.config.minDate&&w.config.minDate.getFullYear()===w.config.maxDate.getFullYear());var o=d("div","flatpickr-current-month");return o.appendChild(e),o.appendChild(a),t.appendChild(o),n.appendChild(t),{container:n,yearElement:i,monthElement:e}}function V(){u(w.monthNav),w.monthNav.appendChild(w.prevMonthNav),w.config.showMonths&&(w.yearElements=[],w.monthElements=[]);for(var e=w.config.showMonths;e--;){var n=$();w.yearElements.push(n.yearElement),w.monthElements.push(n.monthElement),w.monthNav.appendChild(n.container)}w.monthNav.appendChild(w.nextMonthNav)}function z(){w.weekdayContainer?u(w.weekdayContainer):w.weekdayContainer=d("div","flatpickr-weekdays");for(var e=w.config.showMonths;e--;){var n=d("div","flatpickr-weekdaycontainer");w.weekdayContainer.appendChild(n)}return G(),w.weekdayContainer}function G(){if(w.weekdayContainer){var e=w.l10n.firstDayOfWeek,t=n(w.l10n.weekdays.shorthand);e>0&&e<t.length&&(t=n(t.splice(e,t.length),t.splice(0,e)));for(var a=w.config.showMonths;a--;)w.weekdayContainer.children[a].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+t.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function Z(e,n){void 0===n&&(n=!0);var t=n?e:e-w.currentMonth;t<0&&!0===w._hidePrevMonthArrow||t>0&&!0===w._hideNextMonthArrow||(w.currentMonth+=t,(w.currentMonth<0||w.currentMonth>11)&&(w.currentYear+=w.currentMonth>11?1:-1,w.currentMonth=(w.currentMonth+12)%12,De("onYearChange"),q()),U(),De("onMonthChange"),Ce())}function Q(e){return w.calendarContainer.contains(e)}function X(e){if(w.isOpen&&!w.config.inline){var n=g(e),t=Q(n),a=!(n===w.input||n===w.altInput||w.element.contains(n)||e.path&&e.path.indexOf&&(~e.path.indexOf(w.input)||~e.path.indexOf(w.altInput)))&&!t&&!Q(e.relatedTarget),i=!w.config.ignoredFocusElements.some((function(e){return e.contains(n)}));a&&i&&(w.config.allowInput&&w.setDate(w._input.value,!1,w.config.altInput?w.config.altFormat:w.config.dateFormat),void 0!==w.timeContainer&&void 0!==w.minuteElement&&void 0!==w.hourElement&&""!==w.input.value&&void 0!==w.input.value&&_(),w.close(),w.config&&"range"===w.config.mode&&1===w.selectedDates.length&&w.clear(!1))}}function ee(e){if(!(!e||w.config.minDate&&e<w.config.minDate.getFullYear()||w.config.maxDate&&e>w.config.maxDate.getFullYear())){var n=e,t=w.currentYear!==n;w.currentYear=n||w.currentYear,w.config.maxDate&&w.currentYear===w.config.maxDate.getFullYear()?w.currentMonth=Math.min(w.config.maxDate.getMonth(),w.currentMonth):w.config.minDate&&w.currentYear===w.config.minDate.getFullYear()&&(w.currentMonth=Math.max(w.config.minDate.getMonth(),w.currentMonth)),t&&(w.redraw(),De("onYearChange"),q())}}function ne(e,n){var t;void 0===n&&(n=!0);var a=w.parseDate(e,void 0,n);if(w.config.minDate&&a&&M(a,w.config.minDate,void 0!==n?n:!w.minDateHasTime)<0||w.config.maxDate&&a&&M(a,w.config.maxDate,void 0!==n?n:!w.maxDateHasTime)>0)return!1;if(!w.config.enable&&0===w.config.disable.length)return!0;if(void 0===a)return!1;for(var i=!!w.config.enable,o=null!==(t=w.config.enable)&&void 0!==t?t:w.config.disable,r=0,l=void 0;r<o.length;r++){if("function"==typeof(l=o[r])&&l(a))return i;if(l instanceof Date&&void 0!==a&&l.getTime()===a.getTime())return i;if("string"==typeof l){var c=w.parseDate(l,void 0,!0);return c&&c.getTime()===a.getTime()?i:!i}if("object"==typeof l&&void 0!==a&&l.from&&l.to&&a.getTime()>=l.from.getTime()&&a.getTime()<=l.to.getTime())return i}return!i}function te(e){return void 0!==w.daysContainer&&(-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&w.daysContainer.contains(e))}function ae(e){var n=e.target===w._input,t=w._input.value.trimEnd()!==Me();!n||!t||e.relatedTarget&&Q(e.relatedTarget)||w.setDate(w._input.value,!0,e.target===w.altInput?w.config.altFormat:w.config.dateFormat)}function ie(e){var n=g(e),t=w.config.wrap?p.contains(n):n===w._input,a=w.config.allowInput,i=w.isOpen&&(!a||!t),o=w.config.inline&&t&&!a;if(13===e.keyCode&&t){if(a)return w.setDate(w._input.value,!0,n===w.altInput?w.config.altFormat:w.config.dateFormat),w.close(),n.blur();w.open()}else if(Q(n)||i||o){var r=!!w.timeContainer&&w.timeContainer.contains(n);switch(e.keyCode){case 13:r?(e.preventDefault(),_(),fe()):me(e);break;case 27:e.preventDefault(),fe();break;case 8:case 46:t&&!w.config.allowInput&&(e.preventDefault(),w.clear());break;case 37:case 39:if(r||t)w.hourElement&&w.hourElement.focus();else{e.preventDefault();var l=k();if(void 0!==w.daysContainer&&(!1===a||l&&te(l))){var c=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),Z(c),J(B(1),0)):J(void 0,c)}}break;case 38:case 40:e.preventDefault();var s=40===e.keyCode?1:-1;w.daysContainer&&void 0!==n.$i||n===w.input||n===w.altInput?e.ctrlKey?(e.stopPropagation(),ee(w.currentYear-s),J(B(1),0)):r||J(void 0,7*s):n===w.currentYearElement?ee(w.currentYear-s):w.config.enableTime&&(!r&&w.hourElement&&w.hourElement.focus(),_(e),w._debouncedChange());break;case 9:if(r){var d=[w.hourElement,w.minuteElement,w.secondElement,w.amPM].concat(w.pluginElements).filter((function(e){return e})),u=d.indexOf(n);if(-1!==u){var f=d[u+(e.shiftKey?-1:1)];e.preventDefault(),(f||w._input).focus()}}else!w.config.noCalendar&&w.daysContainer&&w.daysContainer.contains(n)&&e.shiftKey&&(e.preventDefault(),w._input.focus())}}if(void 0!==w.amPM&&n===w.amPM)switch(e.key){case w.l10n.amPM[0].charAt(0):case w.l10n.amPM[0].charAt(0).toLowerCase():w.amPM.textContent=w.l10n.amPM[0],O(),ye();break;case w.l10n.amPM[1].charAt(0):case w.l10n.amPM[1].charAt(0).toLowerCase():w.amPM.textContent=w.l10n.amPM[1],O(),ye()}(t||Q(n))&&De("onKeyDown",e)}function oe(e,n){if(void 0===n&&(n="flatpickr-day"),1===w.selectedDates.length&&(!e||e.classList.contains(n)&&!e.classList.contains("flatpickr-disabled"))){for(var t=e?e.dateObj.getTime():w.days.firstElementChild.dateObj.getTime(),a=w.parseDate(w.selectedDates[0],void 0,!0).getTime(),i=Math.min(t,w.selectedDates[0].getTime()),o=Math.max(t,w.selectedDates[0].getTime()),r=!1,l=0,c=0,s=i;s<o;s+=x)ne(new Date(s),!0)||(r=r||s>i&&s<o,s<a&&(!l||s>l)?l=s:s>a&&(!c||s<c)&&(c=s));Array.from(w.rContainer.querySelectorAll("*:nth-child(-n+"+w.config.showMonths+") > ."+n)).forEach((function(n){var i,o,s,d=n.dateObj.getTime(),u=l>0&&d<l||c>0&&d>c;if(u)return n.classList.add("notAllowed"),void["inRange","startRange","endRange"].forEach((function(e){n.classList.remove(e)}));r&&!u||(["startRange","inRange","endRange","notAllowed"].forEach((function(e){n.classList.remove(e)})),void 0!==e&&(e.classList.add(t<=w.selectedDates[0].getTime()?"startRange":"endRange"),a<t&&d===a?n.classList.add("startRange"):a>t&&d===a&&n.classList.add("endRange"),d>=l&&(0===c||d<=c)&&(o=a,s=t,(i=d)>Math.min(o,s)&&i<Math.max(o,s))&&n.classList.add("inRange")))}))}}function re(){!w.isOpen||w.config.static||w.config.inline||de()}function le(e){return function(n){var t=w.config["_"+e+"Date"]=w.parseDate(n,w.config.dateFormat),a=w.config["_"+("min"===e?"max":"min")+"Date"];void 0!==t&&(w["min"===e?"minDateHasTime":"maxDateHasTime"]=t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0),w.selectedDates&&(w.selectedDates=w.selectedDates.filter((function(e){return ne(e)})),w.selectedDates.length||"min"!==e||F(t),ye()),w.daysContainer&&(ue(),void 0!==t?w.currentYearElement[e]=t.getFullYear().toString():w.currentYearElement.removeAttribute(e),w.currentYearElement.disabled=!!a&&void 0!==t&&a.getFullYear()===t.getFullYear())}}function ce(){return w.config.wrap?p.querySelector("[data-input]"):p}function se(){"object"!=typeof w.config.locale&&void 0===I.l10ns[w.config.locale]&&w.config.errorHandler(new Error("flatpickr: invalid locale "+w.config.locale)),w.l10n=e(e({},I.l10ns.default),"object"==typeof w.config.locale?w.config.locale:"default"!==w.config.locale?I.l10ns[w.config.locale]:void 0),D.D="("+w.l10n.weekdays.shorthand.join("|")+")",D.l="("+w.l10n.weekdays.longhand.join("|")+")",D.M="("+w.l10n.months.shorthand.join("|")+")",D.F="("+w.l10n.months.longhand.join("|")+")",D.K="("+w.l10n.amPM[0]+"|"+w.l10n.amPM[1]+"|"+w.l10n.amPM[0].toLowerCase()+"|"+w.l10n.amPM[1].toLowerCase()+")",void 0===e(e({},v),JSON.parse(JSON.stringify(p.dataset||{}))).time_24hr&&void 0===I.defaultConfig.time_24hr&&(w.config.time_24hr=w.l10n.time_24hr),w.formatDate=b(w),w.parseDate=C({config:w.config,l10n:w.l10n})}function de(e){if("function"!=typeof w.config.position){if(void 0!==w.calendarContainer){De("onPreCalendarPosition");var n=e||w._positionElement,t=Array.prototype.reduce.call(w.calendarContainer.children,(function(e,n){return e+n.offsetHeight}),0),a=w.calendarContainer.offsetWidth,i=w.config.position.split(" "),o=i[0],r=i.length>1?i[1]:null,l=n.getBoundingClientRect(),c=window.innerHeight-l.bottom,d="above"===o||"below"!==o&&c<t&&l.top>t,u=window.pageYOffset+l.top+(d?-t-2:n.offsetHeight+2);if(s(w.calendarContainer,"arrowTop",!d),s(w.calendarContainer,"arrowBottom",d),!w.config.inline){var f=window.pageXOffset+l.left,m=!1,g=!1;"center"===r?(f-=(a-l.width)/2,m=!0):"right"===r&&(f-=a-l.width,g=!0),s(w.calendarContainer,"arrowLeft",!m&&!g),s(w.calendarContainer,"arrowCenter",m),s(w.calendarContainer,"arrowRight",g);var p=window.document.body.offsetWidth-(window.pageXOffset+l.right),h=f+a>window.document.body.offsetWidth,v=p+a>window.document.body.offsetWidth;if(s(w.calendarContainer,"rightMost",h),!w.config.static)if(w.calendarContainer.style.top=u+"px",h)if(v){var D=function(){for(var e=null,n=0;n<document.styleSheets.length;n++){var t=document.styleSheets[n];if(t.cssRules){try{t.cssRules}catch(e){continue}e=t;break}}return null!=e?e:(a=document.createElement("style"),document.head.appendChild(a),a.sheet);var a}();if(void 0===D)return;var b=window.document.body.offsetWidth,C=Math.max(0,b/2-a/2),M=D.cssRules.length,y="{left:"+l.left+"px;right:auto;}";s(w.calendarContainer,"rightMost",!1),s(w.calendarContainer,"centerMost",!0),D.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+y,M),w.calendarContainer.style.left=C+"px",w.calendarContainer.style.right="auto"}else w.calendarContainer.style.left="auto",w.calendarContainer.style.right=p+"px";else w.calendarContainer.style.left=f+"px",w.calendarContainer.style.right="auto"}}}else w.config.position(w,e)}function ue(){w.config.noCalendar||w.isMobile||(q(),Ce(),U())}function fe(){w._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(w.close,0):w.close()}function me(e){e.preventDefault(),e.stopPropagation();var n=f(g(e),(function(e){return e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")}));if(void 0!==n){var t=n,a=w.latestSelectedDateObj=new Date(t.dateObj.getTime()),i=(a.getMonth()<w.currentMonth||a.getMonth()>w.currentMonth+w.config.showMonths-1)&&"range"!==w.config.mode;if(w.selectedDateElem=t,"single"===w.config.mode)w.selectedDates=[a];else if("multiple"===w.config.mode){var o=be(a);o?w.selectedDates.splice(parseInt(o),1):w.selectedDates.push(a)}else"range"===w.config.mode&&(2===w.selectedDates.length&&w.clear(!1,!1),w.latestSelectedDateObj=a,w.selectedDates.push(a),0!==M(a,w.selectedDates[0],!0)&&w.selectedDates.sort((function(e,n){return e.getTime()-n.getTime()})));if(O(),i){var r=w.currentYear!==a.getFullYear();w.currentYear=a.getFullYear(),w.currentMonth=a.getMonth(),r&&(De("onYearChange"),q()),De("onMonthChange")}if(Ce(),U(),ye(),i||"range"===w.config.mode||1!==w.config.showMonths?void 0!==w.selectedDateElem&&void 0===w.hourElement&&w.selectedDateElem&&w.selectedDateElem.focus():W(t),void 0!==w.hourElement&&void 0!==w.hourElement&&w.hourElement.focus(),w.config.closeOnSelect){var l="single"===w.config.mode&&!w.config.enableTime,c="range"===w.config.mode&&2===w.selectedDates.length&&!w.config.enableTime;(l||c)&&fe()}Y()}}w.parseDate=C({config:w.config,l10n:w.l10n}),w._handlers=[],w.pluginElements=[],w.loadedPlugins=[],w._bind=P,w._setHoursFromDate=F,w._positionCalendar=de,w.changeMonth=Z,w.changeYear=ee,w.clear=function(e,n){void 0===e&&(e=!0);void 0===n&&(n=!0);w.input.value="",void 0!==w.altInput&&(w.altInput.value="");void 0!==w.mobileInput&&(w.mobileInput.value="");w.selectedDates=[],w.latestSelectedDateObj=void 0,!0===n&&(w.currentYear=w._initialDate.getFullYear(),w.currentMonth=w._initialDate.getMonth());if(!0===w.config.enableTime){var t=E(w.config),a=t.hours,i=t.minutes,o=t.seconds;A(a,i,o)}w.redraw(),e&&De("onChange")},w.close=function(){w.isOpen=!1,w.isMobile||(void 0!==w.calendarContainer&&w.calendarContainer.classList.remove("open"),void 0!==w._input&&w._input.classList.remove("active"));De("onClose")},w.onMouseOver=oe,w._createElement=d,w.createDay=R,w.destroy=function(){void 0!==w.config&&De("onDestroy");for(var e=w._handlers.length;e--;)w._handlers[e].remove();if(w._handlers=[],w.mobileInput)w.mobileInput.parentNode&&w.mobileInput.parentNode.removeChild(w.mobileInput),w.mobileInput=void 0;else if(w.calendarContainer&&w.calendarContainer.parentNode)if(w.config.static&&w.calendarContainer.parentNode){var n=w.calendarContainer.parentNode;if(n.lastChild&&n.removeChild(n.lastChild),n.parentNode){for(;n.firstChild;)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}}else w.calendarContainer.parentNode.removeChild(w.calendarContainer);w.altInput&&(w.input.type="text",w.altInput.parentNode&&w.altInput.parentNode.removeChild(w.altInput),delete w.altInput);w.input&&(w.input.type=w.input._type,w.input.classList.remove("flatpickr-input"),w.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((function(e){try{delete w[e]}catch(e){}}))},w.isEnabled=ne,w.jumpToDate=j,w.updateValue=ye,w.open=function(e,n){void 0===n&&(n=w._positionElement);if(!0===w.isMobile){if(e){e.preventDefault();var t=g(e);t&&t.blur()}return void 0!==w.mobileInput&&(w.mobileInput.focus(),w.mobileInput.click()),void De("onOpen")}if(w._input.disabled||w.config.inline)return;var a=w.isOpen;w.isOpen=!0,a||(w.calendarContainer.classList.add("open"),w._input.classList.add("active"),De("onOpen"),de(n));!0===w.config.enableTime&&!0===w.config.noCalendar&&(!1!==w.config.allowInput||void 0!==e&&w.timeContainer.contains(e.relatedTarget)||setTimeout((function(){return w.hourElement.select()}),50))},w.redraw=ue,w.set=function(e,n){if(null!==e&&"object"==typeof e)for(var a in Object.assign(w.config,e),e)void 0!==ge[a]&&ge[a].forEach((function(e){return e()}));else w.config[e]=n,void 0!==ge[e]?ge[e].forEach((function(e){return e()})):t.indexOf(e)>-1&&(w.config[e]=c(n));w.redraw(),ye(!0)},w.setDate=function(e,n,t){void 0===n&&(n=!1);void 0===t&&(t=w.config.dateFormat);if(0!==e&&!e||e instanceof Array&&0===e.length)return w.clear(n);pe(e,t),w.latestSelectedDateObj=w.selectedDates[w.selectedDates.length-1],w.redraw(),j(void 0,n),F(),0===w.selectedDates.length&&w.clear(!1);ye(n),n&&De("onChange")},w.toggle=function(e){if(!0===w.isOpen)return w.close();w.open(e)};var ge={locale:[se,G],showMonths:[V,S,z],minDate:[j],maxDate:[j],positionElement:[ve],clickOpens:[function(){!0===w.config.clickOpens?(P(w._input,"focus",w.open),P(w._input,"click",w.open)):(w._input.removeEventListener("focus",w.open),w._input.removeEventListener("click",w.open))}]};function pe(e,n){var t=[];if(e instanceof Array)t=e.map((function(e){return w.parseDate(e,n)}));else if(e instanceof Date||"number"==typeof e)t=[w.parseDate(e,n)];else if("string"==typeof e)switch(w.config.mode){case"single":case"time":t=[w.parseDate(e,n)];break;case"multiple":t=e.split(w.config.conjunction).map((function(e){return w.parseDate(e,n)}));break;case"range":t=e.split(w.l10n.rangeSeparator).map((function(e){return w.parseDate(e,n)}))}else w.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(e)));w.selectedDates=w.config.allowInvalidPreload?t:t.filter((function(e){return e instanceof Date&&ne(e,!1)})),"range"===w.config.mode&&w.selectedDates.sort((function(e,n){return e.getTime()-n.getTime()}))}function he(e){return e.slice().map((function(e){return"string"==typeof e||"number"==typeof e||e instanceof Date?w.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:w.parseDate(e.from,void 0),to:w.parseDate(e.to,void 0)}:e})).filter((function(e){return e}))}function ve(){w._positionElement=w.config.positionElement||w._input}function De(e,n){if(void 0!==w.config){var t=w.config[e];if(void 0!==t&&t.length>0)for(var a=0;t[a]&&a<t.length;a++)t[a](w.selectedDates,w.input.value,w,n);"onChange"===e&&(w.input.dispatchEvent(we("change")),w.input.dispatchEvent(we("input")))}}function we(e){var n=document.createEvent("Event");return n.initEvent(e,!0,!0),n}function be(e){for(var n=0;n<w.selectedDates.length;n++){var t=w.selectedDates[n];if(t instanceof Date&&0===M(t,e))return""+n}return!1}function Ce(){w.config.noCalendar||w.isMobile||!w.monthNav||(w.yearElements.forEach((function(e,n){var t=new Date(w.currentYear,w.currentMonth,1);t.setMonth(w.currentMonth+n),w.config.showMonths>1||"static"===w.config.monthSelectorType?w.monthElements[n].textContent=h(t.getMonth(),w.config.shorthandCurrentMonth,w.l10n)+" ":w.monthsDropdownContainer.value=t.getMonth().toString(),e.value=t.getFullYear().toString()})),w._hidePrevMonthArrow=void 0!==w.config.minDate&&(w.currentYear===w.config.minDate.getFullYear()?w.currentMonth<=w.config.minDate.getMonth():w.currentYear<w.config.minDate.getFullYear()),w._hideNextMonthArrow=void 0!==w.config.maxDate&&(w.currentYear===w.config.maxDate.getFullYear()?w.currentMonth+1>w.config.maxDate.getMonth():w.currentYear>w.config.maxDate.getFullYear()))}function Me(e){var n=e||(w.config.altInput?w.config.altFormat:w.config.dateFormat);return w.selectedDates.map((function(e){return w.formatDate(e,n)})).filter((function(e,n,t){return"range"!==w.config.mode||w.config.enableTime||t.indexOf(e)===n})).join("range"!==w.config.mode?w.config.conjunction:w.l10n.rangeSeparator)}function ye(e){void 0===e&&(e=!0),void 0!==w.mobileInput&&w.mobileFormatStr&&(w.mobileInput.value=void 0!==w.latestSelectedDateObj?w.formatDate(w.latestSelectedDateObj,w.mobileFormatStr):""),w.input.value=Me(w.config.dateFormat),void 0!==w.altInput&&(w.altInput.value=Me(w.config.altFormat)),!1!==e&&De("onValueUpdate")}function xe(e){var n=g(e),t=w.prevMonthNav.contains(n),a=w.nextMonthNav.contains(n);t||a?Z(t?-1:1):w.yearElements.indexOf(n)>=0?n.select():n.classList.contains("arrowUp")?w.changeYear(w.currentYear+1):n.classList.contains("arrowDown")&&w.changeYear(w.currentYear-1)}return function(){w.element=w.input=p,w.isOpen=!1,function(){var n=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],i=e(e({},JSON.parse(JSON.stringify(p.dataset||{}))),v),o={};w.config.parseDate=i.parseDate,w.config.formatDate=i.formatDate,Object.defineProperty(w.config,"enable",{get:function(){return w.config._enable},set:function(e){w.config._enable=he(e)}}),Object.defineProperty(w.config,"disable",{get:function(){return w.config._disable},set:function(e){w.config._disable=he(e)}});var r="time"===i.mode;if(!i.dateFormat&&(i.enableTime||r)){var l=I.defaultConfig.dateFormat||a.dateFormat;o.dateFormat=i.noCalendar||r?"H:i"+(i.enableSeconds?":S":""):l+" H:i"+(i.enableSeconds?":S":"")}if(i.altInput&&(i.enableTime||r)&&!i.altFormat){var s=I.defaultConfig.altFormat||a.altFormat;o.altFormat=i.noCalendar||r?"h:i"+(i.enableSeconds?":S K":" K"):s+" h:i"+(i.enableSeconds?":S":"")+" K"}Object.defineProperty(w.config,"minDate",{get:function(){return w.config._minDate},set:le("min")}),Object.defineProperty(w.config,"maxDate",{get:function(){return w.config._maxDate},set:le("max")});var d=function(e){return function(n){w.config["min"===e?"_minTime":"_maxTime"]=w.parseDate(n,"H:i:S")}};Object.defineProperty(w.config,"minTime",{get:function(){return w.config._minTime},set:d("min")}),Object.defineProperty(w.config,"maxTime",{get:function(){return w.config._maxTime},set:d("max")}),"time"===i.mode&&(w.config.noCalendar=!0,w.config.enableTime=!0);Object.assign(w.config,o,i);for(var u=0;u<n.length;u++)w.config[n[u]]=!0===w.config[n[u]]||"true"===w.config[n[u]];t.filter((function(e){return void 0!==w.config[e]})).forEach((function(e){w.config[e]=c(w.config[e]||[]).map(T)})),w.isMobile=!w.config.disableMobile&&!w.config.inline&&"single"===w.config.mode&&!w.config.disable.length&&!w.config.enable&&!w.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(u=0;u<w.config.plugins.length;u++){var f=w.config.plugins[u](w)||{};for(var m in f)t.indexOf(m)>-1?w.config[m]=c(f[m]).map(T).concat(w.config[m]):void 0===i[m]&&(w.config[m]=f[m])}i.altInputClass||(w.config.altInputClass=ce().className+" "+w.config.altInputClass);De("onParseConfig")}(),se(),function(){if(w.input=ce(),!w.input)return void w.config.errorHandler(new Error("Invalid input element specified"));w.input._type=w.input.type,w.input.type="text",w.input.classList.add("flatpickr-input"),w._input=w.input,w.config.altInput&&(w.altInput=d(w.input.nodeName,w.config.altInputClass),w._input=w.altInput,w.altInput.placeholder=w.input.placeholder,w.altInput.disabled=w.input.disabled,w.altInput.required=w.input.required,w.altInput.tabIndex=w.input.tabIndex,w.altInput.type="text",w.input.setAttribute("type","hidden"),!w.config.static&&w.input.parentNode&&w.input.parentNode.insertBefore(w.altInput,w.input.nextSibling));w.config.allowInput||w._input.setAttribute("readonly","readonly");ve()}(),function(){w.selectedDates=[],w.now=w.parseDate(w.config.now)||new Date;var e=w.config.defaultDate||("INPUT"!==w.input.nodeName&&"TEXTAREA"!==w.input.nodeName||!w.input.placeholder||w.input.value!==w.input.placeholder?w.input.value:null);e&&pe(e,w.config.dateFormat);w._initialDate=w.selectedDates.length>0?w.selectedDates[0]:w.config.minDate&&w.config.minDate.getTime()>w.now.getTime()?w.config.minDate:w.config.maxDate&&w.config.maxDate.getTime()<w.now.getTime()?w.config.maxDate:w.now,w.currentYear=w._initialDate.getFullYear(),w.currentMonth=w._initialDate.getMonth(),w.selectedDates.length>0&&(w.latestSelectedDateObj=w.selectedDates[0]);void 0!==w.config.minTime&&(w.config.minTime=w.parseDate(w.config.minTime,"H:i"));void 0!==w.config.maxTime&&(w.config.maxTime=w.parseDate(w.config.maxTime,"H:i"));w.minDateHasTime=!!w.config.minDate&&(w.config.minDate.getHours()>0||w.config.minDate.getMinutes()>0||w.config.minDate.getSeconds()>0),w.maxDateHasTime=!!w.config.maxDate&&(w.config.maxDate.getHours()>0||w.config.maxDate.getMinutes()>0||w.config.maxDate.getSeconds()>0)}(),w.utils={getDaysInMonth:function(e,n){return void 0===e&&(e=w.currentMonth),void 0===n&&(n=w.currentYear),1===e&&(n%4==0&&n%100!=0||n%400==0)?29:w.l10n.daysInMonth[e]}},w.isMobile||function(){var e=window.document.createDocumentFragment();if(w.calendarContainer=d("div","flatpickr-calendar"),w.calendarContainer.tabIndex=-1,!w.config.noCalendar){if(e.appendChild((w.monthNav=d("div","flatpickr-months"),w.yearElements=[],w.monthElements=[],w.prevMonthNav=d("span","flatpickr-prev-month"),w.prevMonthNav.innerHTML=w.config.prevArrow,w.nextMonthNav=d("span","flatpickr-next-month"),w.nextMonthNav.innerHTML=w.config.nextArrow,V(),Object.defineProperty(w,"_hidePrevMonthArrow",{get:function(){return w.__hidePrevMonthArrow},set:function(e){w.__hidePrevMonthArrow!==e&&(s(w.prevMonthNav,"flatpickr-disabled",e),w.__hidePrevMonthArrow=e)}}),Object.defineProperty(w,"_hideNextMonthArrow",{get:function(){return w.__hideNextMonthArrow},set:function(e){w.__hideNextMonthArrow!==e&&(s(w.nextMonthNav,"flatpickr-disabled",e),w.__hideNextMonthArrow=e)}}),w.currentYearElement=w.yearElements[0],Ce(),w.monthNav)),w.innerContainer=d("div","flatpickr-innerContainer"),w.config.weekNumbers){var n=function(){w.calendarContainer.classList.add("hasWeeks");var e=d("div","flatpickr-weekwrapper");e.appendChild(d("span","flatpickr-weekday",w.l10n.weekAbbreviation));var n=d("div","flatpickr-weeks");return e.appendChild(n),{weekWrapper:e,weekNumbers:n}}(),t=n.weekWrapper,a=n.weekNumbers;w.innerContainer.appendChild(t),w.weekNumbers=a,w.weekWrapper=t}w.rContainer=d("div","flatpickr-rContainer"),w.rContainer.appendChild(z()),w.daysContainer||(w.daysContainer=d("div","flatpickr-days"),w.daysContainer.tabIndex=-1),U(),w.rContainer.appendChild(w.daysContainer),w.innerContainer.appendChild(w.rContainer),e.appendChild(w.innerContainer)}w.config.enableTime&&e.appendChild(function(){w.calendarContainer.classList.add("hasTime"),w.config.noCalendar&&w.calendarContainer.classList.add("noCalendar");var e=E(w.config);w.timeContainer=d("div","flatpickr-time"),w.timeContainer.tabIndex=-1;var n=d("span","flatpickr-time-separator",":"),t=m("flatpickr-hour",{"aria-label":w.l10n.hourAriaLabel});w.hourElement=t.getElementsByTagName("input")[0];var a=m("flatpickr-minute",{"aria-label":w.l10n.minuteAriaLabel});w.minuteElement=a.getElementsByTagName("input")[0],w.hourElement.tabIndex=w.minuteElement.tabIndex=-1,w.hourElement.value=o(w.latestSelectedDateObj?w.latestSelectedDateObj.getHours():w.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),w.minuteElement.value=o(w.latestSelectedDateObj?w.latestSelectedDateObj.getMinutes():e.minutes),w.hourElement.setAttribute("step",w.config.hourIncrement.toString()),w.minuteElement.setAttribute("step",w.config.minuteIncrement.toString()),w.hourElement.setAttribute("min",w.config.time_24hr?"0":"1"),w.hourElement.setAttribute("max",w.config.time_24hr?"23":"12"),w.hourElement.setAttribute("maxlength","2"),w.minuteElement.setAttribute("min","0"),w.minuteElement.setAttribute("max","59"),w.minuteElement.setAttribute("maxlength","2"),w.timeContainer.appendChild(t),w.timeContainer.appendChild(n),w.timeContainer.appendChild(a),w.config.time_24hr&&w.timeContainer.classList.add("time24hr");if(w.config.enableSeconds){w.timeContainer.classList.add("hasSeconds");var i=m("flatpickr-second");w.secondElement=i.getElementsByTagName("input")[0],w.secondElement.value=o(w.latestSelectedDateObj?w.latestSelectedDateObj.getSeconds():e.seconds),w.secondElement.setAttribute("step",w.minuteElement.getAttribute("step")),w.secondElement.setAttribute("min","0"),w.secondElement.setAttribute("max","59"),w.secondElement.setAttribute("maxlength","2"),w.timeContainer.appendChild(d("span","flatpickr-time-separator",":")),w.timeContainer.appendChild(i)}w.config.time_24hr||(w.amPM=d("span","flatpickr-am-pm",w.l10n.amPM[r((w.latestSelectedDateObj?w.hourElement.value:w.config.defaultHour)>11)]),w.amPM.title=w.l10n.toggleTitle,w.amPM.tabIndex=-1,w.timeContainer.appendChild(w.amPM));return w.timeContainer}());s(w.calendarContainer,"rangeMode","range"===w.config.mode),s(w.calendarContainer,"animate",!0===w.config.animate),s(w.calendarContainer,"multiMonth",w.config.showMonths>1),w.calendarContainer.appendChild(e);var i=void 0!==w.config.appendTo&&void 0!==w.config.appendTo.nodeType;if((w.config.inline||w.config.static)&&(w.calendarContainer.classList.add(w.config.inline?"inline":"static"),w.config.inline&&(!i&&w.element.parentNode?w.element.parentNode.insertBefore(w.calendarContainer,w._input.nextSibling):void 0!==w.config.appendTo&&w.config.appendTo.appendChild(w.calendarContainer)),w.config.static)){var l=d("div","flatpickr-wrapper");w.element.parentNode&&w.element.parentNode.insertBefore(l,w.element),l.appendChild(w.element),w.altInput&&l.appendChild(w.altInput),l.appendChild(w.calendarContainer)}w.config.static||w.config.inline||(void 0!==w.config.appendTo?w.config.appendTo:window.document.body).appendChild(w.calendarContainer)}(),function(){w.config.wrap&&["open","close","toggle","clear"].forEach((function(e){Array.prototype.forEach.call(w.element.querySelectorAll("[data-"+e+"]"),(function(n){return P(n,"click",w[e])}))}));if(w.isMobile)return void function(){var e=w.config.enableTime?w.config.noCalendar?"time":"datetime-local":"date";w.mobileInput=d("input",w.input.className+" flatpickr-mobile"),w.mobileInput.tabIndex=1,w.mobileInput.type=e,w.mobileInput.disabled=w.input.disabled,w.mobileInput.required=w.input.required,w.mobileInput.placeholder=w.input.placeholder,w.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",w.selectedDates.length>0&&(w.mobileInput.defaultValue=w.mobileInput.value=w.formatDate(w.selectedDates[0],w.mobileFormatStr));w.config.minDate&&(w.mobileInput.min=w.formatDate(w.config.minDate,"Y-m-d"));w.config.maxDate&&(w.mobileInput.max=w.formatDate(w.config.maxDate,"Y-m-d"));w.input.getAttribute("step")&&(w.mobileInput.step=String(w.input.getAttribute("step")));w.input.type="hidden",void 0!==w.altInput&&(w.altInput.type="hidden");try{w.input.parentNode&&w.input.parentNode.insertBefore(w.mobileInput,w.input.nextSibling)}catch(e){}P(w.mobileInput,"change",(function(e){w.setDate(g(e).value,!1,w.mobileFormatStr),De("onChange"),De("onClose")}))}();var e=l(re,50);w._debouncedChange=l(Y,300),w.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&P(w.daysContainer,"mouseover",(function(e){"range"===w.config.mode&&oe(g(e))}));P(w._input,"keydown",ie),void 0!==w.calendarContainer&&P(w.calendarContainer,"keydown",ie);w.config.inline||w.config.static||P(window,"resize",e);void 0!==window.ontouchstart?P(window.document,"touchstart",X):P(window.document,"mousedown",X);P(window.document,"focus",X,{capture:!0}),!0===w.config.clickOpens&&(P(w._input,"focus",w.open),P(w._input,"click",w.open));void 0!==w.daysContainer&&(P(w.monthNav,"click",xe),P(w.monthNav,["keyup","increment"],N),P(w.daysContainer,"click",me));if(void 0!==w.timeContainer&&void 0!==w.minuteElement&&void 0!==w.hourElement){var n=function(e){return g(e).select()};P(w.timeContainer,["increment"],_),P(w.timeContainer,"blur",_,{capture:!0}),P(w.timeContainer,"click",H),P([w.hourElement,w.minuteElement],["focus","click"],n),void 0!==w.secondElement&&P(w.secondElement,"focus",(function(){return w.secondElement&&w.secondElement.select()})),void 0!==w.amPM&&P(w.amPM,"click",(function(e){_(e)}))}w.config.allowInput&&P(w._input,"blur",ae)}(),(w.selectedDates.length||w.config.noCalendar)&&(w.config.enableTime&&F(w.config.noCalendar?w.latestSelectedDateObj:void 0),ye(!1)),S();var n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!w.isMobile&&n&&de(),De("onReady")}(),w}function T(e,n){for(var t=Array.prototype.slice.call(e).filter((function(e){return e instanceof HTMLElement})),a=[],i=0;i<t.length;i++){var o=t[i];try{if(null!==o.getAttribute("data-fp-omit"))continue;void 0!==o._flatpickr&&(o._flatpickr.destroy(),o._flatpickr=void 0),o._flatpickr=k(o,n||{}),a.push(o._flatpickr)}catch(e){console.error(e)}}return 1===a.length?a[0]:a}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return T(this,e)},HTMLElement.prototype.flatpickr=function(e){return T([this],e)});var I=function(e,n){return"string"==typeof e?T(window.document.querySelectorAll(e),n):e instanceof Node?T([e],n):T(e,n)};return I.defaultConfig={},I.l10ns={en:e({},i),default:e({},i)},I.localize=function(n){I.l10ns.default=e(e({},I.l10ns.default),n)},I.setDefaults=function(n){I.defaultConfig=e(e({},I.defaultConfig),n)},I.parseDate=C({}),I.formatDate=b({}),I.compareDates=M,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return T(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=I),I}));
var modalSelect = function () {var ms = {};if (ms.$selects === 0) return;ms.generateHTML = function ( $formGroup, $selectBox ) {var $options = $selectBox.find('option');var isHidePreviewImg = $selectBox.data('hide-preview-img') == true;var selectSize = $selectBox.data('select-size') ? $selectBox.data('select-size') : 'regular';var imagesInRowInLine = $selectBox.data('images-in-row') ? $selectBox.data('images-in-row') : null;var $selectedOption = $selectBox.find('option:selected');var title = $formGroup.find('label').text();var id = $selectBox.attr('id') ? $selectBox.attr('id') : '';var disabledTitle = $selectBox.attr('data-disabled-tool-tip') ? $selectBox.attr('data-disabled-tool-tip') : '';if ( title.length === 0 ) title = $selectBox.data('modal-select-title');$selectedOption = ($selectedOption.length === 0) ? $selectBox.find('option:first-child') : $selectedOption;var html = '<div id="'+id+'_modalSelect" class="modal-select-container" title="'+disabledTitle+'">';html += '<a class="m-s-single">';html += '<span>';html += '<img class="m-s-image-small" src="'+$selectedOption.data('img-src')+'">';html += '<span class="m-s-option-text">'+$selectedOption.html()+'</span>';html += '</span>';html += '<div><b></b></div>';html += '</a>'
html += '</div>';var $modalSelect = $(html);if ( isHidePreviewImg ) {$modalSelect.find('img.m-s-image-small').remove();$modalSelect.find('span.m-s-option-text').addClass('m-s-no-preview-img');$selectBox.on('change.updateText', function( event ) {$modalSelect.find('.m-s-option-text.m-s-no-preview-img').text($selectBox.find('option:selected').text());});}
if ( selectSize == 'small' ) {$modalSelect.find('.m-s-single').css('padding','6px');}
$modalSelect.find('a').click(function(){if ( $modalSelect.hasClass('disabled') ) return;$modalSelect.addClass('modal-select-container-active');ms.generateModal($selectBox,$modalSelect,title,imagesInRowInLine);});return $modalSelect;}
ms.generateInlineHTML = function ( $formGroup, $selectBox ) {var $options = $selectBox.find('option');var $selectedOption = $selectBox.find('option:selected');var title = $formGroup.find('label').text();var id = $selectBox.attr('id') ? $selectBox.attr('id') : '';if ( title.length === 0 ) title = $selectBox.data('modal-select-title');$selectedOption = ($selectedOption.length === 0) ? $selectBox.find('option:first-child') : $selectedOption;var html = '<div id="'+id+'_inlineSelect" class="modal-select-inline-container fancy-scrollbar">';$.each($options,function( index, option ) {let $option = $(option);html += '<div class="inlineSelectItem m-s-option-btn '+($selectedOption.val() == $option.val() ? 'active' : '')+'" data-value="'+$option.val()+'">';html += '<img class="m-s-i-img" src="'+$option.data('img-src')+'">';html += '</div>';});html += '</div>';var $modalSelect = $(html);$modalSelect.find('.m-s-option-btn').click(function() {optionSelect($(this),$modalSelect,$selectBox,$modalSelect,'',true);if ( $selectBox.data('pages-settings-select') ) {ms.inlineHTMLChange($(this));}});return $modalSelect;}
ms.inlineHTMLChange = function( $option ) {$("#wizardForm").off('ajaxSuccess').one( 'ajaxSuccess', function( event ) {if ( !IsPreviewAtHomepage() ) {isPreviewReload = true;RefreshPreview();} else {UpdatePreviewAreaByAjax('#s123ModulesContainer',false,false,'');if ( $option.data('section-id') ) {window.scrollPreview = '#section-'+$option.data('section-id');scrollToPointInPreview();}}});AutoSaveWizard(false,true);}
ms.generateModal = function( $selectBox, $modalSelect, title, imagesInRowInLine ) {var $options = $selectBox.find('option');var $imageSwitch = $selectBox.data('image-switch') ? true : false;var isUsingFilter = $selectBox.attr('data-use-filter') && $selectBox.attr('data-use-filter') == 'true';var html = '<div class="row m-s-options">';if ( isUsingFilter ) {html += '<div class="col-xs-12">';html += '<div class="form-group">';html += '<div class="input-group">';html += '<input type="text" id="modalSelectFilter" class="form-control" placeholder="' + translations.search + '"/>';html += '<span class="input-group-addon" data-rel="tooltip" title="' + translations.search + '"><i class="fa fa-search"></i></span>';html += '</div>';html += '</div>';html += '</div>';}
$options.each(function(index,value) {var $option = $(value);html += '<div class="modal-select-option-container col-xs-12 '+($options.length < 2 ? 'col-sm-4' : ( $.isNumeric(imagesInRowInLine) ? 'col-sm-'+(12 / imagesInRowInLine) : 'col-sm-6') )+'"' + (isUsingFilter ? ' data-filter="'+$option.text().toLowerCase()+'"' : '') + '">';html += '<div class="m-s-option-btn'+($option.prop('selected') ? ' active' : '')+'" data-value="'+$option.val()+'">';if ( $option.text().length > 0 ) {html += '<p>'+$option.text()+'</p>';}
if ( $imageSwitch ) {html += '<div class="image-switch-container">';html += '<div class="image-switch">';html += '<img class="first-image" src="'+$option.data('img-src')+'"> ';html += '</div>';html += '<div class="image-switch second-image">';html += '<img src="'+$option.data('second-img-src')+'">';html += '</div>';html += '</div>';} else {html += '<img src="'+$option.data('img-src')+'">';}
html += '</div>';html += '</div>';});html += '</div>';var $html = $(html);var $dialog = bootbox.dialog({title: title,message: html,backdrop: true,className: 's123-modal system-modal',onEscape: function(){$modalSelect.removeClass('modal-select-container-active');}}).on('shown.bs.modal', function() {$(this).attr('aria-hidden',null);});;$dialog.init(function(){$dialog.prop('id','modalSelect');$dialog.find('.modal-body').css('max-height',window.innerHeight-200).css('overflow-y','auto');if ( $selectBox.data('modal-size') ) {$dialog.find('.modal-dialog').addClass($selectBox.data('modal-size'));}
if ( $selectBox.data('image-size') ) {$dialog.find('img').css('width',$selectBox.data('image-size')).css('height',$selectBox.data('image-size'));} else if ( $selectBox.data('image-fit') ) {$dialog.find('img').css('height','auto').css('width','100%').css('object-fit','contain');} else if ( $selectBox.data('image-height') || $selectBox.data('image-width')) {if ( $selectBox.data('image-width') && !$selectBox.data('image-height') ) {$dialog.find('img').css('width',$selectBox.data('image-width')).css('height','auto');} else if ( $selectBox.data('image-height') && !$selectBox.data('image-width') ) {$dialog.find('img').css('width','100%').css('height',$selectBox.data('image-height'));} else {$dialog.find('img').css('width',$selectBox.data('image-width')).css('height',$selectBox.data('image-height'));}}
$dialog.find('.m-s-option-btn').click(function() {optionSelect($(this),$html,$selectBox,$modalSelect,$dialog,false);});$dialog.find('#modalSelectFilter').off('input').on('input', function() {var filterValue = $(this).val().toLowerCase();$dialog.find('.modal-select-option-container').show();if ( filterValue.length == 0 ) return;$dialog.find('.modal-select-option-container:not([data-filter*="' + filterValue + '"])').hide();});});};function optionSelect( $button, $html, $selectBox, $modalSelect, $dialog, inline ) {$html.find('.m-s-option-btn').removeClass('active');$selectBox.val($button.data('value'));$button.addClass('active');if (!inline) {$modalSelect.find('.m-s-single img').prop('src',$button.find('img').prop('src'));$modalSelect.find('.m-s-single .m-s-option-text').html($button.find('p').html());$modalSelect.removeClass('modal-select-container-active');$selectBox.trigger('modal-select-click');}
$selectBox.trigger('change');if (!inline) $dialog.modal('hide');}
ms.init = function() {ms.$selects = $('select.modal-select:not([data-modal-select-initialized="true"])');ms.$selects.each(function(index,value) {var $selectBox = $(value);var $formGroup = $selectBox.closest('.form-group');$selectBox.hide();if ( $selectBox.data('inline-select')) {$formGroup.append(ms.generateInlineHTML($formGroup,$selectBox));} else {$formGroup.append(ms.generateHTML($formGroup,$selectBox));}
$selectBox.attr('data-modal-select-initialized',true);});};return ms;}();modalSelect.init();
var SystemModals = function() {const _ = {openedModals: [] // array that is used to detect what is the order of the opened modals
};_.sm_init = function(elements) {if ( !topWindow.sysModals ) topWindow.sysModals = {};let $root = elements.length > 0 ? $(elements) : $(document);$root.find('.sm-controller').each(function() {const $controller = $(this);$controller.attr('data-target',`#${$controller.data('sm-id')}`);if ( $controller.data('sm-manual-render') ) return;const type = $controller.data('sm-type') ? $controller.data('sm-type') : 1;const settings = getModalSettingsType(type,$controller);multiInithandler($controller);_.sm_render(settings);});$root.find('.sm-settings').each(function() {let $controller = $(this);const type = $controller.data('sm-type') ? $controller.data('sm-type') : 2;const settings = getModalSettingsType(type,$controller);multiInithandler($controller);_.sm_render(settings);if ( $controller.data('sm-remove-oninit') !== false ) {$controller.remove();}});$root.find('.sm-controller[data-sm-mode]').on('click', function( event ) {event.preventDefault();const $controller = $(this);const modal = _.sm_get($controller.data('sm-id'));if ( $controller.data('sm-no-backdrop') == true ) {_.sm_updateProp($controller.data('sm-id'),'backdrop',false);}
if ( $controller.data('sm-width') ) {_.sm_updateProp($controller.data('sm-id'),'width',$controller.data('sm-width'));}
const eventID = _.sm_eventReg($controller.data('sm-id'),'hidden', function() {modal.$html.removeClass($controller.data('sm-mode'));_.sm_updateProp($controller.data('sm-id'),'backdrop',true);_.sm_updateProp($controller.data('sm-id'),'width','');_.sm_eventRemove($controller.data('sm-id'),'hidden',eventID);});if ( $controller.data('sm-parent') == 'topWindowBody' || $controller.data('sm-parent') == 'parentBody' ) {modal.show();}});(function() {$(document).off('show.bs.modal.systemModals_addItemHandler').on('show.bs.modal.systemModalssystemModals_addItemHandlerHandler','.modal', function() {if ( !window.location.pathname.includes('addItem.php') ) return;const windowWidth = parseInt(window.getComputedStyle(document.documentElement).getPropertyValue('--window-width'));if ( windowWidth > 768 ) return;let $modal = $(this);$('.SubmitButtonsArea').hide();$modal.on('hide.bs.modal.systemModals_addItemHandler', function() {$('.SubmitButtonsArea').show();$modal.off('hide.bs.modal.systemModals_addItemHandler');});});})();function multiInithandler( $controller ) {if ( $controller.data('sm-content-selector') ) {let $content = $($controller.data('sm-content-selector'));$content.addClass('hidden');$('body').append($content);}}};_.sm_render = function( settings ) {if ( typeof settings.bodySettings.isActive  == 'undefined' ) settings.bodySettings.isActive = true;if ( typeof settings.headerSettings.isActive  == 'undefined' ) settings.headerSettings.isActive = true;_.sm_destroy(settings.id);topWindow.sysModals[settings.id] = new Modal({id: settings.id,disposable: settings.disposable, // removes html on hide
$parent: settings.$parent, // where to append
mode: settings.mode ? settings.mode : 'normal', // normal, offcanvas
offCanvasDirection: settings.offCanvasDirection,sizeClasses: settings.sizeClasses, // modal size classes
closeOnEscape: settings.closeOnEscape ? settings.closeOnEscape : true, // close modal on escape key
headerSettings: { // header settings
isActive: settings.headerSettings.isActive,id: settings.headerSettings.id,title: settings.headerSettings.title},bodySettings: { // body settings
isActive: settings.headerSettings.isActive,id: settings.bodySettings.id,content: settings.bodySettings.content},footerSettings: { // footer settings
isActive: settings.footerSettings.isActive,buttons: [...settings.footerSettings.buttons]},showCallback: settings.showCallback,shownCallback: settings.shownCallback,hideCallback: settings.hideCallback,hiddenCallback: settings.hiddenCallback,initializeCallback: settings.initializeCallback});return topWindow.sysModals[settings.id];};_.sm_destroy = function( modalID ) {if ( !topWindow.sysModals[modalID] ) return;topWindow.sysModals[modalID].destroy();delete topWindow.sysModals[modalID];};_.sm_get = function( modalID ) {if ( !topWindow.sysModals[modalID] ) return;return topWindow.sysModals[modalID];};_.sm_show = function( modalID ) {if ( !topWindow.sysModals[modalID] ) return;topWindow.sysModals[modalID].show();};_.sm_hide = function( modalID ) {if ( !topWindow.sysModals[modalID] ) return;topWindow.sysModals[modalID].hide();};_.sm_remove = function( modalID ) {topWindow.sysModals[modalID].$html.remove();delete topWindow.sysModals[modalID];};_.sm_eventReg = function( modalID, type, func ) {if ( !topWindow.sysModals[modalID] ) return;return topWindow.sysModals[modalID].eventReg(type,func);};_.sm_eventRemove = function( modalID, type, eventID ) {if ( !topWindow.sysModals[modalID] ) return;topWindow.sysModals[modalID].eventRemove(type,eventID);};_.sm_updateProp = function( modalID, type, value ) {if ( !topWindow.sysModals[modalID] ) return;topWindow.sysModals[modalID].updateProp(type,value);};_.sm_updateHTML = function( modalID, type, newHTML ) {if ( !topWindow.sysModals[modalID] ) return;topWindow.sysModals[modalID].updateHTML(type,newHTML);};_.sm_closeAllModals = function() {$.each(SystemModals.openedModals, ( index, modalID ) => {_.sm_hide(modalID);});};function getModalSettingsType( settingsType, $controller ) {let settings = {};switch( settingsType ) {case 1:settings = {id: '',disposable: false,$parent: $('body'),mode: $controller.data('sm-mode') ? $controller.data('sm-mode') : 'normal',offCanvasDirection: $controller.data('sm-offcanvas-direction'),sizeClasses: 'size-l3',closeOnEscape: $controller.data('sm-close-on-escape') ? $controller.data('sm-close-on-escape') : true,headerSettings: {isActive: typeof $controller.data('sm-header-active') != 'undefined' ? $controller.data('sm-header-active') : true,id: '',title: '&nbsp;'},bodySettings: {isActive: typeof $controller.data('sm-body-active') != 'undefined' ?  $controller.data('sm-body-active') : true,id: '',content: '&nbsp;'},footerSettings: {isActive: $controller.data('sm-footer-buttons') ? true : false,buttons: $controller.data('sm-footer-buttons') ? $controller.data('sm-footer-buttons') : []},showCallback: function ( event, modal ) {const id = $controller.data('sm-iframe-id') ? $controller.data('sm-iframe-id') : `${$controller.data('sm-id')}Window`;const src = $controller.data('sm-iframe-src') ? $controller.data('sm-iframe-src') : '';let classList = $controller.data('sm-iframe-class') ? $controller.data('sm-iframe-class') : '';const style = $controller.data('sm-iframe-style') ? $controller.data('sm-iframe-style') : '';if ( typeof $controller.data('sm-iframe-auto-height') == 'undefined' || $controller.data('sm-iframe-auto-height') == 'true' ) {classList += ' sm-auto-height';}
modal.updateHTML('body',`<iframe id="${id}" src="${src}" style="${style}" class="${classList}"></iframe>`);},hideCallback: function ( event, modal ) {const reload = $controller.data('sm-reload-onhide') ? $controller.data('sm-reload-onhide') : false;if ( reload ) {location.reload();}},initializeCallback: function () {},shownCallback: function ( event, modal ) {$('.modal-backdrop').on('click', function () {_.sm_get($controller.data('sm-id')).hide();});}};break;case 2:settings = {id: '',disposable: false,$parent: $('body'),mode: $controller.data('sm-mode') ? $controller.data('sm-mode') : 'normal',offCanvasDirection: $controller.data('sm-offcanvas-direction'),sizeClasses: '',closeOnEscape: $controller.data('sm-close-on-escape') ? $controller.data('sm-close-on-escape') : true,headerSettings: {isActive: typeof $controller.data('sm-header-active') != 'undefined' ? $controller.data('sm-header-active') : true,id: '',title: '&nbsp;'},bodySettings: {isActive: typeof $controller.data('sm-body-active') != 'undefined' ? $controller.data('sm-body-active') : true,id: '',content: ''},footerSettings: {isActive: $controller.data('sm-footer-buttons') ? true : false,buttons: $controller.data('sm-footer-buttons') ? $controller.data('sm-footer-buttons') : []},initializeCallback: function ( $modal ) {if ( $controller.data('sm-content-selector') ) {let $content = $($controller.data('sm-content-selector'));$content.removeClass('hidden');if ( $modal.find('.modal-content .modal-body').length > 0 ) {$content.addClass('widget-main');$modal.find('.modal-content .modal-body').append($content);} else {$content.addClass('modal-body');$modal.find('.modal-content').append($content);}}},showCallback: function ( event, modal ) {},hideCallback: function ( event, modal ) {},shownCallback: function ( event, modal ) {$('.modal-backdrop').on('click', function () {_.sm_get($controller.data('sm-id')).hide();});}};break;}
settings.id = $controller.data('sm-id') ? $controller.data('sm-id') : uniqid('modal-');settings.headerSettings.id = `${settings.id}Title`;settings.bodySettings.id = `${settings.id}Body`;if ( $controller.data('sm-title') ) {settings.headerSettings.title = $controller.data('sm-title');}
if ( $controller.data('sm-size') ) {if ( $controller.data('sm-mode') != 'offcanvas' && $controller.data('sm-mode') != 'sideOffcanvasReverse' ) {settings.sizeClasses = `size-${$controller.data('sm-size')}`;} else {settings.sizeClasses = $controller.data('sm-size');}}
if ( $controller.data('sm-parent') ) {switch ( $controller.data('sm-parent') ) {case 'topWindowBody':settings.$parent = $(topWindow.document.body);break;case 'windowBody':settings.$parent = $('body');break;case 'parentBody':settings.$parent = parent.$('body');break;}}
return settings;}
function uniqid(prefix, more_entropy) {if ( typeof prefix === 'undefined' ) {prefix = '';}
var retId;var formatSeed = function( seed, reqWidth ) {seed = parseInt(seed, 10)
.toString(16); // to hex str
if ( reqWidth < seed.length ) { // so long we split
return seed.slice(seed.length - reqWidth);}
if ( reqWidth > seed.length ) { // so short we pad
return Array(1 + (reqWidth - seed.length))
.join('0') + seed;}
return seed;};if (!window.php_js) {window.php_js = {};}
if (!window.php_js.uniqidSeed) { // init seed with big random int
window.php_js.uniqidSeed = Math.floor(Math.random() * 0x75bcd15);}
window.php_js.uniqidSeed++;retId = prefix; // start with prefix, add current milliseconds hex string
retId += formatSeed(parseInt(new Date()
.getTime() / 1000, 10), 8);retId += formatSeed(window.php_js.uniqidSeed, 5); // add seed hex string
if ( more_entropy ) {retId += (Math.random() * 10)
.toFixed(8)
.toString();}
return retId;}
class Modal {id = '';disposable = false;$parent = $('body');headerSettings = {};bodySettings = {};footerSettings = {};$html = null;showCallback = {};shownCallback = {};hideCallback = {};hiddenCallback = {};constructor( settings ) {this.id = settings.id;this.disposable = settings.disposable;this.$parent = settings.$parent;this.sizeClasses = settings.sizeClasses;this.mode = settings.mode;this.closeOnEscape = settings.closeOnEscape;this.offCanvasDirection = settings.offCanvasDirection;this.headerSettings = settings.headerSettings;this.bodySettings = settings.bodySettings;this.footerSettings = settings.footerSettings;this.render();if ( settings.showCallback ) {this.eventReg('show',settings.showCallback);}
if ( settings.shownCallback ) {this.eventReg('shown',settings.shownCallback);}
if ( settings.hideCallback ) {this.eventReg('hide',settings.hideCallback);}
if ( settings.hiddenCallback ) {this.eventReg('hidden',settings.hiddenCallback);}
if ( settings.initializeCallback ) {settings.initializeCallback.call(this,this.$html);}
this.$html.on('show.bs.modal.SystemModals', ( event ) => {$.each(this.showCallback, ( eventID, func ) => {func.call(this,event,this);});SystemModals.openedModals.push(this.id);if ( this.closeOnEscape ) {this.registedOnEscape();}
let $openedModals = this.$parent.closest('body').find('.s123-modal.in,.modal:not(.s123-modal).in');if ( !this.$backdrop ) {this.$backdrop = this.$parent.find('.modal-backdrop[data-modal-id="' + this.id + '"]');}
if ( this.$backdrop.length == 0 ) {this.$backdrop = $('<div data-modal-id="' + this.id + '" class="modal-backdrop fade"></div>');}
this.$html.off('click').on('click', (e) => {e.stopPropagation();if ( $(e.target).attr('data-dismiss') == 'modal' ) return;if ( $(e.target).closest('.modal-content').length > 0 ) return;this.hide();});this.$parent.append(this.$backdrop);if ( $openedModals.length > 0 ) {let highestZIndex = 0;$openedModals.each(function() {const currentZIndex = parseInt(window.getComputedStyle(this).getPropertyValue('z-index'));if ( !isNaN(currentZIndex) && currentZIndex > highestZIndex ) {highestZIndex = currentZIndex;}});this.$html.css('z-index', highestZIndex + 2);this.$backdrop.css('z-index', highestZIndex + 1);}
setTimeout(() => {this.$backdrop.addClass('in');}, 0);})
.on('shown.bs.modal.SystemModals', ( event ) => {$.each(this.shownCallback, ( eventID, func ) => {func.call(this,event,this);});})
.on('hide.bs.modal.SystemModals', ( event ) => {$.each(this.hideCallback, ( eventID, func ) => {func.call(this,event,this);});if ( !this.isKeepBackdrop && this.$backdrop ) {this.$backdrop.removeClass('in');}})
.on('hidden.bs.modal.SystemModals', ( event ) => {$.each(this.hiddenCallback, ( eventID, func ) => {func.call(this,event,this);});this.dropOnEscape();SystemModals.openedModals = SystemModals.openedModals.filter(modalId => modalId !== this.id);if ( this.$backdrop ) {this.$backdrop.remove();delete this.$backdrop;}});}
render() {this.$html = $(`
<div class="modal s123-modal fade system-modal ${this.sizeClasses}" data-mode="${this.mode}" ${this.offCanvasDirection ? `data-offcanvas-direction="${this.offCanvasDirection}"` : ''} id="${this.id}" role="dialog" aria-labelledby="${this.id}" data-backdrop="false">
<div class="modal-dialog" role="document">
<div class="modal-content">
${this.getHeader()}
${this.getBody()}
${(() => {if ( !this.footerSettings.isActive ) return '';return `
<div class="modal-footer">
${(() => {let html = '';$.each(this.footerSettings.buttons, function(key, button) {if ( !button.dataAttr ) button.dataAttr = '';if ( button.href ) {html += `<a href="${button.href}" class="${button.class}" ${button.dataAttr}>${button.text}</a>`;} else {html += `<button type="button" class="${button.class}" ${button.dataAttr}>${button.text}</button>`;}});return html;})()}
</div>`;})()}
</div>
</div>
</div>`);this.$parent.append(this.$html);}
destroy() {this.$html.remove();this.showCallback = {};this.shownCallback = {};this.hideCallback = {};this.hiddenCallback = {};}
getHeader() {if ( !this.headerSettings.isActive ) return '';return `
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 id="${this.headerSettings.id}" class="modal-title">${this.headerSettings.title}</h4>
</div>`;}
getBody() {if ( !this.bodySettings.isActive ) return '';return `
<div id="${this.bodySettings.id}" class="modal-body">
${this.bodySettings.content}
</div>`;}
show() {this.$html.modal('show');}
hide() {this.$html.modal('hide');}
eventReg( type, func ) {const eventID = uniqid('event-');switch( type ) {case 'show':this.showCallback[eventID] = func;break;case 'shown':this.shownCallback[eventID] = func;break;case 'hide':this.hideCallback[eventID] = func;break;case 'hidden':this.hiddenCallback[eventID] = func;break;}
return eventID;}
eventRemove( type, eventID ) {switch( type ) {case 'show':delete this.showCallback[eventID];break;case 'shown':delete this.shownCallback[eventID];break;case 'hide':delete this.hideCallback[eventID];break;case 'hidden':delete this.hiddenCallback[eventID];break;}}
setWidth( size ) {this.$html.removeClass('size-l1 size-l2 size-s1 size-m1');this.$html.addClass(`size-${size}`);}
updateProp( type, value ) {switch( type ) {case 'backdrop':this.$html.attr('data-backdrop',value);if ( this.$html.data('bs.modal') ) {this.$html.data('bs.modal').options.backdrop = value;}
break;case 'width':this.$html.css('width',value);break;case 'footer':switch (value) {case 'visible':this.$html.find('.modal-footer').removeClass('hidden');break;case 'hidden':this.$html.find('.modal-footer').addClass('hidden');break;}
break;case 'parent':switch (value) {case 'topWindowBody':this.$parent = $(topWindow.document.body);break;case 'windowBody':this.$parent = $(document.body);break;}
$(this.$html).appendTo(this.$parent);break;}}
updateHTML( type, newHTML ) {switch( type ) {case 'title':this.$html.find(`#${this.headerSettings.id}`).html(newHTML);break;case 'body':this.$html.find('.modal-body').html(newHTML);break;}}
registedOnEscape() {let $iframe = this.$html.find('iframe');if ( $iframe.length > 0 ) {$iframe.off(`load.systemModals.${this.id}.closeOnEscape`).on(`load.systemModals.${this.id}.closeOnEscape`, (e) => {if ( !$iframe.get(0).contentWindow.$ ) return;this.$frameDocument = $iframe.get(0).contentWindow.$($iframe.get(0).contentWindow.document);this.$frameDocument.on(`keydown.systemModals.${this.id}.closeOnEscape`, (e) => {if ( e.which == 27 ) {if ( SystemModals.openedModals[SystemModals.openedModals.length - 1] === this.id ) {this.hide();}}});addFocusHelper(this);});} else {addFocusHelper(this);}
$(document).on(`keydown.systemModals.${this.id}.closeOnEscape`, (e) => {if ( e.which == 27 ) {if ( SystemModals.openedModals[SystemModals.openedModals.length - 1] === this.id ) {this.hide();}}});function addFocusHelper( modal ) {let $helper = $('<input type="text" class="on-escape-helper"/>');modal.$html.find('.modal-body').append($helper);$helper.focus();}}
dropOnEscape() {$(document).off(`keydown.systemModals.${this.id}.closeOnEscape`);if ( this.$frameDocument ) {this.$frameDocument.off(`keydown.systemModals.${this.id}.closeOnEscape`);delete this.$frameDocument;}
this.$html.find('.on-escape-helper').remove();}}
_.sm_init('');return _;}();
/* ========================================================================
 * bootstrap-tour - v0.10.2
 * http://bootstraptour.com
 * ========================================================================
 * Copyright 2012-2015 Ulrich Sossou
 *
 * ========================================================================
 * Licensed under the MIT License (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://opensource.org/licenses/MIT
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================================
 */

!function(t,e){var o,n;return n=e.document,o=function(){function o(o){var n;try{n=e.localStorage}catch(r){n=!1}this._options=t.extend({name:"tour",steps:[],container:"body",autoscroll:!0,keyboard:!0,storage:n,debug:!1,backdrop:!1,backdropContainer:"body",backdropPadding:0,redirect:!0,orphan:!1,duration:!1,delay:!1,basePath:"",template:'<div class="popover" role="tooltip"> <div class="arrow"></div> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation"> <div class="btn-group"> <button class="btn btn-sm btn-default" data-role="prev">&laquo; Prev</button> <button class="btn btn-sm btn-default" data-role="next">Next &raquo;</button> <button class="btn btn-sm btn-default" data-role="pause-resume" data-pause-text="Pause" data-resume-text="Resume">Pause</button> </div> <button class="btn btn-sm btn-default" data-role="end">End tour</button> </div> </div>',afterSetState:function(){},afterGetState:function(){},afterRemoveState:function(){},onStart:function(){},onEnd:function(){},onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){},onNext:function(){},onPrev:function(){},onPause:function(){},onResume:function(){},onRedirectError:function(){}},o),this._force=!1,this._inited=!1,this._current=null,this.backdrop={overlay:null,$element:null,$background:null,backgroundShown:!1,overlayElementShown:!1}}return o.prototype.addSteps=function(t){var e,o,n;for(o=0,n=t.length;n>o;o++)e=t[o],this.addStep(e);return this},o.prototype.addStep=function(t){return this._options.steps.push(t),this},o.prototype.getStep=function(e){return null!=this._options.steps[e]?t.extend({id:"step-"+e,path:"",host:"",placement:"right",title:"",content:"<p></p>",next:e===this._options.steps.length-1?-1:e+1,prev:e-1,animation:!0,container:this._options.container,autoscroll:this._options.autoscroll,backdrop:this._options.backdrop,backdropContainer:this._options.backdropContainer,backdropPadding:this._options.backdropPadding,redirect:this._options.redirect,reflexElement:this._options.steps[e].element,orphan:this._options.orphan,duration:this._options.duration,delay:this._options.delay,template:this._options.template,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume,onRedirectError:this._options.onRedirectError},this._options.steps[e]):void 0},o.prototype.init=function(t){return this._force=t,this.ended()?(this._debug("Tour ended, init prevented."),this):(this.setCurrentStep(),this._initMouseNavigation(),this._initKeyboardNavigation(),this._onResize(function(t){return function(){return t.showStep(t._current)}}(this)),null!==this._current&&this.showStep(this._current),this._inited=!0,this)},o.prototype.start=function(t){var e;return null==t&&(t=!1),this._inited||this.init(t),null===this._current&&(e=this._makePromise(null!=this._options.onStart?this._options.onStart(this):void 0),this._callOnPromiseDone(e,this.showStep,0)),this},o.prototype.next=function(){var t;return t=this.hideStep(this._current),this._callOnPromiseDone(t,this._showNextStep)},o.prototype.prev=function(){var t;return t=this.hideStep(this._current),this._callOnPromiseDone(t,this._showPrevStep)},o.prototype.goTo=function(t){var e;return e=this.hideStep(this._current),this._callOnPromiseDone(e,this.showStep,t)},o.prototype.end=function(){var o,r;return o=function(o){return function(){return t(n).off("click.tour-"+o._options.name),t(n).off("keyup.tour-"+o._options.name),t(e).off("resize.tour-"+o._options.name),o._setState("end","yes"),o._inited=!1,o._force=!1,o._clearTimer(),null!=o._options.onEnd?o._options.onEnd(o):void 0}}(this),r=this.hideStep(this._current),this._callOnPromiseDone(r,o)},o.prototype.ended=function(){return!this._force&&!!this._getState("end")},o.prototype.restart=function(){return this._removeState("current_step"),this._removeState("end"),this._removeState("redirect_to"),this.start()},o.prototype.pause=function(){var t;return t=this.getStep(this._current),t&&t.duration?(this._paused=!0,this._duration-=(new Date).getTime()-this._start,e.clearTimeout(this._timer),this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining)."),null!=t.onPause?t.onPause(this,this._duration):void 0):this},o.prototype.resume=function(){var t;return t=this.getStep(this._current),t&&t.duration?(this._paused=!1,this._start=(new Date).getTime(),this._duration=this._duration||t.duration,this._timer=e.setTimeout(function(t){return function(){return t._isLast()?t.next():t.end()}}(this),this._duration),this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration),null!=t.onResume&&this._duration!==t.duration?t.onResume(this,this._duration):void 0):this},o.prototype.hideStep=function(e){var o,n,r;return(r=this.getStep(e))?(this._clearTimer(),n=this._makePromise(null!=r.onHide?r.onHide(this,e):void 0),o=function(o){return function(){var n;return n=t(r.element),n.data("bs.popover")||n.data("popover")||(n=t("body")),n.popover("destroy").removeClass("tour-"+o._options.name+"-element tour-"+o._options.name+"-"+e+"-element"),n.removeData("bs.popover"),r.reflex&&t(r.reflexElement).removeClass("tour-step-element-reflex").off(""+o._reflexEvent(r.reflex)+".tour-"+o._options.name),r.backdrop&&o._hideBackdrop(),null!=r.onHidden?r.onHidden(o):void 0}}(this),this._callOnPromiseDone(n,o),n):void 0},o.prototype.showStep=function(t){var o,r,i,s;return this.ended()?(this._debug("Tour ended, showStep prevented."),this):(s=this.getStep(t))?(i=t<this._current,o=this._makePromise(null!=s.onShow?s.onShow(this,t):void 0),r=function(e){return function(){var o,r;if(e.setCurrentStep(t),o=function(){switch({}.toString.call(s.path)){case"[object Function]":return s.path();case"[object String]":return this._options.basePath+s.path;default:return s.path}}.call(e),!e._isRedirect(s.host,o,n.location)||(e._redirect(s,t,o),e._isJustPathHashDifferent(s.host,o,n.location))){if(e._isOrphan(s)){if(s.orphan===!1)return e._debug("Skip the orphan step "+(e._current+1)+".\nOrphan option is false and the element does not exist or is hidden."),i?e._showPrevStep():e._showNextStep(),void 0;e._debug("Show the orphan step "+(e._current+1)+". Orphans option is true.")}return s.backdrop&&e._showBackdrop(s),r=function(){return e.getCurrentStep()!==t||e.ended()?void 0:(null!=s.element&&s.backdrop&&e._showOverlayElement(s),e._showPopover(s,t),null!=s.onShown&&s.onShown(e),e._debug("Step "+(e._current+1)+" of "+e._options.steps.length))},s.autoscroll?e._scrollIntoView(s.element,r):r(),s.duration?e.resume():void 0}}}(this),s.delay?(this._debug("Wait "+s.delay+" milliseconds to show the step "+(this._current+1)),e.setTimeout(function(t){return function(){return t._callOnPromiseDone(o,r)}}(this),s.delay)):this._callOnPromiseDone(o,r),o):void 0},o.prototype.getCurrentStep=function(){return this._current},o.prototype.setCurrentStep=function(t){return null!=t?(this._current=t,this._setState("current_step",t)):(this._current=this._getState("current_step"),this._current=null===this._current?null:parseInt(this._current,10)),this},o.prototype.redraw=function(){return this._showOverlayElement(this.getStep(this.getCurrentStep()).element,!0)},o.prototype._setState=function(t,e){var o,n;if(this._options.storage){n=""+this._options.name+"_"+t;try{this._options.storage.setItem(n,e)}catch(r){o=r,o.code===DOMException.QUOTA_EXCEEDED_ERR&&this._debug("LocalStorage quota exceeded. State storage failed.")}return this._options.afterSetState(n,e)}return null==this._state&&(this._state={}),this._state[t]=e},o.prototype._removeState=function(t){var e;return this._options.storage?(e=""+this._options.name+"_"+t,this._options.storage.removeItem(e),this._options.afterRemoveState(e)):null!=this._state?delete this._state[t]:void 0},o.prototype._getState=function(t){var e,o;return this._options.storage?(e=""+this._options.name+"_"+t,o=this._options.storage.getItem(e)):null!=this._state&&(o=this._state[t]),(void 0===o||"null"===o)&&(o=null),this._options.afterGetState(t,o),o},o.prototype._showNextStep=function(){var t,e,o;return o=this.getStep(this._current),e=function(t){return function(){return t.showStep(o.next)}}(this),t=this._makePromise(null!=o.onNext?o.onNext(this):void 0),this._callOnPromiseDone(t,e)},o.prototype._showPrevStep=function(){var t,e,o;return o=this.getStep(this._current),e=function(t){return function(){return t.showStep(o.prev)}}(this),t=this._makePromise(null!=o.onPrev?o.onPrev(this):void 0),this._callOnPromiseDone(t,e)},o.prototype._debug=function(t){return this._options.debug?e.console.log("Bootstrap Tour '"+this._options.name+"' | "+t):void 0},o.prototype._isRedirect=function(t,e,o){var n;return""!==t&&this._isHostDifferent(t,o.href)?!0:(n=[o.pathname,o.search,o.hash].join(""),null!=e&&""!==e&&("[object RegExp]"==={}.toString.call(e)&&!e.test(n)||"[object String]"==={}.toString.call(e)&&this._isPathDifferent(e,n)))},o.prototype._isHostDifferent=function(t,e){return this._getProtocol(t)!==this._getProtocol(e)||this._getHost(t)!==this._getHost(e)},o.prototype._isPathDifferent=function(t,e){return this._getPath(t)!==this._getPath(e)||!this._equal(this._getQuery(t),this._getQuery(e))||!this._equal(this._getHash(t),this._getHash(e))},o.prototype._isJustPathHashDifferent=function(t,e,o){var n;return""!==t&&this._isHostDifferent(t,o.href)?!1:(n=[o.pathname,o.search,o.hash].join(""),"[object String]"==={}.toString.call(e)?this._getPath(e)===this._getPath(n)&&this._equal(this._getQuery(e),this._getQuery(n))&&!this._equal(this._getHash(e),this._getHash(n)):!1)},o.prototype._redirect=function(e,o,r){if(t.isFunction(e.redirect))return e.redirect.call(this,r);if(e.redirect===!0){if(this._debug("Redirect to "+e.host+r),this._getState("redirect_to")!==""+o)return this._setState("redirect_to",""+o),n.location.href=""+e.host+r;if(this._debug("Error redirection loop to "+r),this._removeState("redirect_to"),null!=e.onRedirectError)return e.onRedirectError(this)}},o.prototype._isOrphan=function(e){return null==e.element||!t(e.element).length||t(e.element).is(":hidden")&&"http://www.w3.org/2000/svg"!==t(e.element)[0].namespaceURI},o.prototype._isLast=function(){return this._current<this._options.steps.length-1},o.prototype._showPopover=function(e,o){var n,r,i,s,a;return t(".tour-"+this._options.name).remove(),s=t.extend({},this._options),i=this._isOrphan(e),e.template=this._template(e,o),i&&(e.element="body",e.placement="top"),n=t(e.element),n.addClass("tour-"+this._options.name+"-element tour-"+this._options.name+"-"+o+"-element"),e.options&&t.extend(s,e.options),e.reflex&&!i&&t(e.reflexElement).addClass("tour-step-element-reflex").off(""+this._reflexEvent(e.reflex)+".tour-"+this._options.name).on(""+this._reflexEvent(e.reflex)+".tour-"+this._options.name,function(t){return function(){return t._isLast()?t.next():t.end()}}(this)),a=e.smartPlacement===!0&&-1===e.placement.search(/auto/i),n.popover({placement:a?"auto "+e.placement:e.placement,trigger:"manual",title:e.title,content:e.content,html:!0,animation:e.animation,container:e.container,template:e.template,selector:e.element}).popover("show"),r=n.data("bs.popover")?n.data("bs.popover").tip():n.data("popover").tip(),r.attr("id",e.id),this._reposition(r,e),i?this._center(r):void 0},o.prototype._template=function(e,o){var n,r,i,s,a,p;return p=e.template,this._isOrphan(e)&&"[object Boolean]"!=={}.toString.call(e.orphan)&&(p=e.orphan),a=t.isFunction(p)?t(p(o,e)):t(p),n=a.find(".popover-navigation"),i=n.find('[data-role="prev"]'),r=n.find('[data-role="next"]'),s=n.find('[data-role="pause-resume"]'),this._isOrphan(e)&&a.addClass("orphan"),a.addClass("tour-"+this._options.name+" tour-"+this._options.name+"-"+o),e.reflex&&a.addClass("tour-"+this._options.name+"-reflex"),e.prev<0&&(i.addClass("disabled"),i.prop("disabled",!0)),e.next<0&&(r.addClass("disabled"),r.prop("disabled",!0)),e.duration||s.remove(),a.clone().wrap("<div>").parent().html()},o.prototype._reflexEvent=function(t){return"[object Boolean]"==={}.toString.call(t)?"click":t},o.prototype._reposition=function(e,o){var r,i,s,a,p,u,h;if(a=e[0].offsetWidth,i=e[0].offsetHeight,h=e.offset(),p=h.left,u=h.top,r=t(n).outerHeight()-h.top-e.outerHeight(),0>r&&(h.top=h.top+r),s=t("html").outerWidth()-h.left-e.outerWidth(),0>s&&(h.left=h.left+s),h.top<0&&(h.top=0),h.left<0&&(h.left=0),e.offset(h),"bottom"===o.placement||"top"===o.placement){if(p!==h.left)return this._replaceArrow(e,2*(h.left-p),a,"left")}else if(u!==h.top)return this._replaceArrow(e,2*(h.top-u),i,"top")},o.prototype._center=function(o){return o.css("top",t(e).outerHeight()/2-o.outerHeight()/2)},o.prototype._replaceArrow=function(t,e,o,n){return t.find(".arrow").css(n,e?50*(1-e/o)+"%":"")},o.prototype._scrollIntoView=function(o,n){var r,i,s,a,p,u;return r=t(o),r.length?(i=t(e),a=r.offset().top,u=i.height(),p=Math.max(0,a-u/2),this._debug("Scroll into view. ScrollTop: "+p+". Element offset: "+a+". Window height: "+u+"."),s=0,t("body, html").stop(!0,!0).animate({scrollTop:Math.ceil(p)},function(t){return function(){return 2===++s?(n(),t._debug("Scroll into view.\nAnimation end element offset: "+r.offset().top+".\nWindow height: "+i.height()+".")):void 0}}(this))):n()},o.prototype._onResize=function(o,n){return t(e).on("resize.tour-"+this._options.name,function(){return clearTimeout(n),n=setTimeout(o,100)})},o.prototype._initMouseNavigation=function(){var e;return e=this,t(n).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']",function(t){return function(e){return e.preventDefault(),t.next()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']",function(t){return function(e){return e.preventDefault(),t.prev()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']",function(t){return function(e){return e.preventDefault(),t.end()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']",function(o){var n;return o.preventDefault(),n=t(this),n.text(e._paused?n.data("pause-text"):n.data("resume-text")),e._paused?e.resume():e.pause()})},o.prototype._initKeyboardNavigation=function(){return this._options.keyboard?t(n).on("keyup.tour-"+this._options.name,function(t){return function(e){if(e.which)switch(e.which){case 39:return e.preventDefault(),t._isLast()?t.next():t.end();case 37:if(e.preventDefault(),t._current>0)return t.prev();break;case 27:return e.preventDefault(),t.end()}}}(this)):void 0},o.prototype._makePromise=function(e){return e&&t.isFunction(e.then)?e:null},o.prototype._callOnPromiseDone=function(t,e,o){return t?t.then(function(t){return function(){return e.call(t,o)}}(this)):e.call(this,o)},o.prototype._showBackdrop=function(e){return this.backdrop.backgroundShown?void 0:(this.backdrop=t("<div>",{"class":"tour-backdrop"}),this.backdrop.backgroundShown=!0,t(e.backdropContainer).append(this.backdrop))},o.prototype._hideBackdrop=function(){return this._hideOverlayElement(),this._hideBackground()},o.prototype._hideBackground=function(){return this.backdrop?(this.backdrop.remove(),this.backdrop.overlay=null,this.backdrop.backgroundShown=!1):void 0},o.prototype._showOverlayElement=function(e,o){var n,r;return n=t(e.element),!n||0===n.length||this.backdrop.overlayElementShown&&!o?void 0:(this.backdrop.overlayElementShown||(this.backdrop.$element=n.addClass("tour-step-backdrop"),this.backdrop.$background=t("<div>",{"class":"tour-step-background"}),this.backdrop.$background.appendTo(e.backdropContainer),this.backdrop.overlayElementShown=!0),r={width:n.innerWidth(),height:n.innerHeight(),offset:n.offset()},e.backdropPadding&&(r=this._applyBackdropPadding(e.backdropPadding,r)),this.backdrop.$background.width(r.width).height(r.height).offset(r.offset))},o.prototype._hideOverlayElement=function(){return this.backdrop.overlayElementShown?(this.backdrop.$element.removeClass("tour-step-backdrop"),this.backdrop.$background.remove(),this.backdrop.$element=null,this.backdrop.$background=null,this.backdrop.overlayElementShown=!1):void 0},o.prototype._applyBackdropPadding=function(t,e){return"object"==typeof t?(null==t.top&&(t.top=0),null==t.right&&(t.right=0),null==t.bottom&&(t.bottom=0),null==t.left&&(t.left=0),e.offset.top=e.offset.top-t.top,e.offset.left=e.offset.left-t.left,e.width=e.width+t.left+t.right,e.height=e.height+t.top+t.bottom):(e.offset.top=e.offset.top-t,e.offset.left=e.offset.left-t,e.width=e.width+2*t,e.height=e.height+2*t),e},o.prototype._clearTimer=function(){return e.clearTimeout(this._timer),this._timer=null,this._duration=null},o.prototype._getProtocol=function(t){return t=t.split("://"),t.length>1?t[0]:"http"},o.prototype._getHost=function(t){return t=t.split("//"),t=t.length>1?t[1]:t[0],t.split("/")[0]},o.prototype._getPath=function(t){return t.replace(/\/?$/,"").split("?")[0].split("#")[0]},o.prototype._getQuery=function(t){return this._getParams(t,"?")},o.prototype._getHash=function(t){return this._getParams(t,"#")},o.prototype._getParams=function(t,e){var o,n,r,i,s;if(n=t.split(e),1===n.length)return{};for(n=n[1].split("&"),r={},i=0,s=n.length;s>i;i++)o=n[i],o=o.split("="),r[o[0]]=o[1]||"";return r},o.prototype._equal=function(t,e){var o,n;if("[object Object]"==={}.toString.call(t)&&"[object Object]"==={}.toString.call(e)){for(o in t)if(n=t[o],e[o]!==n)return!1;for(o in e)if(n=e[o],t[o]!==n)return!1;return!0}return t===e},o}(),e.Tour=o}(jQuery,window);
/*!
 * jQuery Browser Plugin 0.1.0
 * https://github.com/gabceb/jquery-browser-plugin
 *
 * Original jquery-browser code Copyright 2005, 2015 jQuery Foundation, Inc. and other contributors
 * http://jquery.org/license
 *
 * Modifications Copyright 2015 Gabriel Cebrian
 * https://github.com/gabceb
 *
 * Released under the MIT license
 *
 * Date: 23-11-2015
 */!function(a){"function"==typeof define&&define.amd?define(["jquery"],function(b){return a(b)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("jquery")):a(window.jQuery)}(function(a){"use strict";function b(a){void 0===a&&(a=window.navigator.userAgent),a=a.toLowerCase();var b=/(edge)\/([\w.]+)/.exec(a)||/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(iemobile)[\/]([\w.]+)/.exec(a)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],c=/(ipad)/.exec(a)||/(ipod)/.exec(a)||/(windows phone)/.exec(a)||/(iphone)/.exec(a)||/(kindle)/.exec(a)||/(silk)/.exec(a)||/(android)/.exec(a)||/(win)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||/(cros)/.exec(a)||/(playbook)/.exec(a)||/(bb)/.exec(a)||/(blackberry)/.exec(a)||[],d={},e={browser:b[5]||b[3]||b[1]||"",version:b[2]||b[4]||"0",versionNumber:b[4]||b[2]||"0",platform:c[0]||""};if(e.browser&&(d[e.browser]=!0,d.version=e.version,d.versionNumber=parseInt(e.versionNumber,10)),e.platform&&(d[e.platform]=!0),(d.android||d.bb||d.blackberry||d.ipad||d.iphone||d.ipod||d.kindle||d.playbook||d.silk||d["windows phone"])&&(d.mobile=!0),(d.cros||d.mac||d.linux||d.win)&&(d.desktop=!0),(d.chrome||d.opr||d.safari)&&(d.webkit=!0),d.rv||d.iemobile){var f="msie";e.browser=f,d[f]=!0}if(d.edge){delete d.edge;var g="msedge";e.browser=g,d[g]=!0}if(d.safari&&d.blackberry){var h="blackberry";e.browser=h,d[h]=!0}if(d.safari&&d.playbook){var i="playbook";e.browser=i,d[i]=!0}if(d.bb){var j="blackberry";e.browser=j,d[j]=!0}if(d.opr){var k="opera";e.browser=k,d[k]=!0}if(d.safari&&d.android){var l="android";e.browser=l,d[l]=!0}if(d.safari&&d.kindle){var m="kindle";e.browser=m,d[m]=!0}if(d.safari&&d.silk){var n="silk";e.browser=n,d[n]=!0}return d.name=e.browser,d.platform=e.platform,d}return window.jQBrowser=b(window.navigator.userAgent),window.jQBrowser.uaMatch=b,a&&(a.browser=window.jQBrowser),window.jQBrowser});
;(function() {'use strict';var objectTypes = {'function': true,'object': true};var root = (objectTypes[typeof window] && window) || this;var oldRoot = root;var freeExports = objectTypes[typeof exports] && exports;var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;var freeGlobal = freeExports && freeModule && typeof global == 'object' && global;if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal || freeGlobal.self === freeGlobal)) {root = freeGlobal;}
var maxSafeInteger = Math.pow(2, 53) - 1;var reOpera = /\bOpera/;var thisBinding = this;var objectProto = Object.prototype;var hasOwnProperty = objectProto.hasOwnProperty;var toString = objectProto.toString;function capitalize(string) {string = String(string);return string.charAt(0).toUpperCase() + string.slice(1);}
function cleanupOS(os, pattern, label) {var data = {'10.0': '10','6.4':  '10 Technical Preview','6.3':  '8.1','6.2':  '8','6.1':  'Server 2008 R2 / 7','6.0':  'Server 2008 / Vista','5.2':  'Server 2003 / XP 64-bit','5.1':  'XP','5.01': '2000 SP1','5.0':  '2000','4.0':  'NT','4.90': 'ME'};if (pattern && label && /^Win/i.test(os) && !/^Windows Phone /i.test(os) &&(data = data[/[\d.]+$/.exec(os)])) {os = 'Windows ' + data;}
os = String(os);if (pattern && label) {os = os.replace(RegExp(pattern, 'i'), label);}
os = format(os.replace(/ ce$/i, ' CE')
.replace(/\bhpw/i, 'web')
.replace(/\bMacintosh\b/, 'Mac OS')
.replace(/_PowerPC\b/i, ' OS')
.replace(/\b(OS X) [^ \d]+/i, '$1')
.replace(/\bMac (OS X)\b/, '$1')
.replace(/\/(\d)/, ' $1')
.replace(/_/g, '.')
.replace(/(?: BePC|[ .]*fc[ \d.]+)$/i, '')
.replace(/\bx86\.64\b/gi, 'x86_64')
.replace(/\b(Windows Phone) OS\b/, '$1')
.replace(/\b(Chrome OS \w+) [\d.]+\b/, '$1')
.split(' on ')[0]);return os;}
function each(object, callback) {var index = -1,length = object ? object.length : 0;if (typeof length == 'number' && length > -1 && length <= maxSafeInteger) {while (++index < length) {callback(object[index], index, object);}} else {forOwn(object, callback);}}
function format(string) {string = trim(string);return /^(?:webOS|i(?:OS|P))/.test(string)
? string
: capitalize(string);}
function forOwn(object, callback) {for (var key in object) {if (hasOwnProperty.call(object, key)) {callback(object[key], key, object);}}}
function getClassOf(value) {return value == null
? capitalize(value)
: toString.call(value).slice(8, -1);}
function isHostType(object, property) {var type = object != null ? typeof object[property] : 'number';return !/^(?:boolean|number|string|undefined)$/.test(type) &&(type == 'object' ? !!object[property] : true);}
function qualify(string) {return String(string).replace(/([ -])(?!$)/g, '$1?');}
function reduce(array, callback) {var accumulator = null;each(array, function(value, index) {accumulator = callback(accumulator, value, index, array);});return accumulator;}
function trim(string) {return String(string).replace(/^ +| +$/g, '');}
function parse(ua) {var context = root;var isCustomContext = ua && typeof ua == 'object' && getClassOf(ua) != 'String';if (isCustomContext) {context = ua;ua = null;}
var nav = context.navigator || {};var userAgent = nav.userAgent || '';ua || (ua = userAgent);var isModuleScope = isCustomContext || thisBinding == oldRoot;var likeChrome = isCustomContext
? !!nav.likeChrome
: /\bChrome\b/.test(ua) && !/internal|\n/i.test(toString.toString());var objectClass = 'Object',airRuntimeClass = isCustomContext ? objectClass : 'ScriptBridgingProxyObject',enviroClass = isCustomContext ? objectClass : 'Environment',javaClass = (isCustomContext && context.java) ? 'JavaPackage' : getClassOf(context.java),phantomClass = isCustomContext ? objectClass : 'RuntimeObject';var java = /\bJava/.test(javaClass) && context.java;var rhino = java && getClassOf(context.environment) == enviroClass;var alpha = java ? 'a' : '\u03b1';var beta = java ? 'b' : '\u03b2';var doc = context.document || {};var opera = context.operamini || context.opera;var operaClass = reOpera.test(operaClass = (isCustomContext && opera) ? opera['[[Class]]'] : getClassOf(opera))
? operaClass
: (opera = null);var data;var arch = ua;var description = [];var prerelease = null;var useFeatures = ua == userAgent;var version = useFeatures && opera && typeof opera.version == 'function' && opera.version();var isSpecialCasedOS;var layout = getLayout([{ 'label': 'EdgeHTML', 'pattern': 'Edge' },'Trident',{ 'label': 'WebKit', 'pattern': 'AppleWebKit' },'iCab','Presto','NetFront','Tasman','KHTML','Gecko']);var name = getName(['Adobe AIR','Arora','Avant Browser','Breach','Camino','Electron','Epiphany','Fennec','Flock','Galeon','GreenBrowser','iCab','Iceweasel','K-Meleon','Konqueror','Lunascape','Maxthon',{ 'label': 'Microsoft Edge', 'pattern': 'Edge' },'Midori','Nook Browser','PaleMoon','PhantomJS','Raven','Rekonq','RockMelt',{ 'label': 'Samsung Internet', 'pattern': 'SamsungBrowser' },'SeaMonkey',{ 'label': 'Silk', 'pattern': '(?:Cloud9|Silk-Accelerated)' },'Sleipnir','SlimBrowser',{ 'label': 'SRWare Iron', 'pattern': 'Iron' },'Sunrise','Swiftfox','Waterfox','WebPositive','Opera Mini',{ 'label': 'Opera Mini', 'pattern': 'OPiOS' },'Opera',{ 'label': 'Opera', 'pattern': 'OPR' },'Chrome',{ 'label': 'Chrome Mobile', 'pattern': '(?:CriOS|CrMo)' },{ 'label': 'Firefox', 'pattern': '(?:Firefox|Minefield)' },{ 'label': 'Firefox for iOS', 'pattern': 'FxiOS' },{ 'label': 'IE', 'pattern': 'IEMobile' },{ 'label': 'IE', 'pattern': 'MSIE' },'Safari']);var product = getProduct([{ 'label': 'BlackBerry', 'pattern': 'BB10' },'BlackBerry',{ 'label': 'Galaxy S', 'pattern': 'GT-I9000' },{ 'label': 'Galaxy S2', 'pattern': 'GT-I9100' },{ 'label': 'Galaxy S3', 'pattern': 'GT-I9300' },{ 'label': 'Galaxy S4', 'pattern': 'GT-I9500' },{ 'label': 'Galaxy S5', 'pattern': 'SM-G900' },{ 'label': 'Galaxy S6', 'pattern': 'SM-G920' },{ 'label': 'Galaxy S6 Edge', 'pattern': 'SM-G925' },{ 'label': 'Galaxy S7', 'pattern': 'SM-G930' },{ 'label': 'Galaxy S7 Edge', 'pattern': 'SM-G935' },'Google TV','Lumia','iPad','iPod','iPhone','Kindle',{ 'label': 'Kindle Fire', 'pattern': '(?:Cloud9|Silk-Accelerated)' },'Nexus','Nook','PlayBook','PlayStation Vita','PlayStation','TouchPad','Transformer',{ 'label': 'Wii U', 'pattern': 'WiiU' },'Wii','Xbox One',{ 'label': 'Xbox 360', 'pattern': 'Xbox' },'Xoom']);var manufacturer = getManufacturer({'Apple': { 'iPad': 1, 'iPhone': 1, 'iPod': 1 },'Archos': {},'Amazon': { 'Kindle': 1, 'Kindle Fire': 1 },'Asus': { 'Transformer': 1 },'Barnes & Noble': { 'Nook': 1 },'BlackBerry': { 'PlayBook': 1 },'Google': { 'Google TV': 1, 'Nexus': 1 },'HP': { 'TouchPad': 1 },'HTC': {},'LG': {},'Microsoft': { 'Xbox': 1, 'Xbox One': 1 },'Motorola': { 'Xoom': 1 },'Nintendo': { 'Wii U': 1,  'Wii': 1 },'Nokia': { 'Lumia': 1 },'Samsung': { 'Galaxy S': 1, 'Galaxy S2': 1, 'Galaxy S3': 1, 'Galaxy S4': 1 },'Sony': { 'PlayStation': 1, 'PlayStation Vita': 1 }});var os = getOS(['Windows Phone','Android','CentOS',{ 'label': 'Chrome OS', 'pattern': 'CrOS' },'Debian','Fedora','FreeBSD','Gentoo','Haiku','Kubuntu','Linux Mint','OpenBSD','Red Hat','SuSE','Ubuntu','Xubuntu','Cygwin','Symbian OS','hpwOS','webOS ','webOS','Tablet OS','Tizen','Linux','Mac OS X','Macintosh','Mac','Windows 98;','Windows ']);function getLayout(guesses) {return reduce(guesses, function(result, guess) {return result || RegExp('\\b' + (guess.pattern || qualify(guess)) + '\\b', 'i').exec(ua) && (guess.label || guess);});}
function getManufacturer(guesses) {return reduce(guesses, function(result, value, key) {return result || (value[product] ||value[/^[a-z]+(?: +[a-z]+\b)*/i.exec(product)] ||RegExp('\\b' + qualify(key) + '(?:\\b|\\w*\\d)', 'i').exec(ua)) && key;});}
function getName(guesses) {return reduce(guesses, function(result, guess) {return result || RegExp('\\b' + (guess.pattern || qualify(guess)) + '\\b', 'i').exec(ua) && (guess.label || guess);});}
function getOS(guesses) {return reduce(guesses, function(result, guess) {var pattern = guess.pattern || qualify(guess);if (!result && (result =
RegExp('\\b' + pattern + '(?:/[\\d.]+|[ \\w.]*)', 'i').exec(ua))) {result = cleanupOS(result, pattern, guess.label || guess);}
return result;});}
function getProduct(guesses) {return reduce(guesses, function(result, guess) {var pattern = guess.pattern || qualify(guess);if (!result && (result =
RegExp('\\b' + pattern + ' *\\d+[.\\w_]*', 'i').exec(ua) ||RegExp('\\b' + pattern + ' *\\w+-[\\w]*', 'i').exec(ua) ||RegExp('\\b' + pattern + '(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)', 'i').exec(ua))) {if ((result = String((guess.label && !RegExp(pattern, 'i').test(guess.label)) ? guess.label : result).split('/'))[1] && !/[\d.]+/.test(result[0])) {result[0] += ' ' + result[1];}
guess = guess.label || guess;result = format(result[0]
.replace(RegExp(pattern, 'i'), guess)
.replace(RegExp('; *(?:' + guess + '[_-])?', 'i'), ' ')
.replace(RegExp('(' + guess + ')[-_.]?(\\w)', 'i'), '$1 $2'));}
return result;});}
function getVersion(patterns) {return reduce(patterns, function(result, pattern) {return result || (RegExp(pattern +'(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)', 'i').exec(ua) || 0)[1] || null;});}
function toStringPlatform() {return this.description || '';}
layout && (layout = [layout]);if (manufacturer && !product) {product = getProduct([manufacturer]);}
if ((data = /\bGoogle TV\b/.exec(product))) {product = data[0];}
if (/\bSimulator\b/i.test(ua)) {product = (product ? product + ' ' : '') + 'Simulator';}
if (name == 'Opera Mini' && /\bOPiOS\b/.test(ua)) {description.push('running in Turbo/Uncompressed mode');}
if (name == 'IE' && /\blike iPhone OS\b/.test(ua)) {data = parse(ua.replace(/like iPhone OS/, ''));manufacturer = data.manufacturer;product = data.product;}
else if (/^iP/.test(product)) {name || (name = 'Safari');os = 'iOS' + ((data = / OS ([\d_]+)/i.exec(ua))
? ' ' + data[1].replace(/_/g, '.')
: '');}
else if (name == 'Konqueror' && !/buntu/i.test(os)) {os = 'Kubuntu';}
else if ((manufacturer && manufacturer != 'Google' &&((/Chrome/.test(name) && !/\bMobile Safari\b/i.test(ua)) || /\bVita\b/.test(product))) ||(/\bAndroid\b/.test(os) && /^Chrome/.test(name) && /\bVersion\//i.test(ua))) {
name = 'Android Browser';os = /\bAndroid\b/.test(os) ? os : 'Android';}
else if (name == 'Silk') {if (!/\bMobi/i.test(ua)) {os = 'Android';description.unshift('desktop mode');}
if (/Accelerated *= *true/i.test(ua)) {description.unshift('accelerated');}}
else if (name == 'PaleMoon' && (data = /\bFirefox\/([\d.]+)\b/.exec(ua))) {description.push('identifying as Firefox ' + data[1]);}
else if (name == 'Firefox' && (data = /\b(Mobile|Tablet|TV)\b/i.exec(ua))) {os || (os = 'Firefox OS');product || (product = data[1]);}
else if (!name || (data = !/\bMinefield\b/i.test(ua) && /\b(?:Firefox|Safari)\b/.exec(name))) {if (name && !product && /[\/,]|^[^(]+?\)/.test(ua.slice(ua.indexOf(data + '/') + 8))) {name = null;}
if ((data = product || manufacturer || os) &&(product || manufacturer || /\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(os))) {name = /[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(os) ? os : data) + ' Browser';}}
else if (name == 'Electron' && (data = (/\bChrome\/([\d.]+)\b/.exec(ua) || 0)[1])) {description.push('Chromium ' + data);}
if (!version) {version = getVersion(['(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))','Version',qualify(name),'(?:Firefox|Minefield|NetFront)']);}
if ((data =
layout == 'iCab' && parseFloat(version) > 3 && 'WebKit' ||/\bOpera\b/.test(name) && (/\bOPR\b/.test(ua) ? 'Blink' : 'Presto') ||/\b(?:Midori|Nook|Safari)\b/i.test(ua) && !/^(?:Trident|EdgeHTML)$/.test(layout) && 'WebKit' ||!layout && /\bMSIE\b/i.test(ua) && (os == 'Mac OS' ? 'Tasman' : 'Trident') ||layout == 'WebKit' && /\bPlayStation\b(?! Vita\b)/i.test(name) && 'NetFront')) {layout = [data];}
if (name == 'IE' && (data = (/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(ua) || 0)[1])) {name += ' Mobile';os = 'Windows Phone ' + (/\+$/.test(data) ? data : data + '.x');description.unshift('desktop mode');}
else if (/\bWPDesktop\b/i.test(ua)) {name = 'IE Mobile';os = 'Windows Phone 8.x';description.unshift('desktop mode');version || (version = (/\brv:([\d.]+)/.exec(ua) || 0)[1]);}
else if (name != 'IE' && layout == 'Trident' && (data = /\brv:([\d.]+)/.exec(ua))) {if (name) {description.push('identifying as ' + name + (version ? ' ' + version : ''));}
name = 'IE';version = data[1];}
if (useFeatures) {if (isHostType(context, 'global')) {if (java) {data = java.lang.System;arch = data.getProperty('os.arch');os = os || data.getProperty('os.name') + ' ' + data.getProperty('os.version');}
if (rhino) {try {version = context.require('ringo/engine').version.join('.');name = 'RingoJS';} catch(e) {if ((data = context.system) && data.global.system == context.system) {name = 'Narwhal';os || (os = data[0].os || null);}}
if (!name) {name = 'Rhino';}}
else if (typeof context.process == 'object' && !context.process.browser &&(data = context.process)) {if (typeof data.versions == 'object') {if (typeof data.versions.electron == 'string') {description.push('Node ' + data.versions.node);name = 'Electron';version = data.versions.electron;} else if (typeof data.versions.nw == 'string') {description.push('Chromium ' + version, 'Node ' + data.versions.node);name = 'NW.js';version = data.versions.nw;}}
if (!name) {name = 'Node.js';arch = data.arch;os = data.platform;version = /[\d.]+/.exec(data.version);version = version ? version[0] : null;}}}
else if (getClassOf((data = context.runtime)) == airRuntimeClass) {name = 'Adobe AIR';os = data.flash.system.Capabilities.os;}
else if (getClassOf((data = context.phantom)) == phantomClass) {name = 'PhantomJS';version = (data = data.version || null) && (data.major + '.' + data.minor + '.' + data.patch);}
else if (typeof doc.documentMode == 'number' && (data = /\bTrident\/(\d+)/i.exec(ua))) {version = [version, doc.documentMode];if ((data = +data[1] + 4) != version[1]) {description.push('IE ' + version[1] + ' mode');layout && (layout[1] = '');version[1] = data;}
version = name == 'IE' ? String(version[1].toFixed(1)) : version[0];}
else if (typeof doc.documentMode == 'number' && /^(?:Chrome|Firefox)\b/.test(name)) {description.push('masking as ' + name + ' ' + version);name = 'IE';version = '11.0';layout = ['Trident'];os = 'Windows';}
os = os && format(os);}
if (version && (data =
/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(version) ||/(?:alpha|beta)(?: ?\d)?/i.exec(ua + ';' + (useFeatures && nav.appMinorVersion)) ||/\bMinefield\b/i.test(ua) && 'a')) {prerelease = /b/i.test(data) ? 'beta' : 'alpha';version = version.replace(RegExp(data + '\\+?$'), '') +(prerelease == 'beta' ? beta : alpha) + (/\d+\+?/.exec(data) || '');}
if (name == 'Fennec' || name == 'Firefox' && /\b(?:Android|Firefox OS)\b/.test(os)) {name = 'Firefox Mobile';}
else if (name == 'Maxthon' && version) {version = version.replace(/\.[\d.]+/, '.x');}
else if (/\bXbox\b/i.test(product)) {if (product == 'Xbox 360') {os = null;}
if (product == 'Xbox 360' && /\bIEMobile\b/.test(ua)) {description.unshift('mobile mode');}}
else if ((/^(?:Chrome|IE|Opera)$/.test(name) || name && !product && !/Browser|Mobi/.test(name)) &&(os == 'Windows CE' || /Mobi/i.test(ua))) {name += ' Mobile';}
else if (name == 'IE' && useFeatures) {try {if (context.external === null) {description.unshift('platform preview');}} catch(e) {description.unshift('embedded');}}
else if ((/\bBlackBerry\b/.test(product) || /\bBB10\b/.test(ua)) && (data =
(RegExp(product.replace(/ +/g, ' *') + '/([.\\d]+)', 'i').exec(ua) || 0)[1] ||version)) {data = [data, /BB10/.test(ua)];os = (data[1] ? (product = null, manufacturer = 'BlackBerry') : 'Device Software') + ' ' + data[0];version = null;}
else if (this != forOwn && product != 'Wii' && ((useFeatures && opera) ||(/Opera/.test(name) && /\b(?:MSIE|Firefox)\b/i.test(ua)) ||(name == 'Firefox' && /\bOS X (?:\d+\.){2,}/.test(os)) ||(name == 'IE' && ((os && !/^Win/.test(os) && version > 5.5) ||/\bWindows XP\b/.test(os) && version > 8 ||version == 8 && !/\bTrident\b/.test(ua)))) && !reOpera.test((data = parse.call(forOwn, ua.replace(reOpera, '') + ';'))) && data.name) {data = 'ing as ' + data.name + ((data = data.version) ? ' ' + data : '');if (reOpera.test(name)) {if (/\bIE\b/.test(data) && os == 'Mac OS') {os = null;}
data = 'identify' + data;}
else {data = 'mask' + data;if (operaClass) {name = format(operaClass.replace(/([a-z])([A-Z])/g, '$1 $2'));} else {name = 'Opera';}
if (/\bIE\b/.test(data)) {os = null;}
if (!useFeatures) {version = null;}}
layout = ['Presto'];description.push(data);}
if ((data = (/\bAppleWebKit\/([\d.]+\+?)/i.exec(ua) || 0)[1])) {data = [parseFloat(data.replace(/\.(\d)$/, '.0$1')), data];if (name == 'Safari' && data[1].slice(-1) == '+') {name = 'WebKit Nightly';prerelease = 'alpha';version = data[1].slice(0, -1);}
else if (version == data[1] ||version == (data[2] = (/\bSafari\/([\d.]+\+?)/i.exec(ua) || 0)[1])) {version = null;}
data[1] = (/\bChrome\/([\d.]+)/i.exec(ua) || 0)[1];if (data[0] == 537.36 && data[2] == 537.36 && parseFloat(data[1]) >= 28 && layout == 'WebKit') {layout = ['Blink'];}
if (!useFeatures || (!likeChrome && !data[1])) {layout && (layout[1] = 'like Safari');data = (data = data[0], data < 400 ? 1 : data < 500 ? 2 : data < 526 ? 3 : data < 533 ? 4 : data < 534 ? '4+' : data < 535 ? 5 : data < 537 ? 6 : data < 538 ? 7 : data < 601 ? 8 : '8');} else {layout && (layout[1] = 'like Chrome');data = data[1] || (data = data[0], data < 530 ? 1 : data < 532 ? 2 : data < 532.05 ? 3 : data < 533 ? 4 : data < 534.03 ? 5 : data < 534.07 ? 6 : data < 534.10 ? 7 : data < 534.13 ? 8 : data < 534.16 ? 9 : data < 534.24 ? 10 : data < 534.30 ? 11 : data < 535.01 ? 12 : data < 535.02 ? '13+' : data < 535.07 ? 15 : data < 535.11 ? 16 : data < 535.19 ? 17 : data < 536.05 ? 18 : data < 536.10 ? 19 : data < 537.01 ? 20 : data < 537.11 ? '21+' : data < 537.13 ? 23 : data < 537.18 ? 24 : data < 537.24 ? 25 : data < 537.36 ? 26 : layout != 'Blink' ? '27' : '28');}
layout && (layout[1] += ' ' + (data += typeof data == 'number' ? '.x' : /[.+]/.test(data) ? '' : '+'));if (name == 'Safari' && (!version || parseInt(version) > 45)) {version = data;}}
if (name == 'Opera' &&  (data = /\bzbov|zvav$/.exec(os))) {name += ' ';description.unshift('desktop mode');if (data == 'zvav') {name += 'Mini';version = null;} else {name += 'Mobile';}
os = os.replace(RegExp(' *' + data + '$'), '');}
else if (name == 'Safari' && /\bChrome\b/.exec(layout && layout[1])) {description.unshift('desktop mode');name = 'Chrome Mobile';version = null;if (/\bOS X\b/.test(os)) {manufacturer = 'Apple';os = 'iOS 4.3+';} else {os = null;}}
if (version && version.indexOf((data = /[\d.]+$/.exec(os))) == 0 &&ua.indexOf('/' + data + '-') > -1) {os = trim(os.replace(data, ''));}
if (layout && !/\b(?:Avant|Nook)\b/.test(name) && (/Browser|Lunascape|Maxthon/.test(name) ||name != 'Safari' && /^iOS/.test(os) && /\bSafari\b/.test(layout[1]) ||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(name) && layout[1])) {(data = layout[layout.length - 1]) && description.push(data);}
if (description.length) {description = ['(' + description.join('; ') + ')'];}
if (manufacturer && product && product.indexOf(manufacturer) < 0) {description.push('on ' + manufacturer);}
if (product) {description.push((/^on /.test(description[description.length - 1]) ? '' : 'on ') + product);}
if (os) {data = / ([\d.+]+)$/.exec(os);isSpecialCasedOS = data && os.charAt(os.length - data[0].length - 1) == '/';os = {'architecture': 32,'family': (data && !isSpecialCasedOS) ? os.replace(data[0], '') : os,'version': data ? data[1] : null,'toString': function() {var version = this.version;return this.family + ((version && !isSpecialCasedOS) ? ' ' + version : '') + (this.architecture == 64 ? ' 64-bit' : '');}};}
if ((data = /\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(arch)) && !/\bi686\b/i.test(arch)) {if (os) {os.architecture = 64;os.family = os.family.replace(RegExp(' *' + data), '');}
if (name && (/\bWOW64\b/i.test(ua) ||(useFeatures && /\w(?:86|32)$/.test(nav.cpuClass || nav.platform) && !/\bWin64; x64\b/i.test(ua)))) {description.unshift('32-bit');}}
else if (os && /^OS X/.test(os.family) &&name == 'Chrome' && parseFloat(version) >= 39) {os.architecture = 64;}
ua || (ua = null);var platform = {};platform.description = ua;platform.layout = layout && layout[0];platform.manufacturer = manufacturer;platform.name = name;platform.prerelease = prerelease;platform.product = product;platform.ua = ua;platform.version = name && version;platform.os = os || {'architecture': null,'family': null,'version': null,'toString': function() { return 'null'; }};platform.parse = parse;platform.toString = toStringPlatform;if (platform.version) {description.unshift(version);}
if (platform.name) {description.unshift(name);}
if (os && name && !(os == String(os).split(' ')[0] && (os == name.split(' ')[0] || product))) {description.push(product ? '(' + os + ')' : 'on ' + os);}
if (description.length) {platform.description = description.join(' ');}
return platform;}
var platform = parse();if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {root.platform = platform;define(function() {return platform;});}
else if (freeExports && freeModule) {forOwn(platform, function(value, key) {freeExports[key] = value;});}
else {root.platform = platform;}}.call(this));
